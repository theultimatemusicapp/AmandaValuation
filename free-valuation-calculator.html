<!DOCTYPE html>
<html lang="en">
<head>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6483721386563068" crossorigin="anonymous"></script>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-772JV93TYR"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-772JV93TYR');
    </script>
    <link rel="icon" type="image/png" href="favicon.png">
<link rel="icon" type="image/png" href="favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/svg+xml" href="favicon.svg" />
<link rel="shortcut icon" href="favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png" />
<meta name="apple-mobile-web-app-title" content="SaaS Val" />
<link rel="manifest" href="site.webmanifest" />
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Value your SaaS company for free with our Free SaaS Valuation Calculator. Get accurate business valuation in minutes. Try the Pro version for advanced insights.">
    <link rel="canonical" href="https://saasvaluation.app/free-valuation-calculator.html">
    <meta property="og:title" content="Free SaaS Valuation Calculator | SaaS Valuation App">
    <meta property="og:description" content="Value your SaaS company for free with our Free SaaS Valuation Calculator. Get accurate business valuation in minutes. Try the Pro version for advanced insights.">
    <meta property="og:url" content="https://saasvaluation.app/free-valuation-calculator.html">
    <meta property="og:image" content="https://saasvaluation.app/social-preview.png">
    <meta name="keywords" content="Free SaaS Valuation Calculator, SaaS valuation, business valuation, free valuation tool, SaaS metrics, SaaS Valuation App">
    <title>Free SaaS Valuation Calculator | SaaS Valuation App</title>
    <!-- Tailwind CSS -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="styles/global.css">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- jsPDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Free SaaS Valuation Calculator",
      "url": "https://saasvaluation.app/free-valuation-calculator.html",
      "applicationCategory": "BusinessApplication",
      "operatingSystem": "Web",
      "description": "Interactive calculator that estimates SaaS valuations and upgrades to investor-ready reports."
    }
    </script>
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #38B2AC 0%, #2D3748 100%);
        }
        .btn-primary {
            background-color: #38B2AC;
            transition: background-color 0.3s ease;
        }
        .btn-primary:hover {
            background-color: #2C7A7B;
        }
        .btn-secondary {
            background-color: #ED8936;
            color: white;
            transition: background-color 0.3s ease;
        }
        .btn-secondary:hover {
            background-color: #C05621;
        }
        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        .step-hidden {
            display: none;
        }
        .step-visible {
            display: block;
        }
        .input-error {
            border-color: #E53E3E !important;
            box-shadow: 0 0 0 2px rgba(229, 62, 62, 0.2) !important;
        }
        .input-valid {
            border-color: #38A169 !important;
            box-shadow: 0 0 0 2px rgba(56, 161, 105, 0.25) !important;
        }
        .saved-indicator {
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }
        [data-tooltip] {
            position: relative;
        }
        [data-tooltip]:hover:after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background-color: #2D3748;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 12px;
            white-space: nowrap;
            z-index: 10;
        }
        .tooltip-hidden {
            display: none;
        }
        .dashboard-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
            padding: 20px;
            color: white;
            text-align: left;
            max-width: 600px;
            margin: 0 auto;
        }
        .value-bar {
            height: 20px;
            background: #4A5568;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }
        .value-fill {
            height: 100%;
            background: #48BB78;
            border-radius: 10px 0 0 10px;
            transition: width 0.3s ease;
        }
        .metric-box {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 10px;
            padding: 10px;
            margin: 10px 0;
        }
        .indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 5px;
        }
    </style>
</head>
<body class="font-sans">
    <header class="site-header bg-gray-900 text-white shadow-lg sticky top-0 z-50" role="banner">
      <div class="container mx-auto px-6 flex justify-between items-center py-4">
        <div class="flex items-center space-x-3">
          <a href="/" class="flex items-center space-x-3" aria-label="SaaS Valuation App home">
            <img src="favicon-96x96.png" alt="SaaS Valuation App logo" class="h-10 w-10 rounded" loading="lazy">
            <span class="text-xl font-bold">SaaS Valuation App</span>
          </a>
        </div>
        <nav class="hidden md:flex space-x-6 items-center" aria-label="Primary navigation">
          <a href="index.html#valuation" class="hover:text-teal-300 nav-link" aria-label="Go to the valuation tool">Valuation Tool</a><a href="index.html#data-room" class="hover:text-teal-300 nav-link" aria-label="Learn about the AI data room">AI Data Room</a><a href="index.html#pricing" class="hover:text-teal-300 nav-link" aria-label="See pricing options">Pricing</a><a href="saas-growth-calculator.html" class="hover:text-teal-300 nav-link" aria-label="Open the SaaS growth calculator">Growth Calculator</a><a href="resources.html" class="hover:text-teal-300 nav-link" aria-label="Browse resources and guides">Resources</a><a href="blog.html" class="hover:text-teal-300 nav-link" aria-label="Read our latest posts">Blog</a><a href="Support.html#contact-support" class="hover:text-teal-300 nav-link" aria-label="Contact or get support">Support</a>
          <a href="payment.html" class="ml-2 bg-white text-gray-900 font-semibold px-4 py-2 rounded-lg shadow hover:bg-teal-100" aria-label="Upgrade to the pro valuation">Go Pro</a>
        </nav>
        <button id="menu-toggle" type="button" class="md:hidden focus:outline-none" aria-expanded="false" aria-controls="mobile-menu" aria-label="Toggle navigation menu">
          <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" class="h-7 w-7" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
          </svg>
        </button>
      </div>
      <div id="mobile-menu" class="md:hidden hidden border-t border-gray-800 bg-gray-900" role="dialog" aria-label="Mobile navigation">
        <nav class="flex flex-col space-y-3 px-6 py-4" aria-label="Primary navigation mobile">
          <a href="index.html#valuation" class="hover:text-teal-300 py-2 border-b border-gray-800 last:border-b-0" aria-label="Go to the valuation tool">Valuation Tool</a><a href="index.html#data-room" class="hover:text-teal-300 py-2 border-b border-gray-800 last:border-b-0" aria-label="Learn about the AI data room">AI Data Room</a><a href="index.html#pricing" class="hover:text-teal-300 py-2 border-b border-gray-800 last:border-b-0" aria-label="See pricing options">Pricing</a><a href="saas-growth-calculator.html" class="hover:text-teal-300 py-2 border-b border-gray-800 last:border-b-0" aria-label="Open the SaaS growth calculator">Growth Calculator</a><a href="resources.html" class="hover:text-teal-300 py-2 border-b border-gray-800 last:border-b-0" aria-label="Browse resources and guides">Resources</a><a href="blog.html" class="hover:text-teal-300 py-2 border-b border-gray-800 last:border-b-0" aria-label="Read our latest posts">Blog</a><a href="Support.html#contact-support" class="hover:text-teal-300 py-2 border-b border-gray-800 last:border-b-0" aria-label="Contact or get support">Support</a>
          <a href="payment.html" class="mt-2 inline-flex items-center justify-center px-4 py-3 rounded-lg bg-white text-gray-900 font-semibold hover:bg-teal-100" aria-label="Upgrade to the pro valuation">Go Pro</a>
        </nav>
      </div>
    </header>
<!-- Header -->
    

    <main id="main-content">
    <!-- Hero Section -->
    <section class="gradient-bg text-white py-20">
        <div class="container mx-auto px-6 text-center">
            <h1 class="text-4xl md:text-5xl font-bold mb-4">Free SaaS Valuation Calculator</h1>
            <p class="text-lg md:text-xl mb-8 opacity-90 max-w-2xl mx-auto">Here you can value your SaaS company for free with our entirely free calculator. For more insights, check out the Pro version.</p>
            <a href="#valuation" class="btn-primary text-white font-bold py-3 px-8 rounded-lg" data-analytics-event="cta_click" data-analytics-label="free-valuation-hero">Get Your Valuation Now</a>
        </div>
    </section>
<!-- Self Valuation Tool -->
    <section id="valuation" class="py-20 bg-gray-50">
        <div class="container mx-auto px-6">
            <div class="bg-white border border-gray-100 rounded-3xl shadow-xl p-8 md:p-12 space-y-12">
                <div class="text-center">
                    <h2 class="text-3xl font-bold text-gray-800 mb-4">FREE Self Valuation Tool</h2>
                    <p class="text-lg text-gray-600 max-w-2xl mx-auto">Answer a few questions to get a detailed valuation report for your SaaS business in minutes.</p>
              </div>
                <div id="valuation-form" class="bg-white rounded-2xl shadow-lg p-6 md:p-8 max-w-5xl mx-auto">
                    <div class="lg:grid lg:grid-cols-4 lg:gap-8 lg:gap-y-10">
                        <div class="lg:col-span-3">
                        <!-- Progress Bar -->
                        <div class="mb-8">
                            <div class="relative pt-1">
                                <div class="overflow-hidden h-2 mb-4 text-xs flex rounded bg-gray-200">
                                    <div id="progress-fill" class="shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-teal-500" style="width: 16.67%" role="progressbar" aria-valuemin="1" aria-valuemax="6" aria-valuenow="1"></div>
                                </div>
                                <div class="text-center">
                                    <p class="text-gray-600">Step <span id="current-step">1</span> of 6</p>
                                    <p id="current-step-label" class="text-sm text-teal-700 font-semibold">Currently: Select Valuation Method</p>
                                    <p class="text-gray-500 text-sm flex items-center justify-center gap-2 mt-1"><i class="far fa-clock"></i>Estimated completion time: ~3 minutes</p>
                                </div>
                            </div>
                        </div>

                        <!-- Step 1: Valuation Method -->
                        <div class="step step-visible">
                            <h3 class="text-xl font-semibold text-gray-800 mb-4">Step 1: Select Valuation Method</h3>
                            <p class="text-gray-600 mb-4">Choose up to 3 methods for a comprehensive valuation. <span data-tooltip="Select methods based on your business model. Multiplier is best for established SaaS companies, while DCF suits those with predictable cash flows." class="text-teal-500 underline cursor-pointer">Learn more</span></p>
                            <div class="space-y-2">
                                <label class="flex items-center">
                                    <input type="checkbox" id="method-multiplier" value="multiplier" class="form-checkbox h-5 w-5 text-teal-500">
                                    <span class="ml-2 text-gray-600">Revenue Multiplier</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="method-income" value="income" class="form-checkbox h-5 w-5 text-teal-500">
                                    <span class="ml-2 text-gray-600">Income-Based Valuation</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="method-earnings" value="earnings" class="form-checkbox h-5 w-5 text-teal-500">
                                    <span class="ml-2 text-gray-600">Earnings-Based Valuation</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="method-dcf" value="dcf" class="form-checkbox h-5 w-5 text-teal-500">
                                    <span class="ml-2 text-gray-600">Discounted Cash Flow (DCF)</span>
                                </label>
                            </div>
                            <div class="mt-4">
                                <label for="businessModel" class="block text-gray-700 font-semibold mb-1">Business Model</label>
                                <select id="businessModel" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500">
                                    <option value="saas" selected>SaaS (uses revenue multiples)</option>
                                    <option value="non-saas">Non-SaaS (no revenue multiple)</option>
                                </select>
                                <p class="text-gray-500 text-sm mt-1">Use Non-SaaS if your business relies on services, inventory, or other models that are not valued on revenue multiples.</p>
                            </div>
                            <p id="method-error" class="text-red-500 text-sm mt-2 hidden">Please select 1 to 3 methods.</p>
                            <div class="mt-6 flex justify-end">
                                <button id="next-btn-1" class="btn-primary text-white font-bold py-2 px-4 rounded-lg">Next</button>
                            </div>
                        </div>

                        <!-- Step 2: Financial Information -->
                <div class="step step-hidden">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">Step 2: Financial Information</h3>
                    <p class="text-gray-600 mb-4">Provide your financial details to help us calculate your valuation accurately.</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6 gap-y-8">
                        <div>
                            <label for="ownerSalary" class="block text-gray-600 mb-1">Owner’s Salary ($/year)</label>
                            <input type="text" id="ownerSalary" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500" placeholder="e.g., 120,000">
                            <p id="ownerSalary-error" class="text-red-500 text-sm mt-1 hidden">Please enter a valid number.</p>
                        </div>
                        <div>
                            <label for="averageSalary" class="block text-gray-600 mb-1">Average Employee Salary ($/year)</label>
                            <input type="text" id="averageSalary" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500" placeholder="e.g., 80,000">
                            <p id="averageSalary-error" class="text-red-500 text-sm mt-1 hidden">Please enter a valid number.</p>
                        </div>
                        <div>
                            <label for="employeeBenefits" class="block text-gray-600 mb-1">Employee Benefits ($/year)</label>
                            <input type="text" id="employeeBenefits" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500" placeholder="e.g., 10,000">
                            <p id="employeeBenefits-error" class="text-red-500 text-sm mt-1 hidden">Please enter a valid number.</p>
                        </div>
                        <div>
                            <label for="staffNumber" class="block text-gray-600 mb-1">Number of Staff</label>
                            <input type="number" id="staffNumber" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500" placeholder="e.g., 10">
                            <p id="staffNumber-error" class="text-red-500 text-sm mt-1 hidden">Please enter a valid number.</p>
                        </div>
                        <div>
                            <label for="expenses" class="block text-gray-600 mb-1">Operating Expenses ($/year)</label>
                            <input type="text" id="expenses" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500" placeholder="e.g., 50,000">
                            <p id="expenses-error" class="text-red-500 text-sm mt-1 hidden">Please enter a valid number.</p>
                        </div>
                        <div>
                            <label for="debt" class="block text-gray-600 mb-1">Outstanding Debt ($)</label>
                            <input type="text" id="debt" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500" placeholder="e.g., 20,000">
                            <p id="debt-error" class="text-red-500 text-sm mt-1 hidden">Please enter a valid number.</p>
                        </div>
                        <div>
                            <label for="growthRate" class="block text-gray-600 mb-1">Annual Growth Rate (%)</label>
                            <input type="number" id="growthRate" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500" placeholder="e.g., 15">
                            <p id="growthRate-error" class="text-red-500 text-sm mt-1 hidden">Please enter a valid percentage (0-100).</p>
                        </div>
                        <div>
                            <label for="yearsOperating" class="block text-gray-600 mb-1">Years in Operation</label>
                            <input type="number" id="yearsOperating" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500" placeholder="e.g., 3">
                            <p id="yearsOperating-error" class="text-red-500 text-sm mt-1 hidden">Please enter a valid number.</p>
                        </div>
                        <div class="md:col-span-2">
                            <label for="scalability" class="block text-gray-600 mb-1">Scalability (1-10) <span data-tooltip="Rate how easily your business can scale operations (e.g., adding customers without significant cost increases)." class="text-teal-500 underline cursor-pointer">?</span></label>
                            <input type="range" id="scalability" min="1" max="10" value="5" class="w-full">
                            <p class="text-gray-600">Score: <span id="scalabilityValue">5</span></p>
                        </div>
                    </div>
                    <div class="mt-6 flex justify-between">
                        <button id="prev-btn-2" class="btn-secondary font-bold py-2 px-4 rounded-lg">Previous</button>
                        <button id="next-btn-2" class="btn-primary text-white font-bold py-2 px-4 rounded-lg">Next</button>
                    </div>
                </div>

                <!-- Step 3: Customer Metrics -->
                <div class="step step-hidden">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">Step 3: Customer Metrics</h3>
                    <p class="text-gray-600 mb-4">Tell us about your customer acquisition and retention metrics.</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6 gap-y-8">
                        <div>
                            <label for="ltv" class="block text-gray-600 mb-1">Customer Lifetime Value (LTV) ($) <span data-tooltip="Average revenue you expect from a customer across their entire relationship." class="text-teal-500 underline cursor-pointer">?</span></label>
                            <input type="text" id="ltv" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500" placeholder="e.g., 5,000">
                            <p class="text-gray-500 text-sm mt-1">Estimate by multiplying ARPU by the average number of months a customer stays.</p>
                            <p id="ltv-error" class="text-red-500 text-sm mt-1 hidden">Please enter a valid number.</p>
                        </div>
                        <div>
                            <label for="cac" class="block text-gray-600 mb-1">Customer Acquisition Cost (CAC) ($) <span data-tooltip="Average marketing + sales cost to land one new customer." class="text-teal-500 underline cursor-pointer">?</span></label>
                            <input type="text" id="cac" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500" placeholder="e.g., 1,000">
                            <p class="text-gray-500 text-sm mt-1">Use your last month’s total acquisition spend divided by new customers won.</p>
                            <p id="cac-error" class="text-red-500 text-sm mt-1 hidden">Please enter a valid number.</p>
                        </div>
                        <div>
                            <label for="churnRate" class="block text-gray-600 mb-1">Churn Rate (%) <span data-tooltip="Percentage of customers lost per month." class="text-teal-500 underline cursor-pointer">?</span></label>
                            <input type="number" id="churnRate" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500" placeholder="e.g., 5">
                            <p class="text-gray-500 text-sm mt-1">Divide customers lost last month by customers at the start of the month.</p>
                            <p id="churnRate-error" class="text-red-500 text-sm mt-1 hidden">Please enter a valid percentage (0-100).</p>
                        </div>
                        <div>
                            <label for="customerGrowthRate" class="block text-gray-600 mb-1">Customer Growth Rate (%) <span data-tooltip="Net increase in customers month over month." class="text-teal-500 underline cursor-pointer">?</span></label>
                            <input type="number" id="customerGrowthRate" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500" placeholder="e.g., 10">
                            <p class="text-gray-500 text-sm mt-1">Use average net new customers over the past quarter for a steady view.</p>
                            <p id="customerGrowthRate-error" class="text-red-500 text-sm mt-1 hidden">Please enter a valid percentage (0-100).</p>
                        </div>
                    </div>
                    <div class="mt-6 flex justify-between">
                        <button id="prev-btn-3" class="btn-secondary font-bold py-2 px-4 rounded-lg">Previous</button>
                        <button id="next-btn-3" class="btn-primary text-white font-bold py-2 px-4 rounded-lg">Next</button>
                    </div>
                </div>

                <!-- Step 4: Industry Details -->
                <div class="step step-hidden">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">Step 4: Industry Details</h3>
                    <p class="text-gray-600 mb-4">Provide details about your industry and market position.</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6 gap-y-8">
                        <div class="md:col-span-2">
                            <label for="industry" class="block text-gray-600 mb-1">Industry</label>
                            <select id="industry" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500">
                                <option value="">Select an industry</option>
                                <option value="Technology">Technology</option>
                                <option value="Retail">Retail</option>
                                <option value="Hospitality">Hospitality</option>
                                <option value="Media">Media</option>
                                <option value="Marketing">Marketing</option>
                                <option value="Construction">Construction</option>
                                <option value="Healthcare">Healthcare</option>
                                <option value="Finance">Finance</option>
                                <option value="Real Estate">Real Estate</option>
                                <option value="Education">Education</option>
                                <option value="Transportation">Transportation</option>
                                <option value="Agriculture">Agriculture</option>
                                <option value="Manufacturing">Manufacturing</option>
                                <option value="Legal">Legal</option>
                                <option value="Energy">Energy</option>
                                <option value="Arts & Entertainment">Arts & Entertainment</option>
                                <option value="Other">Other</option>
                            </select>
                            <p id="industry-error" class="text-red-500 text-sm mt-1 hidden">Please select an industry.</p>
                        </div>
                        <div class="md:col-span-2">
                            <label for="marketTrendImpact" class="block text-gray-600 mb-1">Market Trend Impact (1-10) <span data-tooltip="Rate how market trends are affecting your industry (e.g., growth in demand for SaaS solutions)." class="text-teal-500 underline cursor-pointer">?</span></label>
                            <input type="range" id="marketTrendImpact" min="1" max="10" value="5" class="w-full">
                            <p class="text-gray-600">Score: <span id="marketTrendImpactValue">5</span></p>
                        </div>
                        <div class="md:col-span-2">
                            <label for="competitivePositioning" class="block text-gray-600 mb-1">Competitive Positioning (1-10) <span data-tooltip="Rate your competitive advantage in the market (e.g., unique features, market share)." class="text-teal-500 underline cursor-pointer">?</span></label>
                            <input type="range" id="competitivePositioning" min="1" max="10" value="5" class="w-full">
                            <p class="text-gray-600">Score: <span id="competitivePositioningValue">5</span></p>
                        </div>
                        <div class="md:col-span-2">
                            <label for="marketVolatility" class="block text-gray-600 mb-1">Market Volatility (1-10) <span data-tooltip="Rate the stability of your industry (e.g., higher volatility means more risk)." class="text-teal-500 underline cursor-pointer">?</span></label>
                            <input type="range" id="marketVolatility" min="1" max="10" value="5" class="w-full">
                            <p class="text-gray-600">Score: <span id="marketVolatilityValue">5</span></p>
                        </div>
                    </div>
                    <div class="mt-6 flex justify-between">
                        <button id="prev-btn-4" class="btn-secondary font-bold py-2 px-4 rounded-lg">Previous</button>
                        <button id="next-btn-4" class="btn-primary text-white font-bold py-2 px-4 rounded-lg">Next</button>
                    </div>
                </div>

                <!-- Step 5: Technology and IP -->
                <div class="step step-hidden">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">Step 5: Technology and Intellectual Property</h3>
                    <p class="text-gray-600 mb-4">Tell us about your technology stack and intellectual property.</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6 gap-y-8">
                        <div class="md:col-span-2">
                            <label for="aiReplaceable" class="block text-gray-600 mb-1">Can parts of your business be replaced by AI?</label>
                            <select id="aiReplaceable" onchange="toggleAIReplacement()" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500">
                                <option value="">Select an option</option>
                                <option value="yes">Yes</option>
                                <option value="no">No</option>
                            </select>
                            <p id="aiReplaceable-error" class="text-red-500 text-sm mt-1 hidden">Please select an option.</p>
                        </div>
                        <div id="aiReplaceCountSection" class="md:col-span-2 hidden">
                            <label for="aiReplaceCount" class="block text-gray-600 mb-1">How many roles could AI replace?</label>
                            <input type="number" id="aiReplaceCount" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500" placeholder="e.g., 5">
                            <p id="aiReplaceCount-error" class="text-red-500 text-sm mt-1 hidden">Please enter a valid number.</p>
                        </div>
                        <div class="md:col-span-2">
                            <label for="hasIP" class="block text-gray-600 mb-1">Do you have intellectual property (e.g., patents)?</label>
                            <select id="hasIP" onchange="toggleIPFields()" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500">
                                <option value="">Select an option</option>
                                <option value="yes">Yes</option>
                                <option value="no">No</option>
                            </select>
                            <p id="hasIP-error" class="text-red-500 text-sm mt-1 hidden">Please select an option.</p>
                        </div>
                        <div id="ipValueSection" class="hidden">
                            <label for="ipValue" class="block text-gray-600 mb-1">Estimated IP Value ($)</label>
                            <input type="text" id="ipValue" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500" placeholder="e.g., 100,000">
                            <p id="ipValue-error" class="text-red-500 text-sm mt-1 hidden">Please enter a valid number.</p>
                        </div>
                        <div id="ipUniqueSection" class="hidden">
                            <label for="ipUnique" class="block text-gray-600 mb-1">Is your IP unique in the market?</label>
                            <select id="ipUnique" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500">
                                <option value="">Select an option</option>
                                <option value="unique">Yes, unique</option>
                                <option value="not-unique">No, not unique</option>
                            </select>
                            <p id="ipUnique-error" class="text-red-500 text-sm mt-1 hidden">Please select an option.</p>
                        </div>
                        <div class="md:col-span-2">
                            <label for="operationalEfficiency" class="block text-gray-600 mb-1">Operational Efficiency (1-10) <span data-tooltip="Rate how efficiently your business operates (e.g., automation, cost management)." class="text-teal-500 underline cursor-pointer">?</span></label>
                            <input type="range" id="operationalEfficiency" min="1" max="10" value="5" class="w-full">
                            <p class="text-gray-600">Score: <span id="operationalEfficiencyValue">5</span></p>
                        </div>
                    </div>
                    <div class="mt-6 flex justify-between">
                        <button id="prev-btn-5" class="btn-secondary font-bold py-2 px-4 rounded-lg">Previous</button>
                        <button id="next-btn-5" class="btn-primary text-white font-bold py-2 px-4 rounded-lg">Next</button>
                    </div>
                </div>

                <!-- Step 6: Future Projections -->
                <div class="step step-hidden">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">Step 6: Future Projections</h3>
                    <p class="text-gray-600 mb-4">Provide your revenue projections and additional details based on your selected valuation methods.</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6 gap-y-8">
                        <div>
                            <label for="projectedRevenue" class="block text-gray-600 mb-1">Projected Revenue ($/year)</label>
                            <input type="text" id="projectedRevenue" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500" placeholder="e.g., 500,000">
                            <p id="projectedRevenue-error" class="text-red-500 text-sm mt-1 hidden">Please enter a valid number.</p>
                        </div>
                        <div>
                            <label for="expectedGrowthRate" class="block text-gray-600 mb-1">Expected Growth Rate (%)</label>
                            <input type="number" id="expectedGrowthRate" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500" placeholder="e.g., 20">
                            <p id="expectedGrowthRate-error" class="text-red-500 text-sm mt-1 hidden">Please enter a valid percentage (0-100).</p>
                        </div>
                    </div>
                    <div id="dcfFields" class="mt-4 hidden">
                        <h4 class="text-lg font-semibold text-gray-800 mb-2">DCF Inputs</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6 gap-y-8">
                            <div>
                                <label for="cashFlow1" class="block text-gray-600 mb-1">Year 1 Cash Flow ($)</label>
                                <input type="text" id="cashFlow1" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500" placeholder="e.g., 100,000">
                                <p id="cashFlow1-error" class="text-red-500 text-sm mt-1 hidden">Please enter a valid number.</p>
                            </div>
                            <div>
                                <label for="cashFlow2" class="block text-gray-600 mb-1">Year 2 Cash Flow ($)</label>
                                <input type="text" id="cashFlow2" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500" placeholder="e.g., 120,000">
                                <p id="cashFlow2-error" class="text-red-500 text-sm mt-1 hidden">Please enter a valid number.</p>
                            </div>
                            <div>
                                <label for="cashFlow3" class="block text-gray-600 mb-1">Year 3 Cash Flow ($)</label>
                                <input type="text" id="cashFlow3" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500" placeholder="e.g., 150,000">
                                <p id="cashFlow3-error" class="text-red-500 text-sm mt-1 hidden">Please enter a valid number.</p>
                            </div>
                            <div>
                                <label for="cashFlow4" class="block text-gray-600 mb-1">Year 4 Cash Flow ($)</label>
                                <input type="text" id="cashFlow4" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500" placeholder="e.g., 180,000">
                                <p id="cashFlow4-error" class="text-red-500 text-sm mt-1 hidden">Please enter a valid number.</p>
                            </div>
                            <div>
                                <label for="cashFlow5" class="block text-gray-600 mb-1">Year 5 Cash Flow ($)</label>
                                <input type="text" id="cashFlow5" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500" placeholder="e.g., 200,000">
                                <p id="cashFlow5-error" class="text-red-500 text-sm mt-1 hidden">Please enter a valid number.</p>
                            </div>
                            <div>
                                <label for="discountRate" class="block text-gray-600 mb-1">Discount Rate (%)</label>
                                <input type="number" id="discountRate" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500" placeholder="e.g., 10">
                                <p id="discountRate-error" class="text-red-500 text-sm mt-1 hidden">Please enter a valid percentage (0-100).</p>
                            </div>
                            <div>
                                <label for="terminalGrowthRate" class="block text-gray-600 mb-1">Terminal Growth Rate (%)</label>
                                <input type="number" id="terminalGrowthRate" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500" placeholder="e.g., 3">
                                <p id="terminalGrowthRate-error" class="text-red-500 text-sm mt-1 hidden">Please enter a valid percentage (0-100).</p>
                            </div>
                        </div>
                    </div>
                    <div id="earningsFields" class="mt-4 hidden">
                        <h4 class="text-lg font-semibold text-gray-800 mb-2">Earnings-Based Inputs</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6 gap-y-8">
                            <div>
                                <label for="assets" class="block text-gray-600 mb-1">Total Assets ($)</label>
                                <input type="text" id="assets" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500" placeholder="e.g., 300,000">
                                <p id="assets-error" class="text-red-500 text-sm mt-1 hidden">Please enter a valid number.</p>
                            </div>
                        </div>
                    </div>
                    <div class="mt-6 flex justify-between">
                        <button id="prev-btn-6" class="btn-secondary font-bold py-2 px-4 rounded-lg">Previous</button>
                        <button onclick="calculateValuation()" class="btn-primary text-white font-bold py-2 px-4 rounded-lg">Calculate Valuation</button>
                    </div>
                </div>
            </div>
            <aside class="mt-8 lg:mt-0">
                <div class="bg-gray-50 border border-gray-200 rounded-lg p-4 shadow-sm sticky top-4">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="text-lg font-semibold text-gray-800">Your summary</h4>
                        <span class="text-xs text-gray-500">Auto-saves</span>
                    </div>
                    <div class="space-y-3 text-sm" id="summary-content">
                        <div>
                            <p class="text-gray-500">Valuation methods</p>
                            <p class="font-semibold text-gray-800" data-summary-field="methods">Add at least one method</p>
                        </div>
                        <div class="border-t border-gray-200 pt-3">
                            <p class="text-gray-500">Owner salary</p>
                            <p class="font-semibold text-gray-800" data-summary-field="ownerSalary">Enter amount</p>
                        </div>
                        <div class="border-t border-gray-200 pt-3">
                            <p class="text-gray-500">Operating expenses</p>
                            <p class="font-semibold text-gray-800" data-summary-field="expenses">Enter amount</p>
                        </div>
                        <div class="border-t border-gray-200 pt-3">
                            <p class="text-gray-500">Team size</p>
                            <p class="font-semibold text-gray-800" data-summary-field="staffNumber">Add headcount</p>
                        </div>
                        <div class="border-t border-gray-200 pt-3">
                            <p class="text-gray-500">Customer metrics</p>
                            <p class="font-semibold text-gray-800" data-summary-field="customerMetrics">Add LTV, CAC, churn</p>
                        </div>
                        <div class="border-t border-gray-200 pt-3">
                            <p class="text-gray-500">Projected revenue</p>
                            <p class="font-semibold text-gray-800" data-summary-field="projectedRevenue">Add revenue & growth</p>
                        </div>
                    </div>
                    <div class="mt-4 bg-white border border-gray-200 rounded-lg p-4 space-y-3">
                        <div class="flex items-center gap-3">
                            <img src="favicon-96x96.png" alt="SaaS Valuation App badge" class="h-10 w-10 rounded shadow-sm">
                            <div>
                                <p class="text-sm font-semibold text-gray-800">Email my valuation</p>
                                <p class="text-xs text-gray-600">Enter your email to view and keep your results.</p>
                            </div>
                        </div>
                        <div>
                            <label for="valuationEmail" class="block text-sm font-semibold text-gray-700 mb-1">Email address</label>
                            <input type="email" id="valuationEmail" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500" placeholder="you@example.com" aria-describedby="valuationEmail-helper valuationEmail-error" required aria-required="true">
                            <p id="valuationEmail-helper" class="text-xs text-gray-500 mt-1">We’ll send your valuation summary straight to your inbox.</p>
                            <p id="valuationEmail-error" class="text-red-500 text-xs mt-1 hidden">Please enter a valid email to unlock your valuation.</p>
                            <p id="valuationEmail-status" class="text-xs mt-2 text-gray-600 hidden"></p>
                        </div>
                    </div>
                </div>
            </aside>
        </div>

        <!-- Results -->
        <div id="valuationResult" class="mt-8 hidden">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">Your SaaS Valuation</h3>
                    <p class="text-3xl font-bold text-teal-500 mb-4">Valuation: <span id="valuationAmount">$0</span></p>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <h4 class="text-lg font-semibold text-gray-800 mb-2">Key Financial Metrics</h4>
                            <div id="financialMetrics" class="text-gray-600 space-y-1"></div>
                        </div>
                        <div>
                            <h4 class="text-lg font-semibold text-gray-800 mb-2">Valuation Ranges</h4>
                            <div id="valuationRanges" class="text-gray-600 space-y-1"></div>
                        </div>
                        <div>
                            <h4 class="text-lg font-semibold text-gray-800 mb-2">Valuation Factors</h4>
                            <div id="valuationFactors" class="text-gray-600 space-y-1"></div>
                        </div>
                    </div>
                    <div class="mt-6 flex space-x-4">
                        <button onclick="exportResults()" class="btn-primary text-white font-bold py-2 px-4 rounded-lg">Export as PDF</button>
                        <button onclick="saveProgress()" class="btn-secondary font-bold py-2 px-4 rounded-lg">Save Progress</button>
                        <button id="start-over" class="btn-secondary font-bold py-2 px-4 rounded-lg">Start Over</button>
                    </div>
                </div>

                <!-- Charts -->
                <div id="chartsSection" class="mt-8 hidden">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">Valuation Insights</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6 gap-y-8">
                        <div>
                            <h4 class="text-lg font-semibold text-gray-800 mb-2">Valuation Comparison</h4>
                            <canvas id="valuationChart" aria-label="Valuation comparison chart"></canvas>
                        </div>
                        <div>
                            <h4 class="text-lg font-semibold text-gray-800 mb-2">Revenue Comparison</h4>
                            <canvas id="incomeChart" aria-label="Revenue comparison chart"></canvas>
                        </div>
                        <div id="dcfChartContainer" class="hidden">
                            <h4 class="text-lg font-semibold text-gray-800 mb-2">DCF Valuation Analysis</h4>
                            <canvas id="dcfChart" aria-label="Discounted cash flow chart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mt-12 bg-teal-50 border border-teal-100 rounded-2xl p-6 text-center">
                <p class="text-sm uppercase tracking-wide text-teal-700 font-semibold">Want the investor version?</p>
                <h3 class="text-2xl font-bold text-gray-800 mt-1">Upgrade to Pro for the shareable PDF and AI commentary</h3>
                <p class="text-gray-700 mt-2">Keep exploring the free valuation, then unlock benchmarks, risk notes, and a polished export when you're ready.</p>
                <div class="mt-4 flex justify-center gap-3">
                    <a href="payment.html" class="btn-primary text-white font-bold py-3 px-6 rounded-lg">Unlock Pro report</a>
                    <a href="#pricing" class="btn-secondary font-bold py-3 px-6 rounded-lg">Compare plans</a>
                </div>
            </div>
        </div>
    </section>
   <!-- CTA + Newsletter -->
    <section class="py-12 bg-gray-100">
        <div class="container mx-auto px-6">
            <div class="bg-white rounded-2xl shadow-xl p-8 md:p-10 grid grid-cols-1 md:grid-cols-2 gap-10 items-center">
                <div class="space-y-4">
                    <p class="text-sm font-semibold text-teal-600 uppercase">Unlock advanced insights</p>
                    <h2 class="text-3xl font-bold text-gray-800">Upgrade your valuation playbook</h2>
                    <p class="text-gray-600">Get your free SaaS valuation now and explore Pro for AI-powered analytics and investor-ready reports.</p>
                    <div class="flex flex-col sm:flex-row gap-3">
                        <a href="/payment.html" class="btn-primary text-white font-bold py-3 px-6 rounded-lg text-center">Try Pro Now</a>
                        <a href="saas-growth-calculator.html" class="btn-secondary text-white font-bold py-3 px-6 rounded-lg text-center">Model Your Growth</a>
                    </div>
                </div>
                <div class="bg-gray-50 rounded-xl p-6 space-y-4">
                    <div class="space-y-2">
                        <p class="text-sm font-semibold text-teal-600 uppercase">Newsletter</p>
                        <h3 class="text-2xl font-bold text-gray-800">Get SaaS Growth Insights</h3>
                        <p class="text-gray-600">Subscribe for exclusive tips, valuation strategies, and product updates.</p>
                    </div>
                    <form action="https://formspree.io/f/mjkowkld" method="POST" class="space-y-3">
                        <div>
                            <label for="email" class="block text-sm font-medium text-gray-700 mb-1">Your Email</label>
                            <input type="email" name="email" id="email" class="w-full border rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-teal-500" placeholder="Enter your email" required aria-required="true">
                            <p id="email-error" class="text-red-500 text-sm mt-1 hidden">Please enter a valid email address.</p>
                        </div>
                        <button type="submit" class="btn-primary w-full text-white font-bold py-3 px-6 rounded-lg">Get SaaS Growth Insights</button>
                    </form>
                </div>
            </div>
        </div>
    </section>
            

    <!-- JavaScript -->
    <script>
        // Mobile menu toggle
        document.getElementById('menu-toggle').addEventListener('click', () => {
            const mobileMenu = document.getElementById('mobile-menu');
            mobileMenu.classList.toggle('hidden');
        });

        // Valuation form navigation
        let currentStep = 1;
        const totalSteps = 6;
        const steps = document.querySelectorAll('.step');
        const progressFill = document.getElementById('progress-fill');
        const stepLabels = [
            'Select Valuation Method',
            'Financial Information',
            'Customer Metrics',
            'Industry Details',
            'Technology & IP',
            'Future Projections'
        ];
        const stepLabelDisplay = document.getElementById('current-step-label');

        const savedIndicatorTargets = document.querySelectorAll('#valuation-form input[type="text"], #valuation-form input[type="number"], #valuation-form input[type="email"], #valuation-form select');
        savedIndicatorTargets.forEach(field => {
            if (!field.parentElement.querySelector('.saved-indicator')) {
                const indicator = document.createElement('p');
                indicator.className = 'text-green-600 text-xs mt-1 saved-indicator hidden';
                indicator.innerHTML = '<i class="fas fa-check-circle"></i> Saved';
                const errorElement = field.parentElement.querySelector(`#${field.id}-error`);
                if (errorElement) {
                    errorElement.insertAdjacentElement('beforebegin', indicator);
                } else {
                    field.insertAdjacentElement('afterend', indicator);
                }
            }
        });

        const valuationEmailInput = document.getElementById('valuationEmail');
        const valuationEmailError = document.getElementById('valuationEmail-error');
        if (valuationEmailInput) {
            valuationEmailInput.addEventListener('input', () => {
                const emailValue = valuationEmailInput.value.trim();
                const isEmailValid = emailValue === '' ? true : isValidEmail(emailValue);
                setFieldState(valuationEmailInput, valuationEmailError, isEmailValid);
                if (!emailValue) {
                    document.getElementById('valuationEmail-status').classList.add('hidden');
                }
            });
        }

        function cleanNumericInput(value, regex, allowEmpty = false) {
            const cleanedValue = value.replace(/,/g, '').trim();
            if (allowEmpty && cleanedValue === '') return true;
            return regex.test(cleanedValue) && cleanedValue !== '';
        }

        function toggleSavedIndicator(element, isVisible) {
            const indicator = element.parentElement.querySelector('.saved-indicator');
            if (indicator) {
                indicator.classList.toggle('hidden', !isVisible);
            }
        }

        function setFieldState(element, errorElement, isFieldValid) {
            const hasValue = element.value.trim() !== '';
            if (!isFieldValid) {
                element.classList.remove('input-valid');
                element.classList.add('input-error');
                if (errorElement) errorElement.classList.remove('hidden');
                toggleSavedIndicator(element, false);
                return;
            }

            element.classList.remove('input-error');
            if (hasValue) {
                element.classList.add('input-valid');
                toggleSavedIndicator(element, true);
            } else {
                element.classList.remove('input-valid');
                toggleSavedIndicator(element, false);
            }
            if (errorElement) errorElement.classList.add('hidden');
        }

        function isValidEmail(email) {
            return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
        }

        function updateEmailStatus(message, isSuccess = true) {
            const statusEl = document.getElementById('valuationEmail-status');
            if (!statusEl) return;
            statusEl.textContent = message;
            statusEl.classList.toggle('text-green-600', isSuccess);
            statusEl.classList.toggle('text-red-600', !isSuccess);
            statusEl.classList.remove('hidden');
        }

        const summaryFields = {
            methods: document.querySelector('[data-summary-field="methods"]'),
            ownerSalary: document.querySelector('[data-summary-field="ownerSalary"]'),
            expenses: document.querySelector('[data-summary-field="expenses"]'),
            staffNumber: document.querySelector('[data-summary-field="staffNumber"]'),
            customerMetrics: document.querySelector('[data-summary-field="customerMetrics"]'),
            projectedRevenue: document.querySelector('[data-summary-field="projectedRevenue"]')
        };

        function formatCurrencyDisplay(value) {
            const cleaned = value.replace(/,/g, '').trim();
            if (cleaned === '' || isNaN(parseFloat(cleaned))) return null;
            return `$${Number(cleaned).toLocaleString()}`;
        }

        function formatPercentDisplay(value) {
            const cleaned = value.trim();
            if (cleaned === '' || isNaN(parseFloat(cleaned))) return null;
            return `${cleaned}%`;
        }

        function updateSummary() {
            if (!summaryFields.methods) return;
            const methodsSelected = Array.from(document.querySelectorAll('input[type="checkbox"]:checked')).map(cb => cb.nextElementSibling.textContent.trim());
            summaryFields.methods.textContent = methodsSelected.length ? methodsSelected.join(', ') : 'Add at least one method';

            summaryFields.ownerSalary.textContent = formatCurrencyDisplay(document.getElementById('ownerSalary').value) || 'Enter amount';
            summaryFields.expenses.textContent = formatCurrencyDisplay(document.getElementById('expenses').value) || 'Enter amount';

            const staffValue = document.getElementById('staffNumber').value.trim();
            summaryFields.staffNumber.textContent = staffValue ? `${staffValue} team members` : 'Add headcount';

            const ltvText = formatCurrencyDisplay(document.getElementById('ltv').value);
            const cacText = formatCurrencyDisplay(document.getElementById('cac').value);
            const churnText = formatPercentDisplay(document.getElementById('churnRate').value);
            summaryFields.customerMetrics.textContent = (ltvText || cacText || churnText)
                ? `LTV ${ltvText || '—'}, CAC ${cacText || '—'}, Churn ${churnText || '—'}`
                : 'Add LTV, CAC, churn';

            const projectedText = formatCurrencyDisplay(document.getElementById('projectedRevenue').value);
            const growthText = formatPercentDisplay(document.getElementById('expectedGrowthRate').value);
            summaryFields.projectedRevenue.textContent = projectedText && growthText
                ? `${projectedText} at ${growthText} growth`
                : (projectedText || growthText || 'Add revenue & growth');
        }

        function updateProgress() {
            const progress = (currentStep / totalSteps) * 100;
            progressFill.style.width = `${progress}%`;
            progressFill.setAttribute('aria-valuenow', currentStep);
            progressFill.setAttribute('aria-valuemin', 1);
            progressFill.setAttribute('aria-valuemax', totalSteps);
            document.getElementById('current-step').textContent = currentStep;
            if (stepLabelDisplay) {
                stepLabelDisplay.textContent = `Currently: ${stepLabels[currentStep - 1] || ''}`;
            }
        }

        function showStep(step) {
            steps.forEach((s, index) => {
                s.classList.toggle('step-visible', index + 1 === step);
                s.classList.toggle('step-hidden', index + 1 !== step);
            });
            updateProgress();
            updateSummary();
        }

        function validateStep(step) {
            let isValid = true;

            if (step === 1) {
                const methods = document.querySelectorAll('input[type="checkbox"]:checked');
                const methodError = document.getElementById('method-error');
                if (methods.length < 1 || methods.length > 3) {
                    methodError.classList.remove('hidden');
                    isValid = false;
                } else {
                    methodError.classList.add('hidden');
                }

                const dcfSelected = document.getElementById('method-dcf').checked;
                const earningsSelected = document.getElementById('method-earnings').checked;
                document.getElementById('dcfFields').classList.toggle('hidden', !dcfSelected);
                document.getElementById('earningsFields').classList.toggle('hidden', !earningsSelected);
                document.getElementById('dcfChartContainer').classList.toggle('hidden', !dcfSelected);
            }

            if (step === 2) {
                const inputs = [
                    { id: 'ownerSalary', error: 'ownerSalary-error', regex: /^\d+(\.\d{1,2})?$/ },
                    { id: 'averageSalary', error: 'averageSalary-error', regex: /^\d+(\.\d{1,2})?$/ },
                    { id: 'employeeBenefits', error: 'employeeBenefits-error', regex: /^\d+(\.\d{1,2})?$/ },
                    { id: 'staffNumber', error: 'staffNumber-error', regex: /^\d+$/ },
                    { id: 'expenses', error: 'expenses-error', regex: /^\d+(\.\d{1,2})?$/ },
                    { id: 'debt', error: 'debt-error', regex: /^\d+(\.\d{1,2})?$/, allowEmpty: true },
                    { id: 'growthRate', error: 'growthRate-error', regex: /^(100|[0-9]{1,2})$/ },
                    { id: 'yearsOperating', error: 'yearsOperating-error', regex: /^\d+$/ }
                ];

                inputs.forEach(input => {
                    const element = document.getElementById(input.id);
                    const errorElement = document.getElementById(input.error);
                    const fieldValid = cleanNumericInput(element.value, input.regex, input.allowEmpty);
                    setFieldState(element, errorElement, fieldValid);
                    if (!fieldValid) isValid = false;
                });
            }

            if (step === 3) {
                const inputs = [
                    { id: 'ltv', error: 'ltv-error', regex: /^\d+(\.\d{1,2})?$/ },
                    { id: 'cac', error: 'cac-error', regex: /^\d+(\.\d{1,2})?$/ },
                    { id: 'churnRate', error: 'churnRate-error', regex: /^(100|[0-9]{1,2})$/ },
                    { id: 'customerGrowthRate', error: 'customerGrowthRate-error', regex: /^(100|[0-9]{1,2})$/ }
                ];

                inputs.forEach(input => {
                    const element = document.getElementById(input.id);
                    const errorElement = document.getElementById(input.error);
                    const fieldValid = cleanNumericInput(element.value, input.regex);
                    setFieldState(element, errorElement, fieldValid);
                    if (!fieldValid) isValid = false;
                });
            }

            if (step === 4) {
                const industry = document.getElementById('industry');
                const industryError = document.getElementById('industry-error');
                const fieldValid = !!industry.value;
                setFieldState(industry, industryError, fieldValid);
                if (!fieldValid) isValid = false;
            }

            if (step === 5) {
                const aiReplaceable = document.getElementById('aiReplaceable');
                const aiReplaceableError = document.getElementById('aiReplaceable-error');
                const hasIP = document.getElementById('hasIP');
                const hasIPError = document.getElementById('hasIP-error');

                const aiReplaceValid = !!aiReplaceable.value;
                setFieldState(aiReplaceable, aiReplaceableError, aiReplaceValid);
                if (!aiReplaceValid) isValid = false;

                if (aiReplaceable.value === 'yes') {
                    const aiReplaceCount = document.getElementById('aiReplaceCount');
                    const aiReplaceCountError = document.getElementById('aiReplaceCount-error');
                    const fieldValid = cleanNumericInput(aiReplaceCount.value, /^\d+$/);
                    setFieldState(aiReplaceCount, aiReplaceCountError, fieldValid);
                    if (!fieldValid) isValid = false;
                }

                const hasIPValid = !!hasIP.value;
                setFieldState(hasIP, hasIPError, hasIPValid);
                if (!hasIPValid) isValid = false;

                if (hasIP.value === 'yes') {
                    const ipValue = document.getElementById('ipValue');
                    const ipValueError = document.getElementById('ipValue-error');
                    const ipUnique = document.getElementById('ipUnique');
                    const ipUniqueError = document.getElementById('ipUnique-error');

                    const ipValueValid = cleanNumericInput(ipValue.value, /^\d+(\.\d{1,2})?$/);
                    const ipUniqueValid = !!ipUnique.value;
                    setFieldState(ipValue, ipValueError, ipValueValid);
                    setFieldState(ipUnique, ipUniqueError, ipUniqueValid);
                    if (!ipValueValid || !ipUniqueValid) isValid = false;
                }
            }

            if (step === 6) {
                const inputs = [
                    { id: 'projectedRevenue', error: 'projectedRevenue-error', regex: /^\d+(\.\d{1,2})?$/ },
                    { id: 'expectedGrowthRate', error: 'expectedGrowthRate-error', regex: /^(100|[0-9]{1,2})$/ }
                ];

                inputs.forEach(input => {
                    const element = document.getElementById(input.id);
                    const errorElement = document.getElementById(input.error);
                    const fieldValid = cleanNumericInput(element.value, input.regex);
                    setFieldState(element, errorElement, fieldValid);
                    if (!fieldValid) isValid = false;
                });

                if (document.getElementById('method-dcf').checked) {
                    const dcfInputs = [
                        { id: 'cashFlow1', error: 'cashFlow1-error', regex: /^\d+(\.\d{1,2})?$/ },
                        { id: 'cashFlow2', error: 'cashFlow2-error', regex: /^\d+(\.\d{1,2})?$/ },
                        { id: 'cashFlow3', error: 'cashFlow3-error', regex: /^\d+(\.\d{1,2})?$/ },
                        { id: 'cashFlow4', error: 'cashFlow4-error', regex: /^\d+(\.\d{1,2})?$/ },
                        { id: 'cashFlow5', error: 'cashFlow5-error', regex: /^\d+(\.\d{1,2})?$/ },
                        { id: 'discountRate', error: 'discountRate-error', regex: /^(100|[0-9]{1,2})$/ },
                        { id: 'terminalGrowthRate', error: 'terminalGrowthRate-error', regex: /^(100|[0-9]{1,2})$/ }
                    ];

                    dcfInputs.forEach(input => {
                        const element = document.getElementById(input.id);
                        const errorElement = document.getElementById(input.error);
                        const fieldValid = cleanNumericInput(element.value, input.regex);
                        setFieldState(element, errorElement, fieldValid);
                        if (!fieldValid) isValid = false;
                    });
                }

                if (document.getElementById('method-earnings').checked) {
                    const assets = document.getElementById('assets');
                    const assetsError = document.getElementById('assets-error');
                    const fieldValid = cleanNumericInput(assets.value, /^\d+(\.\d{1,2})?$/);
                    setFieldState(assets, assetsError, fieldValid);
                    if (!fieldValid) isValid = false;
                }
            }

            return isValid;
        }

        updateProgress();
        updateSummary();

        ['ownerSalary', 'expenses', 'staffNumber', 'ltv', 'cac', 'churnRate', 'projectedRevenue', 'expectedGrowthRate'].forEach(id => {
            const field = document.getElementById(id);
            if (field) {
                field.addEventListener('input', updateSummary);
            }
        });

        ['method-multiplier', 'method-income', 'method-earnings', 'method-dcf'].forEach(id => {
            const checkbox = document.getElementById(id);
            if (checkbox) {
                checkbox.addEventListener('change', updateSummary);
            }
        });

        document.getElementById('next-btn-1').addEventListener('click', () => {
            if (validateStep(1)) {
                currentStep = 2;
                showStep(currentStep);
            }
        });

        document.getElementById('next-btn-2').addEventListener('click', () => {
            if (validateStep(2)) {
                currentStep = 3;
                showStep(currentStep);
            }
        });

        document.getElementById('next-btn-3').addEventListener('click', () => {
            if (validateStep(3)) {
                currentStep = 4;
                showStep(currentStep);
            }
        });

        document.getElementById('next-btn-4').addEventListener('click', () => {
            if (validateStep(4)) {
                currentStep = 5;
                showStep(currentStep);
            }
        });

        document.getElementById('next-btn-5').addEventListener('click', () => {
            if (validateStep(5)) {
                currentStep = 6;
                showStep(currentStep);
            }
        });

        document.getElementById('prev-btn-2').addEventListener('click', () => {
            currentStep = 1;
            showStep(currentStep);
        });

        document.getElementById('prev-btn-3').addEventListener('click', () => {
            currentStep = 2;
            showStep(currentStep);
        });

        document.getElementById('prev-btn-4').addEventListener('click', () => {
            currentStep = 3;
            showStep(currentStep);
        });

        document.getElementById('prev-btn-5').addEventListener('click', () => {
            currentStep = 4;
            showStep(currentStep);
        });

        document.getElementById('prev-btn-6').addEventListener('click', () => {
            currentStep = 5;
            showStep(currentStep);
        });

        // Slider value display
        ['scalability', 'marketTrendImpact', 'competitivePositioning', 'marketVolatility', 'operationalEfficiency'].forEach(id => {
            const slider = document.getElementById(id);
            const valueDisplay = document.getElementById(`${id}Value`);
            slider.addEventListener('input', () => {
                valueDisplay.textContent = slider.value;
            });
        });

        // Toggle AI Replacement and IP fields
        window.toggleAIReplacement = function() {
            const aiReplaceable = document.getElementById('aiReplaceable').value;
            document.getElementById('aiReplaceCountSection').classList.toggle('hidden', aiReplaceable !== 'yes');
        };

        window.toggleIPFields = function() {
            const hasIP = document.getElementById('hasIP').value;
            document.getElementById('ipValueSection').classList.toggle('hidden', hasIP !== 'yes');
            document.getElementById('ipUniqueSection').classList.toggle('hidden', hasIP !== 'yes');
        };

        // Valuation calculation
        let valuationData = {};

        async function sendValuationToFormspree(email, payload) {
            try {
                updateEmailStatus('Sending your valuation…', true);
                const response = await fetch('https://formspree.io/f/mayydjvv', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, ...payload })
                });

                if (response.ok) {
                    updateEmailStatus('Sent! Check your inbox for a copy of your valuation inputs.', true);
                } else {
                    updateEmailStatus('We could not send your valuation right now. Please try again.', false);
                }
            } catch (error) {
                console.error('Formspree error', error);
                updateEmailStatus('We could not send your valuation right now. Please try again.', false);
            }
        }

        window.calculateValuation = function() {
            if (!validateStep(6)) return;

            const emailValue = valuationEmailInput ? valuationEmailInput.value.trim() : '';
            const emailIsValid = isValidEmail(emailValue);
            if (!emailValue || !emailIsValid) {
                if (valuationEmailInput) {
                    setFieldState(valuationEmailInput, valuationEmailError, false);
                    updateEmailStatus('Enter a valid email to see your valuation.', false);
                    valuationEmailInput.focus();
                }
                return;
            }
            if (valuationEmailInput) {
                setFieldState(valuationEmailInput, valuationEmailError, true);
            }

            const methods = Array.from(document.querySelectorAll('input[type="checkbox"]:checked')).map(cb => cb.value);
            const businessModel = document.getElementById('businessModel').value || 'saas';
            const ownerSalary = parseFloat(document.getElementById('ownerSalary').value.replace(/,/g, '')) || 0;
            const averageSalary = parseFloat(document.getElementById('averageSalary').value.replace(/,/g, '')) || 0;
            const employeeBenefits = parseFloat(document.getElementById('employeeBenefits').value.replace(/,/g, '')) || 0;
            const staffNumber = parseInt(document.getElementById('staffNumber').value) || 0;
            const expenses = parseFloat(document.getElementById('expenses').value.replace(/,/g, '')) || 0;
            const debt = parseFloat(document.getElementById('debt').value.replace(/,/g, '')) || 0;
            const growthRate = parseFloat(document.getElementById('growthRate').value) || 0;
            const yearsOperating = parseInt(document.getElementById('yearsOperating').value) || 0;
            const scalability = parseInt(document.getElementById('scalability').value) || 5;
            const ltv = parseFloat(document.getElementById('ltv').value.replace(/,/g, '')) || 0;
            const cac = parseFloat(document.getElementById('cac').value.replace(/,/g, '')) || 0;
            const churnRate = parseFloat(document.getElementById('churnRate').value) || 0;
            const customerGrowthRate = parseFloat(document.getElementById('customerGrowthRate').value) || 0;
            const industry = document.getElementById('industry').value || '';
            const marketTrendImpact = parseInt(document.getElementById('marketTrendImpact').value) || 5;
            const competitivePositioning = parseInt(document.getElementById('competitivePositioning').value) || 5;
            const marketVolatility = parseInt(document.getElementById('marketVolatility').value) || 5;
            const aiReplaceable = document.getElementById('aiReplaceable').value || 'no';
            const aiReplaceCount = aiReplaceable === 'yes' ? parseInt(document.getElementById('aiReplaceCount').value) || 0 : 0;
            const hasIP = document.getElementById('hasIP').value || 'no';
            const ipValue = hasIP === 'yes' ? parseFloat(document.getElementById('ipValue').value.replace(/,/g, '')) || 0 : 0;
            const ipUnique = hasIP === 'yes' ? document.getElementById('ipUnique').value || 'not-unique' : 'not-unique';
            const operationalEfficiency = parseInt(document.getElementById('operationalEfficiency').value) || 5;
            const projectedRevenue = parseFloat(document.getElementById('projectedRevenue').value.replace(/,/g, '')) || 0;
            const expectedGrowthRate = parseFloat(document.getElementById('expectedGrowthRate').value) || 0;

            let valuations = {};
            const usesMultipliers = businessModel === 'saas';
            let baseMultiplier = usesMultipliers ? 3 : 1;
            const highGrowthIndustries = ['Technology', 'Healthcare', 'Finance'];

            // Adjust multiplier based on SaaS metrics
            const ltvCacRatio = cac > 0 ? ltv / cac : 0;
            if (usesMultipliers) {
                if (ltvCacRatio > 3) baseMultiplier += 1;
                if (ltvCacRatio < 1) baseMultiplier -= 1;
                if (churnRate < 5) baseMultiplier += 0.5;
                if (churnRate > 10) baseMultiplier -= 0.5;
                if (growthRate > 20) baseMultiplier += 1;
                if (customerGrowthRate > 15) baseMultiplier += 0.5;
                if (scalability > 7) baseMultiplier += 0.5;
                if (marketTrendImpact > 7) baseMultiplier += 0.5;
                if (competitivePositioning > 7) baseMultiplier += 0.5;
                if (marketVolatility > 7) baseMultiplier -= 0.5;
                if (aiReplaceable === 'yes' && aiReplaceCount > 0) baseMultiplier -= 0.5;
                if (hasIP === 'yes' && ipUnique === 'unique') baseMultiplier += 1;
                if (operationalEfficiency > 7) baseMultiplier += 0.5;
                if (highGrowthIndustries.includes(industry)) baseMultiplier += 0.5;
            }
            baseMultiplier = Math.max(1, baseMultiplier);

            if (methods.includes('multiplier')) {
                const multiplierValuation = projectedRevenue * baseMultiplier;
                valuations['Revenue Multiplier'] = {
                    value: usesMultipliers ? multiplierValuation : 0,
                    range: usesMultipliers ? [multiplierValuation * 0.9, multiplierValuation * 1.1] : [0, 0],
                    explanation: usesMultipliers
                        ? `The Revenue Multiplier method calculates your valuation by applying a multiplier of ${baseMultiplier.toFixed(1)} to your projected revenue (${projectedRevenue.toLocaleString()}). This is adjusted based on your LTV:CAC ratio (${ltvCacRatio.toFixed(1)}), churn rate (${churnRate}%), and growth rate (${growthRate}%). Factors like scalability (${scalability}/10) and competitive positioning (${competitivePositioning}/10) also influence the result, making it ideal for SaaS companies with stable revenue, though it may not fully account for future risks or growth potential.`
                        : 'Revenue multiples are disabled for non-SaaS models. Consider using income, earnings, or DCF methods instead.'
                };
            }

            if (methods.includes('income')) {
                const netIncome = projectedRevenue - expenses - (averageSalary * staffNumber) - employeeBenefits - ownerSalary - debt;
                const incomeValuation = netIncome * (baseMultiplier + 1);
                valuations['Income-Based'] = {
                    value: incomeValuation,
                    range: [incomeValuation * 0.85, incomeValuation * 1.15],
                    explanation: `The Income-Based method uses your net income (${netIncome.toLocaleString()}), calculated from projected revenue (${projectedRevenue.toLocaleString()}) minus expenses (${expenses.toLocaleString()}) and staff costs (${(averageSalary * staffNumber + employeeBenefits + ownerSalary).toLocaleString()}), multiplied by ${baseMultiplier + 1}. Adjustments for operational efficiency (${operationalEfficiency}/10) and market volatility (${marketVolatility}/10) are included. This suits profitable businesses but may undervalue high-growth SaaS firms due to reinvestment, with debt (${debt.toLocaleString()}) factored in as a reduction.`
                };
            }

            if (methods.includes('earnings')) {
                const assets = parseFloat(document.getElementById('assets').value.replace(/,/g, '')) || 0;
                const earningsValuation = (projectedRevenue * (baseMultiplier - 1)) + assets - debt;
                valuations['Earnings-Based'] = {
                    value: earningsValuation,
                    range: [earningsValuation * 0.9, earningsValuation * 1.1],
                    explanation: `The Earnings-Based method combines your adjusted revenue (${(projectedRevenue * (baseMultiplier - 1)).toLocaleString()}) with assets (${assets.toLocaleString()}) and subtracts debt (${debt.toLocaleString()}), yielding ${earningsValuation.toLocaleString()}. It considers years in operation (${yearsOperating}) and competitive positioning (${competitivePositioning}/10). This is effective for asset-rich firms but may overlook intangible value like brand strength in SaaS, with market trends (${marketTrendImpact}/10) also influencing the result.`
                };
            }

            if (methods.includes('dcf')) {
                const cashFlows = [
                    parseFloat(document.getElementById('cashFlow1').value.replace(/,/g, '')) || 0,
                    parseFloat(document.getElementById('cashFlow2').value.replace(/,/g, '')) || 0,
                    parseFloat(document.getElementById('cashFlow3').value.replace(/,/g, '')) || 0,
                    parseFloat(document.getElementById('cashFlow4').value.replace(/,/g, '')) || 0,
                    parseFloat(document.getElementById('cashFlow5').value.replace(/,/g, '')) || 0
                ];
                const discountRate = (parseFloat(document.getElementById('discountRate').value) || 10) / 100;
                const terminalGrowthRate = (parseFloat(document.getElementById('terminalGrowthRate').value) || 3) / 100;

                let dcfValuation = 0;
                for (let i = 0; i < cashFlows.length; i++) {
                    dcfValuation += cashFlows[i] / Math.pow(1 + discountRate, i + 1);
                }
                const terminalValue = (cashFlows[4] * (1 + terminalGrowthRate)) / (discountRate - terminalGrowthRate);
                dcfValuation += terminalValue / Math.pow(1 + discountRate, 5);

                valuations['DCF'] = {
                    value: dcfValuation,
                    range: [dcfValuation * 0.95, dcfValuation * 1.05],
                    explanation: `The DCF method discounts your projected cash flows (e.g., Year 1: ${cashFlows[0].toLocaleString()}, Year 5: ${cashFlows[4].toLocaleString()}) at a ${discountRate * 100}% rate, adding a terminal value based on a ${terminalGrowthRate * 100}% growth rate, resulting in ${dcfValuation.toLocaleString()}. This captures future cash flow potential, ideal for predictable SaaS models, but is sensitive to discount rate and growth assumptions. Market volatility (${marketVolatility}/10) was factored in to refine the estimate.`
                };
            }

            const valuationValues = Object.values(valuations).map(v => v.value);
            const averageValuation = valuationValues.length ? valuationValues.reduce((a, b) => a + b, 0) / valuationValues.length : 0;
            const methodSummaries = Object.entries(valuations).map(([method, data]) => `${method}: $${Math.round(data.value).toLocaleString()}`);

            valuationData = {
                methods: valuations,
                average: averageValuation,
                financials: {
                    'Projected Revenue': projectedRevenue.toLocaleString(),
                    'Net Income': (projectedRevenue - expenses - (averageSalary * staffNumber) - employeeBenefits - ownerSalary - debt).toLocaleString(),
                    'LTV:CAC Ratio': ltvCacRatio.toFixed(2),
                    'Churn Rate': `${churnRate}%`,
                    'Growth Rate': `${growthRate}%`
                },
                factors: {
                    'Business Model': usesMultipliers ? 'SaaS (multiples applied)' : 'Non-SaaS (multiples disabled)',
                    'Scalability': `${scalability}/10`,
                    'Market Trends': `${marketTrendImpact}/10`,
                    'Competitive Positioning': `${competitivePositioning}/10`,
                    'Market Volatility': `${marketVolatility}/10`,
                    'Operational Efficiency': `${operationalEfficiency}/10`
                },
                cashFlows: methods.includes('dcf') ? cashFlows : []
            };

            document.getElementById('valuationAmount').textContent = `$${Math.round(averageValuation).toLocaleString()}`;

            const financialMetrics = document.getElementById('financialMetrics');
            financialMetrics.innerHTML = '';
            for (const [key, value] of Object.entries(valuationData.financials)) {
                financialMetrics.innerHTML += `<p>${key}: ${value}</p>`;
            }

            const valuationRanges = document.getElementById('valuationRanges');
            valuationRanges.innerHTML = '';
            for (const [method, data] of Object.entries(valuations)) {
                valuationRanges.innerHTML += `<p>${method}: $${Math.round(data.range[0]).toLocaleString()} - $${Math.round(data.range[1]).toLocaleString()}</p>`;
            }

            const valuationFactors = document.getElementById('valuationFactors');
            valuationFactors.innerHTML = '';
            for (const [key, value] of Object.entries(valuationData.factors)) {
                valuationFactors.innerHTML += `<p>${key}: ${value}</p>`;
            }

            document.getElementById('valuationResult').classList.remove('hidden');
            document.getElementById('chartsSection').classList.remove('hidden');
            steps.forEach(s => {
                s.classList.add('step-hidden');
                s.classList.remove('step-visible');
            });

            const valuationChart = new Chart(document.getElementById('valuationChart'), {
                type: 'bar',
                data: {
                    labels: Object.keys(valuations),
                    datasets: [{
                        label: 'Valuation ($)',
                        data: Object.values(valuations).map(v => v.value),
                        backgroundColor: 'rgba(56, 178, 172, 0.6)',
                        borderColor: 'rgba(56, 178, 172, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: { display: true, text: 'Valuation ($)' }
                        }
                    },
                    plugins: { title: { display: true, text: 'Valuation Comparison' } }
                }
            });

            const incomeChart = new Chart(document.getElementById('incomeChart'), {
                type: 'line',
                data: {
                    labels: ['Current', 'Projected'],
                    datasets: [{
                        label: 'Revenue ($)',
                        data: [projectedRevenue / (1 + expectedGrowthRate / 100), projectedRevenue],
                        fill: false,
                        borderColor: 'rgba(56, 178, 172, 1)',
                        tension: 0.1
                    }]
                },
                options: {
                    scales: {
                        y: { beginAtZero: true, title: { display: true, text: 'Revenue ($)' } }
                    },
                    plugins: { title: { display: true, text: 'Revenue Comparison' } }
                }
            });

            if (methods.includes('dcf')) {
                const dcfChart = new Chart(document.getElementById('dcfChart'), {
                    type: 'line',
                    data: {
                        labels: ['Year 1', 'Year 2', 'Year 3', 'Year 4', 'Year 5'],
                        datasets: [{
                            label: 'Cash Flow ($)',
                            data: valuationData.cashFlows,
                            fill: false,
                            borderColor: 'rgba(56, 178, 172, 1)',
                            tension: 0.1
                        }]
                    },
                    options: {
                        scales: {
                            y: { beginAtZero: true, title: { display: true, text: 'Cash Flow ($)' } }
                        },
                        plugins: { title: { display: true, text: 'DCF Valuation Analysis' } }
                    }
                });
            }

            const submissionPayload = {
                valuation_average: `$${Math.round(averageValuation).toLocaleString()}`,
                methods: methodSummaries.join('; '),
                projected_revenue: `$${projectedRevenue.toLocaleString()}`,
                growth_rate: `${growthRate}%`,
                churn_rate: `${churnRate}%`,
                ltv_cac_ratio: ltvCacRatio.toFixed(2),
                business_model: valuationData.factors['Business Model'],
                industry,
                factors: JSON.stringify(valuationData.factors),
                financials: JSON.stringify(valuationData.financials),
                note: 'Free valuation calculator submission'
            };
            sendValuationToFormspree(emailValue, submissionPayload);
        };

        async function loadImageAsDataURL(url) {
            const response = await fetch(url);
            const blob = await response.blob();
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onloadend = () => resolve(reader.result);
                reader.onerror = reject;
                reader.readAsDataURL(blob);
            });
        }

        // Export to PDF
        window.exportResults = async function() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            doc.setFontSize(18);
            doc.setTextColor(255, 255, 255);
            doc.setFillColor(56, 178, 172);
            doc.rect(0, 0, 210, 40, 'F');
            doc.text('SaaS Valuation Report', 105, 25, { align: 'center' });

            try {
                const logoDataUrl = await loadImageAsDataURL('favicon-96x96.png');
                doc.addImage(logoDataUrl, 'PNG', 180, 8, 16, 16);
            } catch (e) {
                console.warn('Logo could not be loaded for PDF', e);
            }

            doc.setFontSize(12);
            doc.setTextColor(0, 0, 0);
            let yPosition = 50;

            doc.setFontSize(16);
            doc.setTextColor(56, 178, 172);
            doc.text('Your SaaS Valuation Overview', 20, yPosition);
            yPosition += 5;
            doc.setLineWidth(0.5);
            doc.setDrawColor(56, 178, 172);
            doc.line(20, yPosition, 190, yPosition);
            yPosition += 10;

            doc.setFontSize(14);
            doc.setTextColor(0, 0, 0);
            doc.text(`Valuation: $${Math.round(valuationData.average).toLocaleString()}`, 20, yPosition);
            yPosition += 10;
            doc.setFontSize(12);
            doc.text('Business snapshot:', 20, yPosition);
            yPosition += 8;
            const snapshotItems = [
                `Projected revenue: $${valuationData.financials['Projected Revenue']}`,
                `Growth rate: ${valuationData.financials['Growth Rate']}`,
                `Churn rate: ${valuationData.financials['Churn Rate']}`,
                `LTV:CAC ratio: ${valuationData.financials['LTV:CAC Ratio']}`,
                `Model: ${valuationData.factors['Business Model']}`
            ];
            snapshotItems.forEach(item => {
                doc.text(`• ${item}`, 20, yPosition);
                yPosition += 6;
            });
            const overviewParagraph = doc.splitTextToSize('We averaged your selected valuation methods, weighting growth, churn, and efficiency scores so investors see how the number was built.', 170);
            overviewParagraph.forEach(line => {
                doc.text(line, 20, yPosition);
                yPosition += 6;
            });
            yPosition += 4;

            doc.setFontSize(14);
            doc.setTextColor(56, 178, 172);
            doc.text('Valuation Methods', 20, yPosition);
            yPosition += 5;
            doc.line(20, yPosition, 190, yPosition);
            yPosition += 10;
            doc.setFontSize(12);
            doc.setTextColor(0, 0, 0);
            for (const [method, data] of Object.entries(valuationData.methods)) {
                doc.text(`${method}: $${Math.round(data.value).toLocaleString()}`, 20, yPosition);
                yPosition += 6;
                const explanationLines = doc.splitTextToSize(data.explanation, 170);
                explanationLines.forEach(line => {
                    doc.text(line, 20, yPosition);
                    yPosition += 6;
                });
                yPosition += 5;
            }

            doc.addPage();
            yPosition = 20;

            doc.setFontSize(14);
            doc.setTextColor(56, 178, 172);
            doc.text('Valuation Insights', 20, yPosition);
            yPosition += 5;
            doc.line(20, yPosition, 190, yPosition);
            yPosition += 10;

            const valuationCanvas = document.getElementById('valuationChart');
            const valuationImg = valuationCanvas.toDataURL('image/png');
            doc.addImage(valuationImg, 'PNG', 20, yPosition, 170, 80);
            yPosition += 90;

            const incomeCanvas = document.getElementById('incomeChart');
            const incomeImg = incomeCanvas.toDataURL('image/png');
            doc.addImage(incomeImg, 'PNG', 20, yPosition, 170, 80);
            yPosition += 90;

            if (document.getElementById('method-dcf').checked) {
                doc.addPage();
                yPosition = 20;
                const dcfCanvas = document.getElementById('dcfChart');
                const dcfImg = dcfCanvas.toDataURL('image/png');
                doc.addImage(dcfImg, 'PNG', 20, yPosition, 170, 80);
                yPosition += 90;
            }

            doc.addPage();
            yPosition = 20;

            doc.setFontSize(14);
            doc.setTextColor(56, 178, 172);
            doc.text('Key Financial Metrics', 20, yPosition);
            yPosition += 5;
            doc.line(20, yPosition, 190, yPosition);
            yPosition += 10;
            doc.setFontSize(12);
            doc.setTextColor(0, 0, 0);
            for (const [key, value] of Object.entries(valuationData.financials)) {
                doc.text(`${key}: ${value}`, 20, yPosition);
                yPosition += 6;
            }
            yPosition += 10;

            doc.setFontSize(14);
            doc.setTextColor(56, 178, 172);
            doc.text('Valuation Factors', 20, yPosition);
            yPosition += 5;
            doc.line(20, yPosition, 190, yPosition);
            yPosition += 10;
            doc.setFontSize(12);
            doc.setTextColor(0, 0, 0);
            for (const [key, value] of Object.entries(valuationData.factors)) {
                doc.text(`${key}: ${value}`, 20, yPosition);
                yPosition += 6;
            }
            yPosition += 10;

            doc.setFontSize(14);
            doc.setTextColor(56, 178, 172);
            doc.text('Contact Information', 20, yPosition);
            yPosition += 5;
            doc.line(20, yPosition, 190, yPosition);
            yPosition += 10;
            doc.setFontSize(12);
            doc.setTextColor(0, 0, 0);
            doc.text('Website: SaaSValuation.app (contact us via the site form)', 20, yPosition);
            yPosition += 10;

            doc.setFontSize(14);
            doc.setTextColor(56, 178, 172);
            doc.text('Disclaimer', 20, yPosition);
            yPosition += 5;
            doc.line(20, yPosition, 190, yPosition);
            yPosition += 10;
            doc.setFontSize(10);
            doc.setTextColor(0, 0, 0);
            const disclaimerText = 'This valuation report is for informational purposes only and does not constitute financial, legal, or investment advice. Calculations are based on user-provided data and industry standards, which may not reflect your company’s unique circumstances. SaaS Valuation App is not liable for decisions made using this report. Consult a qualified financial advisor before making business or investment decisions.';
            const disclaimerLines = doc.splitTextToSize(disclaimerText, 170);
            disclaimerLines.forEach(line => {
                doc.text(line, 20, yPosition);
                yPosition += 5;
            });

            const pageCount = doc.internal.getNumberOfPages();
            for (let i = 1; i <= pageCount; i++) {
                doc.setPage(i);
                doc.setFontSize(10);
                doc.setTextColor(128, 128, 128);
                doc.text(`Page ${i} of ${pageCount}`, 190, 287, { align: 'right' });
            }

            doc.save('SaaS_Valuation_Report.pdf');
        };

        // Save progress
        window.saveProgress = function() {
            const formData = {
                methods: Array.from(document.querySelectorAll('input[type="checkbox"]:checked')).map(cb => cb.value),
                ownerSalary: document.getElementById('ownerSalary').value,
                averageSalary: document.getElementById('averageSalary').value,
                employeeBenefits: document.getElementById('employeeBenefits').value,
                staffNumber: document.getElementById('staffNumber').value,
                expenses: document.getElementById('expenses').value,
                debt: document.getElementById('debt').value,
                growthRate: document.getElementById('growthRate').value,
                yearsOperating: document.getElementById('yearsOperating').value,
                scalability: document.getElementById('scalability').value,
                ltv: document.getElementById('ltv').value,
                cac: document.getElementById('cac').value,
                churnRate: document.getElementById('churnRate').value,
                customerGrowthRate: document.getElementById('customerGrowthRate').value,
                industry: document.getElementById('industry').value,
                marketTrendImpact: document.getElementById('marketTrendImpact').value,
                competitivePositioning: document.getElementById('competitivePositioning').value,
                marketVolatility: document.getElementById('marketVolatility').value,
                aiReplaceable: document.getElementById('aiReplaceable').value,
                aiReplaceCount: document.getElementById('aiReplaceCount').value,
                hasIP: document.getElementById('hasIP').value,
                ipValue: document.getElementById('ipValue').value,
                ipUnique: document.getElementById('ipUnique').value,
                operationalEfficiency: document.getElementById('operationalEfficiency').value,
                projectedRevenue: document.getElementById('projectedRevenue').value,
                expectedGrowthRate: document.getElementById('expectedGrowthRate').value,
                cashFlow1: document.getElementById('cashFlow1').value,
                cashFlow2: document.getElementById('cashFlow2').value,
                cashFlow3: document.getElementById('cashFlow3').value,
                cashFlow4: document.getElementById('cashFlow4').value,
                cashFlow5: document.getElementById('cashFlow5').value,
                discountRate: document.getElementById('discountRate').value,
                terminalGrowthRate: document.getElementById('terminalGrowthRate').value,
                assets: document.getElementById('assets').value,
                valuationEmail: valuationEmailInput ? valuationEmailInput.value : ''
            };
            localStorage.setItem('valuationFormData', JSON.stringify(formData));
            alert('Progress saved! You can return to this page to continue.');
        };

        // Load saved progress
        window.onload = function() {
            const savedData = localStorage.getItem('valuationFormData');
            if (savedData) {
                const formData = JSON.parse(savedData);
                document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = formData.methods.includes(cb.value));
                document.getElementById('ownerSalary').value = formData.ownerSalary || '';
                document.getElementById('averageSalary').value = formData.averageSalary || '';
                document.getElementById('employeeBenefits').value = formData.employeeBenefits || '';
                document.getElementById('staffNumber').value = formData.staffNumber || '';
                document.getElementById('expenses').value = formData.expenses || '';
                document.getElementById('debt').value = formData.debt || '';
                document.getElementById('growthRate').value = formData.growthRate || '';
                document.getElementById('yearsOperating').value = formData.yearsOperating || '';
                document.getElementById('scalability').value = formData.scalability || 5;
                document.getElementById('scalabilityValue').textContent = formData.scalability || 5;
                document.getElementById('ltv').value = formData.ltv || '';
                document.getElementById('cac').value = formData.cac || '';
                document.getElementById('churnRate').value = formData.churnRate || '';
                document.getElementById('customerGrowthRate').value = formData.customerGrowthRate || '';
                document.getElementById('industry').value = formData.industry || '';
                document.getElementById('marketTrendImpact').value = formData.marketTrendImpact || 5;
                document.getElementById('marketTrendImpactValue').textContent = formData.marketTrendImpact || 5;
                document.getElementById('competitivePositioning').value = formData.competitivePositioning || 5;
                document.getElementById('competitivePositioningValue').textContent = formData.competitivePositioning || 5;
                document.getElementById('marketVolatility').value = formData.marketVolatility || 5;
                document.getElementById('marketVolatilityValue').textContent = formData.marketVolatility || 5;
                document.getElementById('aiReplaceable').value = formData.aiReplaceable || '';
                document.getElementById('aiReplaceCount').value = formData.aiReplaceCount || '';
                document.getElementById('hasIP').value = formData.hasIP || '';
                document.getElementById('ipValue').value = formData.ipValue || '';
                document.getElementById('ipUnique').value = formData.ipUnique || '';
                document.getElementById('operationalEfficiency').value = formData.operationalEfficiency || 5;
                document.getElementById('operationalEfficiencyValue').textContent = formData.operationalEfficiency || 5;
                document.getElementById('projectedRevenue').value = formData.projectedRevenue || '';
                document.getElementById('expectedGrowthRate').value = formData.expectedGrowthRate || '';
                document.getElementById('cashFlow1').value = formData.cashFlow1 || '';
                document.getElementById('cashFlow2').value = formData.cashFlow2 || '';
                document.getElementById('cashFlow3').value = formData.cashFlow3 || '';
                document.getElementById('cashFlow4').value = formData.cashFlow4 || '';
                document.getElementById('cashFlow5').value = formData.cashFlow5 || '';
                document.getElementById('discountRate').value = formData.discountRate || '';
                document.getElementById('terminalGrowthRate').value = formData.terminalGrowthRate || '';
                document.getElementById('assets').value = formData.assets || '';
                if (valuationEmailInput) {
                    valuationEmailInput.value = formData.valuationEmail || '';
                }

                const dcfSelected = formData.methods.includes('dcf');
                const earningsSelected = formData.methods.includes('earnings');
                document.getElementById('dcfFields').classList.toggle('hidden', !dcfSelected);
                document.getElementById('earningsFields').classList.toggle('hidden', !earningsSelected);
                document.getElementById('dcfChartContainer').classList.toggle('hidden', !dcfSelected);
                toggleAIReplacement();
                toggleIPFields();
            }
        };

        // Start over
        document.getElementById('start-over').addEventListener('click', () => {
            localStorage.removeItem('valuationFormData');
            location.reload();
        });
    </script>
    </main>
    <script src="scripts/analytics.js"></script>
    <script src="scripts/seo-helpers.js"></script>
    <script src="scripts/layout.js"></script>
    <footer class="site-footer bg-gray-900 text-white py-12" role="contentinfo">
      <div class="container mx-auto px-6 space-y-10">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-10 items-start">
          <div class="space-y-4">
            <div class="flex items-center space-x-3">
              <img src="favicon-96x96.png" alt="SaaS Valuation App logo" class="h-10 w-10 rounded" loading="lazy">
              <div>
                <p class="text-lg font-bold">SaaS Valuation App</p>
                <p class="text-gray-300 text-sm">Investor-ready valuations and growth tools for founders.</p>
              </div>
            </div>
            <div class="text-sm text-gray-400 space-y-2" aria-label="Business information">
              <p class="font-semibold text-gray-200">Registered business:</p>
              <p>Amanda Valuation LLC — Delaware, USA</p>
              <p>Registered agent mailing: 651 N Broad St, Suite 206, Middletown, DE 19709</p>
              <p>Mailing address: 2261 Market Street #4178, San Francisco, CA 94114</p>
            </div>
          </div>
          <div class="grid grid-cols-2 gap-6" aria-label="Site links">
            <div>
              <h3 class="text-lg font-semibold mb-3">Product</h3>
              <ul class="space-y-2 text-gray-300">
                <li><a href="index.html#valuation" class="hover:text-teal-300">Valuation Tool</a></li>
                <li><a href="payment.html" class="hover:text-teal-300">Pro Valuation</a></li>
                <li><a href="saas-growth-calculator.html" class="hover:text-teal-300">Growth Calculator</a></li>
                <li><a href="index.html#pricing" class="hover:text-teal-300">Pricing</a></li>
              </ul>
            </div>
            <div>
              <h3 class="text-lg font-semibold mb-3">Resources</h3>
              <ul class="space-y-2 text-gray-300">
                <li><a href="resources.html" class="hover:text-teal-300">Resources Hub</a></li>
                <li><a href="blog.html" class="hover:text-teal-300">Blog</a></li>
                <li><a href="valuation-guide.html" class="hover:text-teal-300">Valuation Guide</a></li>
                <li><a href="Support.html#contact-support" class="hover:text-teal-300">Contact &amp; Support</a></li>
              </ul>
            </div>
          </div>
          <div class="space-y-4" aria-label="Contact information">
            <h3 class="text-lg font-semibold">Contact &amp; Support</h3>
            <p class="text-gray-300">Email: <a class="text-teal-300 hover:text-teal-200" href="mailto:support@saasvaluation.app">support@saasvaluation.app</a></p>
            <p class="text-gray-300">Support hours: Monday–Friday, 9:00 AM–5:00 PM PT</p>
            <p class="text-gray-300">For filings or legal notices, use the registered address above.</p>
            <div class="flex flex-col sm:flex-row gap-3">
              <a href="Support.html" class="inline-flex items-center justify-center px-4 py-2 rounded-lg bg-white text-gray-900 font-semibold hover:bg-teal-100" aria-label="Go to the support page">Support Center</a>
              <a href="Support.html#contact-support" class="inline-flex items-center justify-center px-4 py-2 rounded-lg bg-teal-500 text-white font-semibold hover:bg-teal-600" aria-label="Jump to the contact form">Contact Us</a>
            </div>
          </div>
        </div>
        <div class="border-t border-gray-800 pt-6 flex flex-col md:flex-row md:items-center md:justify-between gap-4">
          <p class="text-gray-400 text-sm">© 2025 SaaS Valuation App. All rights reserved.</p>
          <div class="flex gap-4 text-sm text-gray-300">
            <a class="hover:text-teal-300" href="privacy-policy.html">Privacy Policy</a>
            <a class="hover:text-teal-300" href="terms-and-conditions.html">Terms &amp; Conditions</a>
          </div>
        </div>
      </div>
    </footer>
</body>
</html>
