<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SaaS Pro Valuation – Comprehensive Business Evaluation</title>

  <!-- Tailwind + icons -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"/>

  <!-- Charts & jsPDF -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <style>
    .gradient-bg{background:linear-gradient(135deg,#38b2ac 0%,#2d3748 100%)}
    .btn-primary{@apply bg-teal-500 text-white font-bold py-2 px-4 rounded-lg}
    .btn-secondary{@apply bg-yellow-500 text-white font-bold py-2 px-4 rounded-lg}
    .valuation-box{max-width:900px;margin:0 auto;background:#f9fafb;border:2px solid #d1d5db;border-radius:1rem;padding:1rem}
    .step-hidden{display:none}.step-visible{display:block}
  </style>
</head>
<body class="antialiased">

<!-- ===== HEADER ===== -->
<header class="bg-gray-800 text-white py-3 sticky top-0 z-50 shadow-lg">
  <div class="container mx-auto px-4 flex justify-between items-center">
    <a href="#" class="text-xl font-bold flex items-center">
      <i class="fas fa-chart-line mr-2 text-teal-400"></i>SaaS<span class="text-teal-400">Val</span>
    </a>
    <button id="menu-toggle" class="md:hidden focus:outline-none" aria-label="Toggle Menu">
      <i class="fas fa-bars text-xl"></i>
    </button>
  </div>
  <nav id="mobile-menu" class="md:hidden hidden px-4 pb-4 bg-gray-700"></nav>
</header>

<!-- ===== HERO ===== -->
<section class="gradient-bg text-white py-20 text-center">
  <h1 class="text-5xl font-bold mb-6">Professional SaaS Valuation</h1>
  <p class="text-xl mb-8">Get an accurate, data-driven valuation in minutes.</p>
  <a href="#pro-valuation" class="btn-primary">Start Valuation</a>
</section>

<!-- ===== PRO VALUATION WIZARD ===== -->
<section id="pro-valuation" class="py-12 bg-gray-50">
  <div class="container mx-auto px-4 max-w-3xl">
    <h2 class="text-2xl font-bold mb-4 text-center">Valuation Wizard</h2>

    <!-- progress -->
    <div class="mb-6">
      <div class="h-2 bg-gray-200 rounded">
        <div id="progress-fill" class="h-2 bg-teal-500" style="width:14%"></div>
      </div>
      <p class="text-center text-sm text-gray-600">Step <span id="current-step">1</span> / 7</p>
    </div>

    <div class="valuation-box">

      <!-- STEP 1 – methods -->
      <div id="step-1" class="step step-visible" data-step="1">
        <h3 class="font-semibold mb-2">Select Valuation Methods (max 3)</h3>
        <label class="block"><input type="checkbox" value="multiplier" class="mr-2">Revenue Multiplier</label>
        <label class="block"><input type="checkbox" value="income"      class="mr-2">Income-Based</label>
        <label class="block"><input type="checkbox" value="earnings"    class="mr-2">Earnings-Based</label>
        <label class="block"><input type="checkbox" value="dcf"         class="mr-2">DCF</label>
        <p id="method-error" class="text-red-500 text-sm hidden">Select 1-3 methods.</p>
        <button id="next-btn-1" class="btn-primary mt-4 float-right">Next</button>
      </div>

      <!-- STEP 2 – financials -->
      <div id="step-2" class="step step-hidden" data-step="2">
        <h3 class="font-semibold mb-2">Financial Metrics</h3>
        <input id="arr" type="number" placeholder="ARR $" class="w-full mb-2 p-2 border rounded">
        <input id="mrr" type="number" placeholder="MRR $" class="w-full mb-2 p-2 border rounded">
        <input id="net-profit" type="number" placeholder="Net Profit $" class="w-full mb-2 p-2 border rounded">
        <input id="ltv" type="number" placeholder="LTV $" class="w-full mb-2 p-2 border rounded">
        <input id="cac" type="number" placeholder="CAC $" class="w-full mb-2 p-2 border rounded">
        <button id="prev-btn-2" class="btn-secondary mt-2">Prev</button>
        <button id="next-btn-2" class="btn-primary float-right mt-2">Next</button>
      </div>

      <!-- STEP 3 – growth/churn -->
      <div id="step-3" class="step step-hidden" data-step="3">
        <h3 class="font-semibold mb-2">Growth &amp; Churn</h3>
        <input id="revenue-growth-yoy" type="number" placeholder="YoY Growth %" class="w-full mb-2 p-2 border rounded">
        <input id="customer-churn" type="number" placeholder="Customer Churn %" class="w-full mb-2 p-2 border rounded">
        <input id="retention-rate" type="number" placeholder="Retention Rate %" class="w-full mb-2 p-2 border rounded">
        <input id="nps" type="number" placeholder="NPS" class="w-full mb-2 p-2 border rounded">
        <button id="prev-btn-3" class="btn-secondary mt-2">Prev</button>
        <button id="next-btn-3" class="btn-primary float-right mt-2">Next</button>
      </div>
      <!-- STEP 4 – customers -->
      <div id="step-4" class="step step-hidden" data-step="4">
        <h3 class="font-semibold mb-2">Customer Metrics</h3>
        <input id="active-customers" type="number" placeholder="Active Customers" class="w-full mb-2 p-2 border rounded">
        <input id="monthly-active-users" type="number" placeholder="MAU" class="w-full mb-2 p-2 border rounded">
        <button id="prev-btn-4" class="btn-secondary mt-2">Prev</button>
        <button id="next-btn-4" class="btn-primary float-right mt-2">Next</button>
      </div>

      <!-- STEP 5 – product/tech -->
      <div id="step-5" class="step step-hidden" data-step="5">
        <h3 class="font-semibold mb-2">Product &amp; Tech</h3>
        <select id="ip-ownership" class="w-full mb-2 p-2 border rounded">
          <option value="" disabled selected>IP Ownership</option>
          <option value="fully-owned">Fully Owned</option>
          <option value="partial">Partial</option>
          <option value="third-party">Third-Party</option>
        </select>
        <button id="prev-btn-5" class="btn-secondary mt-2">Prev</button>
        <button id="next-btn-5" class="btn-primary float-right mt-2">Next</button>
      </div>

      <!-- STEP 6 – team -->
      <div id="step-6" class="step step-hidden" data-step="6">
        <h3 class="font-semibold mb-2">Team &amp; Ops</h3>
        <input id="fte" type="number" placeholder="Full-time Employees" class="w-full mb-2 p-2 border rounded">
        <button id="prev-btn-6" class="btn-secondary mt-2">Prev</button>
        <button id="next-btn-6" class="btn-primary float-right mt-2">Next</button>
      </div>

      <!-- STEP 7 – legal/risk -->
      <div id="step-7" class="step step-hidden" data-step="7">
        <h3 class="font-semibold mb-2">Legal &amp; Risk</h3>
        <select id="legal-issues" class="w-full mb-2 p-2 border rounded">
          <option value="" disabled selected>Pending Legal Issues</option>
          <option value="none">None</option><option value="minor">Minor</option><option value="major">Major</option>
        </select>
        <input id="debt-level" type="number" placeholder="Debt $" class="w-full mb-2 p-2 border rounded">
        <button id="prev-btn-7" class="btn-secondary mt-2">Prev</button>
        <button id="next-btn-7" class="btn-primary float-right mt-2">View Results</button>
      </div>
      <!-- RESULTS -->
      <div id="results" class="step step-hidden" data-step="8">
        <h3 class="font-semibold mb-4">Valuation Results</h3>
        <p id="valuation-amount" class="text-3xl font-bold text-teal-600">$0</p>
        <p class="text-gray-600">Range: <span id="valuation-range">$0–$0</span></p>
        <p class="text-gray-600 mb-4">Confidence: <span id="confidence-score">0%</span></p>

        <canvas id="valuation-chart" class="mb-6"></canvas>
        <button id="download-report" class="btn-primary">Download PDF</button>
      </div>
    </div><!-- /.valuation-box -->
  </div>
</section>

<!-- tiny footer -->
<footer class="bg-gray-800 text-gray-400 text-center text-sm py-4">
  © 2025 SaaSVal
</footer>
<!-- ===== NON-MODULE: menu + wizard nav + validation ===== -->
<script>
  /* mobile menu */
  document.getElementById('menu-toggle').onclick = () =>
    document.getElementById('mobile-menu').classList.toggle('hidden');

  /* wizard helpers */
  const $ = id => document.getElementById(id);
  const steps = document.querySelectorAll('.step');
  let cur = 1;
  const show = n => {
    steps.forEach(s=>s.classList.toggle('step-visible',s.dataset.step==n));
    cur=n; $('current-step').textContent=n;
    $('progress-fill').style.width = (n/7*100)+'%';
  };

  /* very light validation (only step-1 needs checks here) */
  const valid1 = () => {
    const c = document.querySelectorAll('#step-1 input:checked').length;
    $('method-error').classList.toggle('hidden',c>0&&c<=3);
    return c>0&&c<=3;
  };

  $('next-btn-1').onclick = () => { if(valid1()) show(2); };
  $('prev-btn-2').onclick = () => show(1);
  $('next-btn-2').onclick = () => show(3);
  $('prev-btn-3').onclick = () => show(2);
  $('next-btn-3').onclick = () => show(4);
  $('prev-btn-4').onclick = () => show(3);
  $('next-btn-4').onclick = () => show(5);
  $('prev-btn-5').onclick = () => show(4);
  $('next-btn-5').onclick = () => show(6);
  $('prev-btn-6').onclick = () => show(5);
  $('next-btn-6').onclick = () => show(7);
  $('prev-btn-7').onclick = () => show(6);
  $('next-btn-7').onclick = () => { show(8); renderResults(); };

  /* utility */
  const num = (id,d=0)=>{const v=parseFloat($(id).value); return isNaN(v)?d:v; };
</script>

<!-- ===== MODULE: valuation logic & rendering ===== -->
<script type="module">
  import { calculateValuation } from './valuationEngine.js';
  const $ = id => document.getElementById(id);
  const num = (id,d=0)=>{const v=parseFloat($(id).value); return isNaN(v)?d:v; };

  function gather(){
    return{
      methods:Array.from(document.querySelectorAll('input[type=checkbox]:checked')).map(c=>c.value),
      arr:num('arr'), mrr:num('mrr'), netProfit:num('net-profit'),
      ltv:num('ltv'), cac:num('cac'),
      growthYoy:num('revenue-growth-yoy'), customerChurn:num('customer-churn'),
      retentionRate:num('retention-rate'), nps:num('nps'),
      activeCustomers:num('active-customers'), mau:num('monthly-active-users'),
      legalIssues:$('legal-issues').value||'none',
      ipOwnership:$('ip-ownership').value||'fully-owned',
      debtLevel:num('debt-level')
    };
  }

  let chart;
  window.renderResults = () => {
    const raw  = gather();
    const res  = calculateValuation(raw);

    /* numbers */
    $('valuation-amount').textContent =
      `$${Math.round(res.avg).toLocaleString()}`;
    $('valuation-range').textContent =
      `$${Math.round(res.rangeLow).toLocaleString()}–$${Math.round(res.rangeHigh).toLocaleString()}`;
    $('confidence-score').textContent = `${Math.round(res.confidence)}%`;

    /* chart */
    chart && chart.destroy();
    chart = new Chart($('valuation-chart'),{
      type:'bar',
      data:{labels:res.valuations.map(v=>v.method),
            datasets:[{label:'Valuation ($)',
                       data:res.valuations.map(v=>v.value),
                       backgroundColor:'rgba(56,178,172,.6)'}]},
      options:{scales:{y:{beginAtZero:true}}}
    });

    /* PDF download */
    $('download-report').onclick = () => {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      doc.text(`Valuation: $${Math.round(res.avg).toLocaleString()}`, 15, 20);
      doc.text(`Range   : $${Math.round(res.rangeLow).toLocaleString()} – $${Math.round(res.rangeHigh).toLocaleString()}`, 15, 30);
      doc.save('saas_valuation_report.pdf');
    };
  };

  /* start wizard on step 1 */
  show(1);
</script>
</body>
</html>
// valuationEngine.js  – pure math, no DOM

export function calculateValuation(i){
  let m=5;
  if(i.growthYoy>20)        m+=2;
  if(i.customerChurn<5)     m+=1;
  if(i.retentionRate>80)    m+=1;
  if(i.nps>50)              m+=0.5;
  if(i.legalIssues!=='none')m-=1;
  if(i.ipOwnership==='fully-owned') m+=0.5;

  const vals=[];
  if(i.methods.includes('multiplier'))
    vals.push({method:'Revenue Multiplier',value:i.arr*m});
  if(i.methods.includes('income'))
    vals.push({method:'Income-Based',value:i.netProfit*(m-1)});
  if(i.methods.includes('earnings'))
    vals.push({method:'Earnings-Based',
               value:(i.arr*0.6+i.netProfit*0.4)*m});
  if(i.methods.includes('dcf'))
    vals.push({method:'DCF',value:(i.netProfit*1.2)/0.10});

  const avg = vals.reduce((s,v)=>s+v.value,0)/vals.length;
  return {
    valuations:vals,
    avg,
    rangeLow:avg*0.9,
    rangeHigh:avg*1.1,
    confidence:Math.min(95,
      60+i.methods.length*10+
      (i.growthYoy>20?10:0)+
      (i.customerChurn<5?10:0))
  };
}
export default calculateValuation;
