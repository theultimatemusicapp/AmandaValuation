<!-- STEP 1/15 START: HTML Head, CSS Styles, and Opening Body -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SaaS Pro Valuation - Comprehensive Business Evaluation</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>
  <style>
    .gradient-bg {
      background: linear-gradient(135deg, #38b2ac 0%, #2d3748 100%);
    }
    .btn-primary {
      @apply bg-teal-500 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-300;
    }
    .btn-primary:hover {
      @apply bg-teal-600;
    }
    .btn-secondary {
      @apply bg-yellow-500 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-300;
    }
    .btn-secondary:hover {
      @apply bg-yellow-600;
    }
    .valuation-box {
      max-width: 900px;
      margin: 0 auto;
      background-color: #f9fafb;
      border: 2px solid #d1d5db;
      border-radius: 1rem;
      padding: 1rem;
      box-shadow: 0 4px 10px rgb(0 0 0 / 0.05);
    }
    input:focus, select:focus {
      outline: 2px solid #38b2ac;
      outline-offset: 2px;
    }
    .step-hidden { display: none; }
    .step-visible { display: block; }
    [data-tooltip]:hover:after {
      content: attr(data-tooltip);
      position: absolute;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%);
      background-color: #2D3748;
      color: white;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      white-space: nowrap;
      z-index: 10;
    }
    .feature-card {
      @apply bg-white p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow duration-300;
    }
    .feature-icon {
      @apply text-teal-500 text-3xl mb-4;
    }
    .nav-link {
      @apply hover:text-teal-400 transition-colors duration-300;
    }
    .mobile-nav-link {
      @apply block py-2 hover:text-teal-400 transition-colors duration-300;
    }
    .explanation-section {
      margin-top: 1.5rem;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
    }
    .explanation-box {
      background: #e5e7eb;
      border: 1px solid #d1d5db;
      border-radius: 0.5rem;
      padding: 0.75rem;
      font-size: 0.85rem;
      color: #374151;
    }
    .explanation-box h4 {
      font-weight: bold;
      margin-bottom: 0.25rem;
      font-size: 0.9rem;
    }
    .explanation-box p {
      margin-bottom: 0.25rem;
      line-height: 1.2;
    }
    @media (max-width: 768px) {
      .explanation-section {
        grid-template-columns: 1fr;
      }
    }
    /* Chart canvas styles for PDF export */
    .chart-canvas {
      display: none;
    }
  </style>
</head>
<body>
<!-- STEP 1/15 END: Paste this at the top of your Dreamweaver file -->
  <!-- STEP 2/15 START: Header and Hero Section -->
  <!-- HEADER -->
  <header class="bg-gray-800 text-white py-3 sticky top-0 z-50 shadow-lg">
    <div class="container mx-auto px-4 flex justify-between items-center">
      <div class="flex items-center">
        <i class="fas fa-chart-line text-teal-400 mr-2 text-xl"></i>
        <a href="index.html" class="text-xl font-bold" aria-label="SaaS Valuation App Home">
          SaaS<span class="text-teal-400">Val</span>
        </a>
      </div>
      <nav class="hidden md:flex space-x-6" aria-label="Main navigation">
        <a href="index.html" class="nav-link">Free Valuation</a>
        <a href="#features" class="nav-link">Features</a>
        <a href="#how-it-works" class="nav-link">How It Works</a>
        <a href="blog.html" class="nav-link">Resources</a>
      </nav>
      <button id="menu-toggle" class="md:hidden focus:outline-none" aria-label="Toggle Menu">
        <i class="fas fa-bars text-xl"></i>
      </button>
    </div>
    <div id="mobile-menu" class="md:hidden hidden px-4 pb-4 bg-gray-700" aria-label="Mobile navigation">
      <nav class="flex flex-col space-y-2 mt-3">
        <a href="#valuation" class="mobile-nav-link">Valuation</a>
        <a href="#features" class="mobile-nav-link">Features</a>
        <a href="#how-it-works" class="mobile-nav-link">How It Works</a>
        <a href="blog.html" class="mobile-nav-link">Resources</a>
      </nav>
    </div>
  </header>

  <!-- HERO SECTION -->
  <section class="gradient-bg text-white py-20">
    <div class="container mx-auto px-4 text-center max-w-4xl">
      <h1 class="text-4xl md:text-5xl font-bold mb-6 leading-tight">
        Professional SaaS Business Valuation <br>
        <span class="text-teal-300">Powered by Real Metrics</span>
      </h1>
      <p class="text-xl md:text-2xl opacity-90 mb-8 max-w-3xl mx-auto">
        Get an accurate, data-driven valuation of your SaaS business with our comprehensive evaluation tool.
      </p>
      <div class="flex flex-col sm:flex-row justify-center gap-4">
        <a href="#valuation" class="btn-primary px-8 py-3 text-lg">
          <i class="fas fa-calculator mr-2"></i> Start Valuation
        </a>
        <a href="#how-it-works" class="bg-white text-gray-800 font-bold py-3 px-8 rounded-lg transition-colors duration-300 hover:bg-gray-100 text-lg">
          <i class="fas fa-play-circle mr-2"></i> How It Works
        </a>
      </div>
    </div>
  </section>
<!-- STEP 2/15 END: Paste this after the <body> tag from Step 1 -->
  <!-- STEP 3/15 START: Features and How-It-Works Sections -->
  <!-- FEATURES SECTION -->
  <section id="features" class="py-16 bg-white">
    <div class="container mx-auto px-4">
      <div class="text-center mb-12">
        <h2 class="text-3xl font-bold text-gray-800 mb-4">Why Choose Our Valuation Tool</h2>
        <p class="text-lg text-gray-600 max-w-2xl mx-auto">
          Our platform combines industry expertise with advanced analytics to deliver the most accurate SaaS valuation.
        </p>
      </div>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
        <div class="feature-card">
          <div class="feature-icon">
            <i class="fas fa-chart-pie"></i>
          </div>
          <h3 class="text-xl font-bold text-gray-800 mb-3">Multiple Valuation Methods</h3>
          <p class="text-gray-600">
            We use revenue multipliers, income-based, earnings-based, and DCF methods to provide a comprehensive valuation range.
          </p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">
            <i class="fas fa-database"></i>
          </div>
          <h3 class="text-xl font-bold text-gray-800 mb-3">Data-Driven Insights</h3>
          <p class="text-gray-600">
            Our algorithms analyze 50+ metrics from your business to calculate the most accurate valuation possible.
          </p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">
            <i class="fas fa-file-pdf"></i>
          </div>
          <h3 class="text-xl font-bold text-gray-800 mb-3">Professional Reports</h3>
          <p class="text-gray-600">
            Download detailed PDF reports perfect for investors, buyers, or internal planning.
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- HOW IT WORKS SECTION -->
  <section id="how-it-works" class="py-16 bg-gray-50">
    <div class="container mx-auto px-4">
      <div class="text-center mb-12">
        <h2 class="text-3xl font-bold text-gray-800 mb-4">How Our Valuation Works</h2>
        <p class="text-lg text-gray-600 max-w-2xl mx-auto">
          Our 8-step process evaluates every aspect of your SaaS business to deliver an accurate valuation.
        </p>
      </div>
      <div class="max-w-4xl mx-auto">
        <ol class="list-decimal pl-6 text-gray-700 space-y-2 text-base">
          <li><b>Select SaaS Type:</b> Choose the category that best describes your SaaS business.</li>
          <li><b>Enter Company Info and Valuation Methods:</b> Provide company name, website, email, and select up to 3 valuation methods.</li>
          <li><b>Enter Financial Metrics:</b> Provide key financial data including ARR, MRR, LTV, CAC, gross margin, net profit, burn rate, and runway.</li>
          <li><b>Growth & Churn Rates:</b> Input your revenue growth rates (YoY and MoM) along with customer and revenue churn rates.</li>
          <li><b>Customer & Market Metrics:</b> Detail your customer base, retention, NPS, segment, and buyer type.</li>
          <li><b>Product & Technology:</b> Assess product-market fit, proprietary tech, code quality, scalability, release frequency, and security compliance.</li>
          <li><b>Team & Operations:</b> Provide details about team size, key staff, turnover, eng/sales ratio, support, and headcount growth.</li>
          <li><b>Legal, Contracts & Risk:</b> Finalize with legal entity, IP, contracts, vendor lock-in, legal issues, privacy, insurance, and debt.</li>
        </ol>
      </div>
    </div>
  </section>
<!-- STEP 3/15 END: Paste this after the hero section from Step 2 -->
  <!-- STEP 4/15 START: Pro Valuation Form (Step 0: SaaS Type, Step 1: Company Info + Valuation Methods) -->
  <!-- PRO VALUATION FORM -->
  <section id="pro-valuation" class="py-12 bg-gray-50">
    <div class="container mx-auto px-4 max-w-3xl">
      <div class="text-center mb-8">
        <h2 class="text-2xl font-bold text-gray-800 mb-2">Pro Valuation Tool</h2>
        <p class="text-base text-gray-600 max-w-xl mx-auto">
          Answer questions step-by-step to get a detailed valuation report with actionable insights.
        </p>
      </div>

      <!-- Progress Bar -->
      <div class="mb-6">
        <div class="relative pt-1">
          <div class="overflow-hidden h-1.5 mb-2 text-xs flex rounded bg-gray-200">
            <div id="progress-fill" class="shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-teal-500" style="width: 12.5%"></div>
          </div>
          <p class="text-center text-gray-600 text-sm">
            Step <span id="current-step">1</span> of 8
          </p>
        </div>
      </div>

      <div class="valuation-box">
        <!-- Step 0: SaaS Type Selection -->
        <div id="step-0" class="step step-visible" data-step="0">
          <h3 class="text-lg font-semibold text-gray-800 mb-4">Step 0: Select Your SaaS Business Type</h3>
          <p class="text-gray-600 mb-4 text-sm">
            Choose the category that best describes your SaaS business. This helps us apply the most accurate valuation multipliers.
          </p>
          <div>
            <label for="saas-type" class="block font-medium text-gray-700 mb-1">SaaS Business Type</label>
            <select id="saas-type" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="saas-type-error">
              <option value="" disabled selected>Select SaaS Type</option>
              <option value="crm">CRM / Sales</option>
              <option value="marketing">Marketing Automation</option>
              <option value="analytics">Analytics / BI</option>
              <option value="erp">ERP / Operations</option>
              <option value="finance">Finance / Accounting</option>
              <option value="hr">HR / Payroll</option>
              <option value="project">Project Management</option>
              <option value="collaboration">Collaboration / Communication</option>
              <option value="devtools">Developer Tools</option>
              <option value="security">Security / Compliance</option>
              <option value="ecommerce">E-commerce / Retail</option>
              <option value="education">Education / LMS</option>
              <option value="healthcare">Healthcare / MedTech</option>
              <option value="realestate">Real Estate Tech</option>
              <option value="vertical">Vertical SaaS (Industry-specific)</option>
              <option value="productivity">Productivity</option>
              <option value="support">Customer Support / Helpdesk</option>
              <option value="media">Media / Content</option>
              <option value="iot">IoT / Hardware SaaS</option>
              <option value="other">Other</option>
            </select>
            <p id="saas-type-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please select a SaaS type.</p>
          </div>
          <div class="mt-4 flex justify-end">
            <button id="next-btn-0" class="btn-primary" aria-label="Proceed to next step">Next</button>
          </div>
        </div>

        <!-- Step 1: Company Info & Valuation Methods -->
        <div id="step-1" class="step step-hidden" data-step="1">
          <h3 class="text-lg font-semibold text-gray-800 mb-4">Step 1: Company Information & Valuation Methods</h3>
          <p class="text-gray-600 mb-4 text-sm">
            Provide your company details and choose up to 3 valuation methods.
            <span data-tooltip="Company info will appear in the report." class="text-teal-500 underline cursor-pointer">Learn more</span>
          </p>
          <div class="space-y-3">
            <div>
              <label for="company-name" class="block font-medium text-gray-700 mb-1">Company Name</label>
              <input type="text" id="company-name" placeholder="e.g., Acme Inc." class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="company-name-error" />
              <p id="company-name-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a valid company name.</p>
            </div>
            <div>
              <label for="company-website" class="block font-medium text-gray-700 mb-1">Company Website</label>
              <input type="url" id="company-website" placeholder="e.g., https://www.acme.com" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="company-website-error" />
              <p id="company-website-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a valid URL (e.g., https://www.example.com).</p>
            </div>
            <div>
              <label for="company-email" class="block font-medium text-gray-700 mb-1">Company Email</label>
              <input type="email" id="company-email" placeholder="e.g., contact@acme.com" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="company-email-error" />
              <p id="company-email-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a valid email address.</p>
            </div>
            <div>
              <label class="block font-medium text-gray-700 mb-1">Valuation Methods</label>
              <label class="flex items-center">
                <input type="checkbox" id="method-multiplier" value="multiplier" class="form-checkbox h-5 w-5 text-teal-500" aria-label="Revenue Multiplier" />
                <span class="ml-2">Revenue Multiplier</span>
              </label>
              <label class="flex items-center">
                <input type="checkbox" id="method-income" value="income" class="form-checkbox h-5 w-5 text-teal-500" aria-label="Income-Based" />
                <span class="ml-2">Income-Based</span>
              </label>
              <label class="flex items-center">
                <input type="checkbox" id="method-earnings" value="earnings" class="form-checkbox h-5 w-5 text-teal-500" aria-label="Earnings-Based" />
                <span class="ml-2">Earnings-Based</span>
              </label>
              <label class="flex items-center">
                <input type="checkbox" id="method-dcf" value="dcf" class="form-checkbox h-5 w-5 text-teal-500" aria-label="Discounted Cash Flow (DCF)" />
                <span class="ml-2">Discounted Cash Flow (DCF)</span>
              </label>
              <p id="method-error" class="text-red-500 text-sm mt-2 hidden" role="alert">
                Please select 1 to 3 valuation methods.
              </p>
            </div>
          </div>
          <div class="explanation-section">
            <div class="explanation-box">
              <h4>Revenue Multiplier</h4>
              <p><strong>What:</strong> Multiplies your annual revenue (ARR) by a factor (e.g., 5-8).</p>
              <p><strong>Why:</strong> Ideal for stable SaaS revenue, showing investor value.</p>
              <p><strong>Scenario:</strong> $1M ARR with a 6x multiplier = $6M valuation.</p>
              <p><strong>Source:</strong> ARR from Stripe; multipliers from industry reports.</p>
            </div>
            <div class="explanation-box">
              <h4>Income-Based</h4>
              <p><strong>What:</strong> Multiplies net profit by a factor (e.g., 4-7).</p>
              <p><strong>Why:</strong> Highlights profitability for cash-generating businesses.</p>
              <p><strong>Scenario:</strong> $200K profit with a 5x multiplier = $1M valuation.</p>
              <p><strong>Source:</strong> Net profit from QuickBooks; multipliers from advisors.</p>
            </div>
            <div class="explanation-box">
              <h4>Earnings-Based</h4>
              <p><strong>What:</strong> Combines ARR and profit, adjusted for growth.</p>
              <p><strong>Why:</strong> Balances revenue and profit for growing SaaS.</p>
              <p><strong>Scenario:</strong> $1M ARR, $200K profit = $1.5M valuation.</p>
              <p><strong>Source:</strong> ARR/profit from reports; retention from CRM.</p>
            </div>
            <div class="explanation-box">
              <h4>Discounted Cash Flow (DCF)</h4>
              <p><strong>What:</strong> Discounts future cash flows to present value.</p>
              <p><strong>Why:</strong> Best for long-term growth potential.</p>
              <p><strong>Scenario:</strong> $1M ARR, 20% growth = $3M valuation.</p>
              <p><strong>Source:</strong> Projections from LivePlan; discount rates from analysts.</p>
            </div>
          </div>
          <div class="mt-4 flex justify-end">
            <button id="next-btn-1" class="btn-primary" aria-label="Proceed to next step">Next</button>
          </div>
        </div>
<!-- STEP 4/15 END: Paste this after the how-it-works section from Step 3 -->
        <!-- STEP 5/15 START: Pro Valuation Form (Step 2: Financial Metrics) -->
        <!-- Step 2: Financial Metrics -->
        <div id="step-2" class="step step-hidden" data-step="2">
          <h3 class="text-lg font-semibold text-gray-800 mb-4">Step 2: Financial Metrics</h3>
          <p class="text-gray-600 mb-4 text-sm">
            Enter key financial figures for your business.
            <span data-tooltip="Use latest financial statements." class="text-teal-500 underline cursor-pointer">Learn more</span>
          </p>
          <div class="space-y-3">
            <div>
              <label for="arr" class="block font-medium text-gray-700 mb-1">Annual Recurring Revenue (ARR) ($)</label>
              <input type="number" id="arr" min="0" step="1000" placeholder="e.g., 500000" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="arr-error" />
              <p id="arr-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a valid number.</p>
            </div>
            <div>
              <label for="mrr" class="block font-medium text-gray-700 mb-1">Monthly Recurring Revenue (MRR) ($)</label>
              <input type="number" id="mrr" min="0" step="100" placeholder="e.g., 41667" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="mrr-error" />
              <p id="mrr-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a valid number.</p>
            </div>
            <div>
              <label for="ltv" class="block font-medium text-gray-700 mb-1">Customer Lifetime Value (LTV) ($)</label>
              <input type="number" id="ltv" min="0" step="100" placeholder="e.g., 2000" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="ltv-error" />
              <p id="ltv-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a valid number.</p>
            </div>
            <div>
              <label for="cac" class="block font-medium text-gray-700 mb-1">Customer Acquisition Cost (CAC) ($)</label>
              <input type="number" id="cac" min="0" step="10" placeholder="e.g., 500" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="cac-error" />
              <p id="cac-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a valid number.</p>
            </div>
            <div>
              <label for="gross-margin" class="block font-medium text-gray-700 mb-1">Gross Margin (%)</label>
              <input type="number" id="gross-margin" min="0" max="100" step="0.1" placeholder="e.g., 75" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="gross-margin-error" />
              <p id="gross-margin-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a value between 0 and 100.</p>
            </div>
            <div>
              <label for="net-profit" class="block font-medium text-gray-700 mb-1">Net Profit / EBITDA ($)</label>
              <input type="number" id="net-profit" min="0" step="1000" placeholder="e.g., 200000" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="net-profit-error" />
              <p id="net-profit-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a valid number.</p>
            </div>
            <div>
              <label for="burn-rate" class="block font-medium text-gray-700 mb-1">Monthly Burn Rate ($)</label>
              <input type="number" id="burn-rate" min="0" step="1000" placeholder="e.g., 25000" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="burn-rate-error" />
              <p id="burn-rate-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a valid number.</p>
            </div>
            <div>
              <label for="runway" class="block font-medium text-gray-700 mb-1">Runway (Months)</label>
              <input type="number" id="runway" min="0" step="1" placeholder="e.g., 12" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="runway-error" />
              <p id="runway-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a valid number.</p>
            </div>
            <p id="financial-error" class="text-red-500 text-sm mt-2 hidden" role="alert">Please fill all financial fields correctly.</p>
            <div class="mt-4 flex justify-between">
              <button id="prev-btn-2" class="btn-secondary" aria-label="Return to previous step">Previous</button>
              <button id="next-btn-2" class="btn-primary" aria-label="Proceed to next step">Next</button>
            </div>
          </div>
          <div class="explanation-section">
            <div class="explanation-box">
              <h4>Annual Recurring Revenue (ARR)</h4>
              <p><strong>What:</strong> Yearly subscription revenue.</p>
              <p><strong>Why:</strong> Shows revenue stability, key for valuation.</p>
              <p><strong>Scenario:</strong> 1,000 customers at $100/month = $1.2M ARR.</p>
              <p><strong>Source:</strong> Billing systems (e.g., Stripe).</p>
            </div>
            <div class="explanation-box">
              <h4>Monthly Recurring Revenue (MRR)</h4>
              <p><strong>What:</strong> Monthly subscription revenue.</p>
              <p><strong>Why:</strong> Tracks short-term revenue trends.</p>
              <p><strong>Scenario:</strong> 500 customers at $200/month = $100K MRR.</p>
              <p><strong>Source:</strong> Payment processors (e.g., PayPal).</p>
            </div>
            <div class="explanation-box">
              <h4>Customer Lifetime Value (LTV)</h4>
              <p><strong>What:</strong> Total revenue per customer over time.</p>
              <p><strong>Why:</strong> High LTV boosts business value.</p>
              <p><strong>Scenario:</strong> $50/month for 4 years = $2,400 LTV.</p>
              <p><strong>Source:</strong> CRM (e.g., Salesforce).</p>
            </div>
            <div class="explanation-box">
              <h4>Customer Acquisition Cost (CAC)</h4>
              <p><strong>What:</strong> Cost to gain a new customer.</p>
              <p><strong>Why:</strong> Low CAC improves profitability.</p>
              <p><strong>Scenario:</strong> $10K ads for 20 customers = $500 CAC.</p>
              <p><strong>Source:</strong> Ad platforms (e.g., Google Ads).</p>
            </div>
            <div class="explanation-box">
              <h4>Gross Margin</h4>
              <p><strong>What:</strong> Revenue after direct costs (%).</p>
              <p><strong>Why:</strong> High margins show efficiency.</p>
              <p><strong>Scenario:</strong> $100K revenue, $25K costs = 75% margin.</p>
              <p><strong>Source:</strong> Income statement (e.g., QuickBooks).</p>
            </div>
            <div class="explanation-box">
              <h4>Net Profit / EBITDA</h4>
              <p><strong>What:</strong> Revenue after all expenses.</p>
              <p><strong>Why:</strong> High profit signals financial health.</p>
              <p><strong>Scenario:</strong> $1M revenue, $800K expenses = $200K profit.</p>
              <p><strong>Source:</strong> Profit/loss statement.</p>
            </div>
            <div class="explanation-box">
              <h4>Monthly Burn Rate</h4>
              <p><strong>What:</strong> Monthly cash loss.</p>
              <p><strong>Why:</strong> Low burn rate reassures investors.</p>
              <p><strong>Scenario:</strong> $50K spend, $25K revenue = $25K burn.</p>
              <p><strong>Source:</strong> Financial reports.</p>
            </div>
            <div class="explanation-box">
              <h4>Runway</h4>
              <p><strong>What:</strong> Months until cash runs out.</p>
              <p><strong>Why:</strong> Longer runway boosts sustainability.</p>
              <p><strong>Scenario:</strong> $300K cash, $25K burn = 12 months.</p>
              <p><strong>Source:</strong> Cash balance รท burn rate.</p>
            </div>
          </div>
        </div>
<!-- STEP 5/15 END: Paste this after Step 1 from Step 4 -->
        <!-- STEP 6/15 START: Pro Valuation Form (Step 3: Growth & Churn Rates) -->
        <!-- Step 3: Growth & Churn Rates -->
        <div id="step-3" class="step step-hidden" data-step="3">
          <h3 class="text-lg font-semibold text-gray-800 mb-4">Step 3: Growth & Churn Rates</h3>
          <p class="text-gray-600 mb-4 text-sm">
            Provide your revenue growth and churn rates.
            <span data-tooltip="Use data from analytics platforms." class="text-teal-500 underline cursor-pointer">Learn more</span>
          </p>
          <div class="space-y-3">
            <div>
              <label for="yoy-growth" class="block font-medium text-gray-700 mb-1">Year-over-Year Revenue Growth (%)</label>
              <input type="number" id="yoy-growth" min="0" step="0.1" placeholder="e.g., 25" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="yoy-growth-error" />
              <p id="yoy-growth-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a valid number.</p>
            </div>
            <div>
              <label for="mom-growth" class="block font-medium text-gray-700 mb-1">Month-over-Month Revenue Growth (%)</label>
              <input type="number" id="mom-growth" min="0" step="0.1" placeholder="e.g., 5" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="mom-growth-error" />
              <p id="mom-growth-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a valid number.</p>
            </div>
            <div>
              <label for="customer-churn" class="block font-medium text-gray-700 mb-1">Customer Churn Rate (%)</label>
              <input type="number" id="customer-churn" min="0" max="100" step="0.1" placeholder="e.g., 5" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="customer-churn-error" />
              <p id="customer-churn-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a value between 0 and 100.</p>
            </div>
            <div>
              <label for="revenue-churn" class="block font-medium text-gray-700 mb-1">Revenue Churn Rate (%)</label>
              <input type="number" id="revenue-churn" min="0" max="100" step="0.1" placeholder="e.g., 4" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="revenue-churn-error" />
              <p id="revenue-churn-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a value between 0 and 100.</p>
            </div>
            <p id="growth-churn-error" class="text-red-500 text-sm mt-2 hidden" role="alert">Please fill all growth and churn fields correctly.</p>
            <div class="mt-4 flex justify-between">
              <button id="prev-btn-3" class="btn-secondary" aria-label="Return to previous step">Previous</button>
              <button id="next-btn-3" class="btn-primary" aria-label="Proceed to next step">Next</button>
            </div>
          </div>
          <div class="explanation-section">
            <div class="explanation-box">
              <h4>Year-over-Year Revenue Growth</h4>
              <p><strong>What:</strong> Annual revenue increase (%).</p>
              <p><strong>Why:</strong> High growth boosts valuation.</p>
              <p><strong>Scenario:</strong> $1M to $1.25M = 25% YoY.</p>
              <p><strong>Source:</strong> Financial reports (e.g., Xero).</p>
            </div>
            <div class="explanation-box">
              <h4>Month-over-Month Revenue Growth</h4>
              <p><strong>What:</strong> Monthly revenue increase (%).</p>
              <p><strong>Why:</strong> Shows short-term momentum.</p>
              <p><strong>Scenario:</strong> $100K to $105K = 5% MoM.</p>
              <p><strong>Source:</strong> Billing systems (e.g., Chargebee).</p>
            </div>
            <div class="explanation-box">
              <h4>Customer Churn Rate</h4>
              <p><strong>What:</strong> % of customers lost monthly.</p>
              <p><strong>Why:</strong> Low churn signals retention.</p>
              <p><strong>Scenario:</strong> 5 of 100 customers leave = 5%.</p>
              <p><strong>Source:</strong> CRM (e.g., HubSpot).</p>
            </div>
            <div class="explanation-box">
              <h4>Revenue Churn Rate</h4>
              <p><strong>What:</strong> % of revenue lost monthly.</p>
              <p><strong>Why:</strong> Low revenue churn boosts stability.</p>
              <p><strong>Scenario:</strong> $5K of $100K MRR lost = 5%.</p>
              <p><strong>Source:</strong> Analytics (e.g., Baremetrics).</p>
            </div>
          </div>
        </div>
<!-- STEP 6/15 END: Paste this after Step 2 from Step 5 -->
        <!-- STEP 7/15 START: Pro Valuation Form (Step 4: Customer & Market Metrics) -->
        <!-- Step 4: Customer & Market Metrics -->
        <div id="step-4" class="step step-hidden" data-step="4">
          <h3 class="text-lg font-semibold text-gray-800 mb-4">Step 4: Customer & Market Metrics</h3>
          <p class="text-gray-600 mb-4 text-sm">
            Provide details about your customer base and market.
            <span data-tooltip="Use CRM and survey data." class="text-teal-500 underline cursor-pointer">Learn more</span>
          </p>
          <div class="space-y-3">
            <div>
              <label for="total-customers" class="block font-medium text-gray-700 mb-1">Total Active Customers</label>
              <input type="number" id="total-customers" min="0" step="1" placeholder="e.g., 1000" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="total-customers-error" />
              <p id="total-customers-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a valid number.</p>
            </div>
            <div>
              <label for="retention-rate" class="block font-medium text-gray-700 mb-1">Customer Retention Rate (%)</label>
              <input type="number" id="retention-rate" min="0" max="100" step="0.1" placeholder="e.g., 85" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="retention-rate-error" />
              <p id="retention-rate-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a value between 0 and 100.</p>
            </div>
            <div>
              <label for="nps" class="block font-medium text-gray-700 mb-1">Net Promoter Score (NPS)</label>
              <input type="number" id="nps" min="-100" max="100" step="1" placeholder="e.g., 30" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="nps-error" />
              <p id="nps-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a value between -100 and 100.</p>
            </div>
            <div>
              <label for="market-segment" class="block font-medium text-gray-700 mb-1">Primary Market Segment</label>
              <select id="market-segment" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="market-segment-error">
                <option value="" disabled selected>Select Market Segment</option>
                <option value="smb">Small & Medium Businesses (SMB)</option>
                <option value="mid-market">Mid-Market</option>
                <option value="enterprise">Enterprise</option>
                <option value="consumer">Consumer</option>
                <option value="government">Government</option>
                <option value="nonprofit">Nonprofit</option>
              </select>
              <p id="market-segment-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please select a market segment.</p>
            </div>
            <div>
              <label for="buyer-type" class="block font-medium text-gray-700 mb-1">Primary Buyer Type</label>
              <select id="buyer-type" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="buyer-type-error">
                <option value="" disabled selected>Select Buyer Type</option>
                <option value="executive">C-Level Executives</option>
                <option value="manager">Managers</option>
                <option value="end-user">End Users</option>
                <option value="it">IT Departments</option>
                <option value="hr">HR Departments</option>
                <option value="finance">Finance Departments</option>
              </select>
              <p id="buyer-type-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please select a buyer type.</p>
            </div>
            <p id="customer-market-error" class="text-red-500 text-sm mt-2 hidden" role="alert">Please fill all customer and market fields correctly.</p>
            <div class="mt-4 flex justify-between">
              <button id="prev-btn-4" class="btn-secondary" aria-label="Return to previous step">Previous</button>
              <button id="next-btn-4" class="btn-primary" aria-label="Proceed to next step">Next</button>
            </div>
          </div>
          <div class="explanation-section">
            <div class="explanation-box">
              <h4>Total Active Customers</h4>
              <p><strong>What:</strong> Number of paying customers.</p>
              <p><strong>Why:</strong> Large base signals market traction.</p>
              <p><strong>Scenario:</strong> 1,000 active subscriptions.</p>
              <p><strong>Source:</strong> CRM (e.g., Salesforce).</p>
            </div>
            <div class="explanation-box">
              <h4>Customer Retention Rate</h4>
              <p><strong>What:</strong> % of customers retained yearly.</p>
              <p><strong>Why:</strong> High retention boosts valuation.</p>
              <p><strong>Scenario:</strong> 850 of 1,000 customers stay = 85%.</p>
              <p><strong>Source:</strong> Analytics (e.g., Mixpanel).</p>
            </div>
            <div class="explanation-box">
              <h4>Net Promoter Score (NPS)</h4>
              <p><strong>What:</strong> Customer satisfaction (-100 to 100).</p>
              <p><strong>Why:</strong> High NPS shows loyalty.</p>
              <p><strong>Scenario:</strong> 40% promoters, 10% detractors = 30 NPS.</p>
              <p><strong>Source:</strong> Surveys (e.g., SurveyMonkey).</p>
            </div>
            <div class="explanation-box">
              <h4>Primary Market Segment</h4>
              <p><strong>What:</strong> Main customer group.</p>
              <p><strong>Why:</strong> Defines market fit and valuation context.</p>
              <p><strong>Scenario:</strong> SMBs as primary customers.</p>
              <p><strong>Source:</strong> Sales data.</p>
            </div>
            <div class="explanation-box">
              <h4>Primary Buyer Type</h4>
              <p><strong>What:</strong> Main decision-maker for purchases.</p>
              <p><strong>Why:</strong> Buyer type affects sales cycle.</p>
              <p><strong>Scenario:</strong> Targeting C-level executives.</p>
              <p><strong>Source:</strong> Sales team insights.</p>
            </div>
          </div>
        </div>
<!-- STEP 7/15 END: Paste this after Step 3 from Step 6 -->
        <!-- STEP 8/15 START: Pro Valuation Form (Step 5: Product & Technology) -->
        <!-- Step 5: Product & Technology -->
        <div id="step-5" class="step step-hidden" data-step="5">
          <h3 class="text-lg font-semibold text-gray-800 mb-4">Step 5: Product & Technology</h3>
          <p class="text-gray-600 mb-4 text-sm">
            Assess your product and tech stack.
            <span data-tooltip="Use product and engineering team insights." class="text-teal-500 underline cursor-pointer">Learn more</span>
          </p>
          <div class="space-y-3">
            <div>
              <label for="product-market-fit" class="block font-medium text-gray-700 mb-1">Product-Market Fit</label>
              <select id="product-market-fit" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="product-market-fit-error">
                <option value="" disabled selected>Select Option</option>
                <option value="proven">Proven (High demand, retention)</option>
                <option value="developing">Developing (Some traction)</option>
                <option value="early">Early Stage (Testing fit)</option>
              </select>
              <p id="product-market-fit-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please select an option.</p>
            </div>
            <div>
              <label for="proprietary-tech" class="block font-medium text-gray-700 mb-1">Proprietary Technology</label>
              <select id="proprietary-tech" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="proprietary-tech-error">
                <option value="" disabled selected>Select Option</option>
                <option value="unique">Unique (Patented or exclusive)</option>
                <option value="some">Some (Differentiated but not exclusive)</option>
                <option value="none">None (Standard tech)</option>
              </select>
              <p id="proprietary-tech-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please select an option.</p>
            </div>
            <div>
              <label for="code-quality" class="block font-medium text-gray-700 mb-1">Code Quality</label>
              <select id="code-quality" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="code-quality-error">
                <option value="" disabled selected>Select Option</option>
                <option value="high">High (Well-documented, tested)</option>
                <option value="medium">Medium (Functional, some issues)</option>
                <option value="low">Low (Legacy, technical debt)</option>
              </select>
              <p id="code-quality-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please select an option.</p>
            </div>
            <div>
              <label for="scalability" class="block font-medium text-gray-700 mb-1">Scalability</label>
              <select id="scalability" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="scalability-error">
                <option value="" disabled selected>Select Option</option>
                <option value="high">High (Cloud-native, auto-scaling)</option>
                <option value="medium">Medium (Scalable with effort)</option>
                <option value="low">Low (Limited by infrastructure)</option>
              </select>
              <p id="scalability-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please select an option.</p>
            </div>
            <div>
              <label for="release-frequency" class="block font-medium text-gray-700 mb-1">Release Frequency</label>
              <select id="release-frequency" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="release-frequency-error">
                <option value="" disabled selected>Select Option</option>
                <option value="frequent">Frequent (Weekly/Bi-weekly)</option>
                <option value="regular">Regular (Monthly/Quarterly)</option>
                <option value="infrequent">Infrequent (Rare updates)</option>
              </select>
              <p id="release-frequency-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please select an option.</p>
            </div>
            <div>
              <label for="security-compliance" class="block font-medium text-gray-700 mb-1">Security & Compliance</label>
              <select id="security-compliance" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="security-compliance-error">
                <option value="" disabled selected>Select Option</option>
                <option value="certified">Certified (SOC 2, GDPR, etc.)</option>
                <option value="partial">Partial (Basic measures)</option>
                <option value="none">None (No formal compliance)</option>
              </select>
              <p id="security-compliance-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please select an option.</p>
            </div>
            <p id="product-tech-error" class="text-red-500 text-sm mt-2 hidden" role="alert">Please fill all product and technology fields correctly.</p>
            <div class="mt-4 flex justify-between">
              <button id="prev-btn-5" class="btn-secondary" aria-label="Return to previous step">Previous</button>
              <button id="next-btn-5" class="btn-primary" aria-label="Proceed to next step">Next</button>
            </div>
          </div>
          <div class="explanation-section">
            <div class="explanation-box">
              <h4>Product-Market Fit</h4>
              <p><strong>What:</strong> How well your product meets market needs.</p>
              <p><strong>Why:</strong> Proven fit increases valuation.</p>
              <p><strong>Scenario:</strong> High retention = Proven fit.</p>
              <p><strong>Source:</strong> Customer feedback (e.g., surveys).</p>
            </div>
            <div class="explanation-box">
              <h4>Proprietary Technology</h4>
              <p><strong>What:</strong> Unique tech owned by your company.</p>
              <p><strong>Why:</strong> Exclusive tech adds value.</p>
              <p><strong>Scenario:</strong> Patented algorithm = Unique.</p>
              <p><strong>Source:</strong> Patent filings, tech audits.</p>
            </div>
            <div class="explanation-box">
              <h4>Code Quality</h4>
              <p><strong>What:</strong> Quality of your codebase.</p>
              <p><strong>Why:</strong> High quality reduces tech debt.</p>
              <p><strong>Scenario:</strong> Well-tested code = High.</p>
              <p><strong>Source:</strong> Engineering reports (e.g., SonarQube).</p>
            </div>
            <div class="explanation-box">
              <h4>Scalability</h4>
              <p><strong>What:</strong> Ability to handle growth.</p>
              <p><strong>Why:</strong> High scalability supports expansion.</p>
              <p><strong>Scenario:</strong> AWS auto-scaling = High.</p>
              <p><strong>Source:</strong> Infrastructure audits.</p>
            </div>
            <div class="explanation-box">
              <h4>Release Frequency</h4>
              <p><strong>What:</strong> How often you update your product.</p>
              <p><strong>Why:</strong> Frequent releases show agility.</p>
              <p><strong>Scenario:</strong> Weekly updates = Frequent.</p>
              <p><strong>Source:</strong> CI/CD logs (e.g., GitHub Actions).</p>
            </div>
            <div class="explanation-box">
              <h4>Security & Compliance</h4>
              <p><strong>What:</strong> Adherence to security standards.</p>
              <p><strong>Why:</strong> Compliance builds trust.</p>
              <p><strong>Scenario:</strong> SOC 2 certified = Certified.</p>
              <p><strong>Source:</strong> Audit reports.</p>
            </div>
          </div>
        </div>
<!-- STEP 8/15 END: Paste this after Step 4 from Step 7 -->
        <!-- STEP 9/15 START: Pro Valuation Form (Step 6: Team & Operations) -->
        <!-- Step 6: Team & Operations -->
        <div id="step-6" class="step step-hidden" data-step="6">
          <h3 class="text-lg font-semibold text-gray-800 mb-4">Step 6: Team & Operations</h3>
          <p class="text-gray-600 mb-4 text-sm">
            Provide details about your team and operational efficiency.
            <span data-tooltip="Use HR and operational data." class="text-teal-500 underline cursor-pointer">Learn more</span>
          </p>
          <div class="space-y-3">
            <div>
              <label for="team-size" class="block font-medium text-gray-700 mb-1">Total Team Size</label>
              <input type="number" id="team-size" min="0" step="1" placeholder="e.g., 50" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="team-size-error" />
              <p id="team-size-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a valid number.</p>
            </div>
            <div>
              <label for="key-staff" class="block font-medium text-gray-700 mb-1">Key Staff Retention</label>
              <select id="key-staff" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="key-staff-error">
                <option value="" disabled selected>Select Option</option>
                <option value="high">High (Stable leadership)</option>
                <option value="medium">Medium (Some turnover)</option>
                <option value="low">Low (Frequent changes)</option>
              </select>
              <p id="key-staff-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please select an option.</p>
            </div>
            <div>
              <label for="turnover-rate" class="block font-medium text-gray-700 mb-1">Employee Turnover Rate (%)</label>
              <input type="number" id="turnover-rate" min="0" max="100" step="0.1" placeholder="e.g., 10" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="turnover-rate-error" />
              <p id="turnover-rate-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a value between 0 and 100.</p>
            </div>
            <div>
              <label for="eng-sales-ratio" class="block font-medium text-gray-700 mb-1">Engineer-to-Sales Ratio</label>
              <select id="eng-sales-ratio" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="eng-sales-ratio-error">
                <option value="" disabled selected>Select Option</option>
                <option value="high">High (More engineers)</option>
                <option value="balanced">Balanced</option>
                <option value="low">Low (More sales)</option>
              </select>
              <p id="eng-sales-ratio-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please select an option.</p>
            </div>
            <div>
              <label for="support-quality" class="block font-medium text-gray-700 mb-1">Customer Support Quality</label>
              <select id="support-quality" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="support-quality-error">
                <option value="" disabled selected>Select Option</option>
                <option value="high">High (24/7, dedicated team)</option>
                <option value="medium">Medium (Standard support)</option>
                <option value="low">Low (Limited support)</option>
              </select>
              <p id="support-quality-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please select an option.</p>
            </div>
            <div>
              <label for="headcount-growth" class="block font-medium text-gray-700 mb-1">Headcount Growth (%)</label>
              <input type="number" id="headcount-growth" min="0" step="0.1" placeholder="e.g., 20" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="headcount-growth-error" />
              <p id="headcount-growth-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a valid number.</p>
            </div>
            <p id="team-ops-error" class="text-red-500 text-sm mt-2 hidden" role="alert">Please fill all team and operations fields correctly.</p>
            <div class="mt-4 flex justify-between">
              <button id="prev-btn-6" class="btn-secondary" aria-label="Return to previous step">Previous</button>
              <button id="next-btn-6" class="btn-primary" aria-label="Proceed to next step">Next</button>
            </div>
          </div>
          <div class="explanation-section">
            <div class="explanation-box">
              <h4>Total Team Size</h4>
              <p><strong>What:</strong> Number of full-time employees.</p>
              <p><strong>Why:</strong> Large teams signal scalability.</p>
              <p><strong>Scenario:</strong> 50 employees across roles.</p>
              <p><strong>Source:</strong> HR records (e.g., BambooHR).</p>
            </div>
            <div class="explanation-box">
              <h4>Key Staff Retention</h4>
              <p><strong>What:</strong> Stability of leadership team.</p>
              <p><strong>Why:</strong> High retention builds trust.</p>
              <p><strong>Scenario:</strong> No C-level turnover = High.</p>
              <p><strong>Source:</strong> HR data.</p>
            </div>
            <div class="explanation-box">
              <h4>Employee Turnover Rate</h4>
              <p><strong>What:</strong> % of employees leaving yearly.</p>
              <p><strong>Why:</strong> Low turnover shows stability.</p>
              <p><strong>Scenario:</strong> 5 of 50 leave = 10%.</p>
              <p><strong>Source:</strong> HR metrics (e.g., Workday).</p>
            </div>
            <div class="explanation-box">
              <h4>Engineer-to-Sales Ratio</h4>
              <p><strong>What:</strong> Balance of tech vs. sales staff.</p>
              <p><strong>Why:</strong> Balanced ratio optimizes growth.</p>
              <p><strong>Scenario:</strong> 20 engineers, 20 sales = Balanced.</p>
              <p><strong>Source:</strong> Org chart.</p>
            </div>
            <div class="explanation-box">
              <h4>Customer Support Quality</h4>
              <p><strong>What:</strong> Quality of customer support.</p>
              <p><strong>Why:</strong> High quality improves retention.</p>
              <p><strong>Scenario:</strong> 24/7 support team = High.</p>
              <p><strong>Source:</strong> Support metrics (e.g., Zendesk).</p>
            </div>
            <div class="explanation-box">
              <h4>Headcount Growth</h4>
              <p><strong>What:</strong> % increase in staff yearly.</p>
              <p><strong>Why:</strong> Growth shows scalability.</p>
              <p><strong>Scenario:</strong> 50 to 60 employees = 20%.</p>
              <p><strong>Source:</strong> HR planning.</p>
            </div>
          </div>
        </div>
<!-- STEP 9/15 END: Paste this after Step 5 from Step 8 -->
       <!-- STEP 10/15 START: Pro Valuation Form (Step 7: Legal, Contracts & Risk) -->
<section id="pro-valuation" class="py-12 bg-gray-50">
  <div class="container mx-auto px-4 max-w-3xl">
    <div class="text-center mb-8">
      <h2 class="text-2xl font-bold text-gray-800 mb-2">Pro Valuation Tool</h2>
      <p class="text-base text-gray-600 max-w-xl mx-auto">
        Answer questions step-by-step to get a detailed valuation report with actionable insights.
      </p>
    </div>

    <!-- Progress Bar -->
    <div class="mb-6">
      <div class="relative pt-1">
        <div class="overflow-hidden h-1.5 mb-2 text-xs flex rounded bg-gray-200">
          <div id="progress-fill" class="shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-teal-500" style="width: 12.5%"></div>
        </div>
        <p class="text-center text-gray-600 text-sm">
          Step <span id="current-step">1</span> of 8
        </p>
      </div>
    </div>

    <form id="valuation-form" action="https://formspree.io/f/mnnnoogg" method="POST">
      <div class="valuation-box">
        <!-- Step 0: SaaS Type Selection -->
        <div id="step-0" class="step step-visible" data-step="0">
          <h3 class="text-lg font-semibold text-gray-800 mb-4">Step 0: Select Your SaaS Business Type</h3>
          <p class="text-gray-600 mb-4 text-sm">
            Choose the category that best describes your SaaS business. This helps us apply the most accurate valuation multipliers.
          </p>
          <div>
            <label for="saas-type" class="block font-medium text-gray-700 mb-1">SaaS Business Type</label>
            <select id="saas-type" name="saas-type" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="saas-type-error">
              <option value="" disabled selected>Select SaaS Type</option>
              <option value="crm">CRM / Sales</option>
              <option value="marketing">Marketing Automation</option>
              <option value="analytics">Analytics / BI</option>
              <option value="erp">ERP / Operations</option>
              <option value="finance">Finance / Accounting</option>
              <option value="hr">HR / Payroll</option>
              <option value="project">Project Management</option>
              <option value="collaboration">Collaboration / Communication</option>
              <option value="devtools">Developer Tools</option>
              <option value="security">Security / Compliance</option>
              <option value="ecommerce">E-commerce / Retail</option>
              <option value="education">Education / LMS</option>
              <option value="healthcare">Healthcare / MedTech</option>
              <option value="realestate">Real Estate Tech</option>
              <option value="vertical">Vertical SaaS (Industry-specific)</option>
              <option value="productivity">Productivity</option>
              <option value="support">Customer Support / Helpdesk</option>
              <option value="media">Media / Content</option>
              <option value="iot">IoT / Hardware SaaS</option>
              <option value="other">Other</option>
            </select>
            <p id="saas-type-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please select a SaaS type.</p>
          </div>
          <div class="mt-4 flex justify-end">
            <button id="next-btn-0" class="btn-primary" type="button" aria-label="Proceed to next step">Next</button>
          </div>
        </div>

        <!-- Step 1: Company Info & Valuation Methods -->
        <div id="step-1" class="step step-hidden" data-step="1">
          <h3 class="text-lg font-semibold text-gray-800 mb-4">Step 1: Company Information & Valuation Methods</h3>
          <p class="text-gray-600 mb-4 text-sm">
            Provide your company details and choose up to 3 valuation methods.
            <span data-tooltip="Company info will appear in the report." class="text-teal-500 underline cursor-pointer">Learn more</span>
          </p>
          <div class="space-y-3">
            <div>
              <label for="company-name" class="block font-medium text-gray-700 mb-1">Company Name</label>
              <input type="text" id="company-name" name="company-name" placeholder="e.g., Acme Inc." class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="company-name-error" />
              <p id="company-name-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a valid company name.</p>
            </div>
            <div>
              <label for="company-website" class="block font-medium text-gray-700 mb-1">Company Website</label>
              <input type="url" id="company-website" name="company-website" placeholder="e.g., https://www.acme.com" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="company-website-error" />
              <p id="company-website-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a valid URL (e.g., https://www.example.com).</p>
            </div>
            <div>
              <label for="company-email" class="block font-medium text-gray-700 mb-1">Company Email</label>
              <input type="email" id="company-email" name="company-email" placeholder="e.g., contact@acme.com" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="company-email-error" />
              <p id="company-email-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a valid email address.</p>
            </div>
            <div>
              <label class="block font-medium text-gray-700 mb-1">Valuation Methods</label>
              <label class="flex items-center">
                <input type="checkbox" id="method-multiplier" name="valuation-methods" value="multiplier" class="form-checkbox h-5 w-5 text-teal-500" aria-label="Revenue Multiplier" />
                <span class="ml-2">Revenue Multiplier</span>
              </label>
              <label class="flex items-center">
                <input type="checkbox" id="method-income" name="valuation-methods" value="income" class="form-checkbox h-5 w-5 text-teal-500" aria-label="Income-Based" />
                <span class="ml-2">Income-Based</span>
              </label>
              <label class="flex items-center">
                <input type="checkbox" id="method-earnings" name="valuation-methods" value="earnings" class="form-checkbox h-5 w-5 text-teal-500" aria-label="Earnings-Based" />
                <span class="ml-2">Earnings-Based</span>
              </label>
              <label class="flex items-center">
                <input type="checkbox" id="method-dcf" name="valuation-methods" value="dcf" class="form-checkbox h-5 w-5 text-teal-500" aria-label="Discounted Cash Flow (DCF)" />
                <span class="ml-2">Discounted Cash Flow (DCF)</span>
              </label>
              <p id="method-error" class="text-red-500 text-sm mt-2 hidden" role="alert">
                Please select 1 to 3 valuation methods.
              </p>
            </div>
          </div>
          <div class="explanation-section">
            <div class="explanation-box">
              <h4>Revenue Multiplier</h4>
              <p><strong>What:</strong> Multiplies your annual revenue (ARR) by a factor (e.g., 5-8).</p>
              <p><strong>Why:</strong> Ideal for stable SaaS revenue, showing investor value.</p>
              <p><strong>Scenario:</strong> $1M ARR with a 6x multiplier = $6M valuation.</p>
              <p><strong>Source:</strong> ARR from Stripe; multipliers from industry reports.</p>
            </div>
            <div class="explanation-box">
              <h4>Income-Based</h4>
              <p><strong>What:</strong> Multiplies net profit by a factor (e.g., 4-7).</p>
              <p><strong>Why:</strong> Highlights profitability for cash-generating businesses.</p>
              <p><strong>Scenario:</strong> $200K profit with a 5x multiplier = $1M valuation.</p>
              <p><strong>Source:</strong> Net profit from QuickBooks; multipliers from advisors.</p>
            </div>
            <div class="explanation-box">
              <h4>Earnings-Based</h4>
              <p><strong>What:</strong> Combines ARR and profit, adjusted for growth.</p>
              <p><strong>Why:</strong> Balances revenue and profit for growing SaaS.</p>
              <p><strong>Scenario:</strong> $1M ARR, $200K profit = $1.5M valuation.</p>
              <p><strong>Source:</strong> ARR/profit from reports; retention from CRM.</p>
            </div>
            <div class="explanation-box">
              <h4>Discounted Cash Flow (DCF)</h4>
              <p><strong>What:</strong> Discounts future cash flows to present value.</p>
              <p><strong>Why:</strong> Best for long-term growth potential.</p>
              <p><strong>Scenario:</strong> $1M ARR, 20% growth = $3M valuation.</p>
              <p><strong>Source:</strong> Projections from LivePlan; discount rates from analysts.</p>
            </div>
          </div>
          <div class="mt-4 flex justify-end">
            <button id="next-btn-1" class="btn-primary" type="button" aria-label="Proceed to next step">Next</button>
          </div>
        </div>

        <!-- Step 2: Financial Metrics -->
        <div id="step-2" class="step step-hidden" data-step="2">
          <h3 class="text-lg font-semibold text-gray-800 mb-4">Step 2: Financial Metrics</h3>
          <p class="text-gray-600 mb-4 text-sm">
            Enter key financial figures for your business.
            <span data-tooltip="Use latest financial statements." class="text-teal-500 underline cursor-pointer">Learn more</span>
          </p>
          <div class="space-y-3">
            <div>
              <label for="arr" class="block font-medium text-gray-700 mb-1">Annual Recurring Revenue (ARR) ($)</label>
              <input type="number" id="arr" name="arr" min="0" step="1000" placeholder="e.g., 500000" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="arr-error" />
              <p id="arr-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a valid number.</p>
            </div>
            <div>
              <label for="mrr" class="block font-medium text-gray-700 mb-1">Monthly Recurring Revenue (MRR) ($)</label>
              <input type="number" id="mrr" name="mrr" min="0" step="100" placeholder="e.g., 41667" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="mrr-error" />
              <p id="mrr-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a valid number.</p>
            </div>
            <div>
              <label for="ltv" class="block font-medium text-gray-700 mb-1">Customer Lifetime Value (LTV) ($)</label>
              <input type="number" id="ltv" name="ltv" min="0" step="100" placeholder="e.g., 2000" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="ltv-error" />
              <p id="ltv-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a valid number.</p>
            </div>
            <div>
              <label for="cac" class="block font-medium text-gray-700 mb-1">Customer Acquisition Cost (CAC) ($)</label>
              <input type="number" id="cac" name="cac" min="0" step="10" placeholder="e.g., 500" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="cac-error" />
              <p id="cac-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a valid number.</p>
            </div>
            <div>
              <label for="gross-margin" class="block font-medium text-gray-700 mb-1">Gross Margin (%)</label>
              <input type="number" id="gross-margin" name="gross-margin" min="0" max="100" step="0.1" placeholder="e.g., 75" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="gross-margin-error" />
              <p id="gross-margin-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a value between 0 and 100.</p>
            </div>
            <div>
              <label for="net-profit" class="block font-medium text-gray-700 mb-1">Net Profit / EBITDA ($)</label>
              <input type="number" id="net-profit" name="net-profit" min="0" step="1000" placeholder="e.g., 200000" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="net-profit-error" />
              <p id="net-profit-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a valid number.</p>
            </div>
            <div>
              <label for="burn-rate" class="block font-medium text-gray-700 mb-1">Monthly Burn Rate ($)</label>
              <input type="number" id="burn-rate" name="burn-rate" min="0" step="1000" placeholder="e.g., 25000" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="burn-rate-error" />
              <p id="burn-rate-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a valid number.</p>
            </div>
            <div>
              <label for="runway" class="block font-medium text-gray-700 mb-1">Runway (Months)</label>
              <input type="number" id="runway" name="runway" min="0" step="1" placeholder="e.g., 12" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="runway-error" />
              <p id="runway-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a valid number.</p>
            </div>
            <p id="financial-error" class="text-red-500 text-sm mt-2 hidden" role="alert">Please fill all financial fields correctly.</p>
            <div class="mt-4 flex justify-between">
              <button id="prev-btn-2" class="btn-secondary" type="button" aria-label="Return to previous step">Previous</button>
              <button id="next-btn-2" class="btn-primary" type="button" aria-label="Proceed to next step">Next</button>
            </div>
          </div>
          <div class="explanation-section">
            <div class="explanation-box">
              <h4>Annual Recurring Revenue (ARR)</h4>
              <p><strong>What:</strong> Yearly subscription revenue.</p>
              <p><strong>Why:</strong> Shows revenue stability, key for valuation.</p>
              <p><strong>Scenario:</strong> 1,000 customers at $100/month = $1.2M ARR.</p>
              <p><strong>Source:</strong> Billing systems (e.g., Stripe).</p>
            </div>
            <div class="explanation-box">
              <h4>Monthly Recurring Revenue (MRR)</h4>
              <p><strong>What:</strong> Monthly subscription revenue.</p>
              <p><strong>Why:</strong> Tracks short-term revenue trends.</p>
              <p><strong>Scenario:</strong> 500 customers at $200/month = $100K MRR.</p>
              <p><strong>Source:</strong> Payment processors (e.g., PayPal).</p>
            </div>
            <div class="explanation-box">
              <h4>Customer Lifetime Value (LTV)</h4>
              <p><strong>What:</strong> Total revenue per customer over time.</p>
              <p><strong>Why:</strong> High LTV boosts business value.</p>
              <p><strong>Scenario:</strong> $50/month for 4 years = $2,400 LTV.</p>
              <p><strong>Source:</strong> CRM (e.g., Salesforce).</p>
            </div>
            <div class="explanation-box">
              <h4>Customer Acquisition Cost (CAC)</h4>
              <p><strong>What:</strong> Cost to gain a new customer.</p>
              <p><strong>Why:</strong> Low CAC improves profitability.</p>
              <p><strong>Scenario:</strong> $10K ads for 20 customers = $500 CAC.</p>
              <p><strong>Source:</strong> Ad platforms (e.g., Google Ads).</p>
            </div>
            <div class="explanation-box">
              <h4>Gross Margin</h4>
              <p><strong>What:</strong> Revenue after direct costs (%).</p>
              <p><strong>Why:</strong> High margins show efficiency.</p>
              <p><strong>Scenario:</strong> $100K revenue, $25K costs = 75% margin.</p>
              <p><strong>Source:</strong> Income statement (e.g., QuickBooks).</p>
            </div>
            <div class="explanation-box">
              <h4>Net Profit / EBITDA</h4>
              <p><strong>What:</strong> Revenue after all expenses.</p>
              <p><strong>Why:</strong> High profit signals financial health.</p>
              <p><strong>Scenario:</strong> $1M revenue, $800K expenses = $200K profit.</p>
              <p><strong>Source:</strong> Profit/loss statement.</p>
            </div>
            <div class="explanation-box">
              <h4>Monthly Burn Rate</h4>
              <p><strong>What:</strong> Monthly cash loss.</p>
              <p><strong>Why:</strong> Low burn rate reassures investors.</p>
              <p><strong>Scenario:</strong> $50K spend, $25K revenue = $25K burn.</p>
              <p><strong>Source:</strong> Financial reports.</p>
            </div>
            <div class="explanation-box">
              <h4>Runway</h4>
              <p><strong>What:</strong> Months until cash runs out.</p>
              <p><strong>Why:</strong> Longer runway boosts sustainability.</p>
              <p><strong>Scenario:</strong> $300K cash, $25K burn = 12 months.</p>
              <p><strong>Source:</strong> Cash balance รท burn rate.</p>
            </div>
          </div>
        </div>

        <!-- Step 3: Growth & Churn Rates -->
        <div id="step-3" class="step step-hidden" data-step="3">
          <h3 class="text-lg font-semibold text-gray-800 mb-4">Step 3: Growth & Churn Rates</h3>
          <p class="text-gray-600 mb-4 text-sm">
            Provide your revenue growth and churn rates.
            <span data-tooltip="Use data from analytics platforms." class="text-teal-500 underline cursor-pointer">Learn more</span>
          </p>
          <div class="space-y-3">
            <div>
              <label for="yoy-growth" class="block font-medium text-gray-700 mb-1">Year-over-Year Revenue Growth (%)</label>
              <input type="number" id="yoy-growth" name="yoy-growth" min="0" step="0.1" placeholder="e.g., 25" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="yoy-growth-error" />
              <p id="yoy-growth-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a valid number.</p>
            </div>
            <div>
              <label for="mom-growth" class="block font-medium text-gray-700 mb-1">Month-over-Month Revenue Growth (%)</label>
              <input type="number" id="mom-growth" name="mom-growth" min="0" step="0.1" placeholder="e.g., 5" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="mom-growth-error" />
              <p id="mom-growth-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a valid number.</p>
            </div>
            <div>
              <label for="customer-churn" class="block font-medium text-gray-700 mb-1">Customer Churn Rate (%)</label>
              <input type="number" id="customer-churn" name="customer-churn" min="0" max="100" step="0.1" placeholder="e.g., 5" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="customer-churn-error" />
              <p id="customer-churn-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a value between 0 and 100.</p>
            </div>
            <div>
              <label for="revenue-churn" class="block font-medium text-gray-700 mb-1">Revenue Churn Rate (%)</label>
              <input type="number" id="revenue-churn" name="revenue-churn" min="0" max="100" step="0.1" placeholder="e.g., 4" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="revenue-churn-error" />
              <p id="revenue-churn-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a value between 0 and 100.</p>
            </div>
            <p id="growth-churn-error" class="text-red-500 text-sm mt-2 hidden" role="alert">Please fill all growth and churn fields correctly.</p>
            <div class="mt-4 flex justify-between">
              <button id="prev-btn-3" class="btn-secondary" type="button" aria-label="Return to previous step">Previous</button>
              <button id="next-btn-3" class="btn-primary" type="button" aria-label="Proceed to next step">Next</button>
            </div>
          </div>
          <div class="explanation-section">
            <div class="explanation-box">
              <h4>Year-over-Year Revenue Growth</h4>
              <p><strong>What:</strong> Annual revenue increase (%).</p>
              <p><strong>Why:</strong> High growth boosts valuation.</p>
              <p><strong>Scenario:</strong> $1M to $1.25M = 25% YoY.</p>
              <p><strong>Source:</strong> Financial reports (e.g., Xero).</p>
            </div>
            <div class="explanation-box">
              <h4>Month-over-Month Revenue Growth</h4>
              <p><strong>What:</strong> Monthly revenue increase (%).</p>
              <p><strong>Why:</strong> Shows short-term momentum.</p>
              <p><strong>Scenario:</strong> $100K to $105K = 5% MoM.</p>
              <p><strong>Source:</strong> Billing systems (e.g., Chargebee).</p>
            </div>
            <div class="explanation-box">
              <h4>Customer Churn Rate</h4>
              <p><strong>What:</strong> % of customers lost monthly.</p>
              <p><strong>Why:</strong> Low churn signals retention.</p>
              <p><strong>Scenario:</strong> 5 of 100 customers leave = 5%.</p>
              <p><strong>Source:</strong> CRM (e.g., HubSpot).</p>
            </div>
            <div class="explanation-box">
              <h4>Revenue Churn Rate</h4>
              <p><strong>What:</strong> % of revenue lost monthly.</p>
              <p><strong>Why:</strong> Low revenue churn boosts stability.</p>
              <p><strong>Scenario:</strong> $5K of $100K MRR lost = 5%.</p>
              <p><strong>Source:</strong> Analytics (e.g., Baremetrics).</p>
            </div>
          </div>
        </div>

        <!-- Step 4: Customer & Market Metrics -->
        <div id="step-4" class="step step-hidden" data-step="4">
          <h3 class="text-lg font-semibold text-gray-800 mb-4">Step 4: Customer & Market Metrics</h3>
          <p class="text-gray-600 mb-4 text-sm">
            Provide details about your customer base and market.
            <span data-tooltip="Use CRM and survey data." class="text-teal-500 underline cursor-pointer">Learn more</span>
          </p>
          <div class="space-y-3">
            <div>
              <label for="total-customers" class="block font-medium text-gray-700 mb-1">Total Active Customers</label>
              <input type="number" id="total-customers" name="total-customers" min="0" step="1" placeholder="e.g., 1000" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="total-customers-error" />
              <p id="total-customers-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a valid number.</p>
            </div>
            <div>
              <label for="retention-rate" class="block font-medium text-gray-700 mb-1">Customer Retention Rate (%)</label>
              <input type="number" id="retention-rate" name="retention-rate" min="0" max="100" step="0.1" placeholder="e.g., 85" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="retention-rate-error" />
              <p id="retention-rate-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a value between 0 and 100.</p>
            </div>
            <div>
              <label for="nps" class="block font-medium text-gray-700 mb-1">Net Promoter Score (NPS)</label>
              <input type="number" id="nps" name="nps" min="-100" max="100" step="1" placeholder="e.g., 30" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="nps-error" />
              <p id="nps-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a value between -100 and 100.</p>
            </div>
            <div>
              <label for="market-segment" class="block font-medium text-gray-700 mb-1">Primary Market Segment</label>
              <select id="market-segment" name="market-segment" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="market-segment-error">
                <option value="" disabled selected>Select Market Segment</option>
                <option value="smb">Small & Medium Businesses (SMB)</option>
                <option value="mid-market">Mid-Market</option>
                <option value="enterprise">Enterprise</option>
                <option value="consumer">Consumer</option>
                <option value="government">Government</option>
                <option value="nonprofit">Nonprofit</option>
              </select>
              <p id="market-segment-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please select a market segment.</p>
            </div>
            <div>
              <label for="buyer-type" class="block font-medium text-gray-700 mb-1">Primary Buyer Type</label>
              <select id="buyer-type" name="buyer-type" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="buyer-type-error">
                <option value="" disabled selected>Select Buyer Type</option>
                <option value="executive">C-Level Executives</option>
                <option value="manager">Managers</option>
                <option value="end-user">End Users</option>
                <option value="it">IT Departments</option>
                <option value="hr">HR Departments</option>
                <option value="finance">Finance Departments</option>
              </select>
              <p id="buyer-type-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please select a buyer type.</p>
            </div>
            <p id="customer-market-error" class="text-red-500 text-sm mt-2 hidden" role="alert">Please fill all customer and market fields correctly.</p>
            <div class="mt-4 flex justify-between">
              <button id="prev-btn-4" class="btn-secondary" type="button" aria-label="Return to previous step">Previous</button>
              <button id="next-btn-4" class="btn-primary" type="button" aria-label="Proceed to next step">Next</button>
            </div>
          </div>
          <div class="explanation-section">
            <div class="explanation-box">
              <h4>Total Active Customers</h4>
              <p><strong>What:</strong> Number of paying customers.</p>
              <p><strong>Why:</strong> Large base signals market traction.</p>
              <p><strong>Scenario:</strong> 1,000 active subscriptions.</p>
              <p><strong>Source:</strong> CRM (e.g., Salesforce).</p>
            </div>
            <div class="explanation-box">
              <h4>Customer Retention Rate</h4>
              <p><strong>What:</strong> % of customers retained yearly.</p>
              <p><strong>Why:</strong> High retention boosts valuation.</p>
              <p><strong>Scenario:</strong> 850 of 1,000 customers stay = 85%.</p>
              <p><strong>Source:</strong> Analytics (e.g., Mixpanel).</p>
            </div>
            <div class="explanation-box">
              <h4>Net Promoter Score (NPS)</h4>
              <p><strong>What:</strong> Customer satisfaction (-100 to 100).</p>
              <p><strong>Why:</strong> High NPS shows loyalty.</p>
              <p><strong>Scenario:</strong> 40% promoters, 10% detractors = 30 NPS.</p>
              <p><strong>Source:</strong> Surveys (e.g., SurveyMonkey).</p>
            </div>
            <div class="explanation-box">
              <h4>Primary Market Segment</h4>
              <p><strong>What:</strong> Main customer group.</p>
              <p><strong>Why:</strong> Defines market fit and valuation context.</p>
              <p><strong>Scenario:</strong> SMBs as primary customers.</p>
              <p><strong>Source:</strong> Sales data.</p>
            </div>
            <div class="explanation-box">
              <h4>Primary Buyer Type</h4>
              <p><strong>What:</strong> Main decision-maker for purchases.</p>
              <p><strong>Why:</strong> Buyer type affects sales cycle.</p>
              <p><strong>Scenario:</strong> Targeting C-level executives.</p>
              <p><strong>Source:</strong> Sales team insights.</p>
            </div>
          </div>
        </div>

        <!-- Step 5: Product & Technology -->
        <div id="step-5" class="step step-hidden" data-step="5">
          <h3 class="text-lg font-semibold text-gray-800 mb-4">Step 5: Product & Technology</h3>
          <p class="text-gray-600 mb-4 text-sm">
            Assess your product and tech stack.
            <span data-tooltip="Use product and engineering team insights." class="text-teal-500 underline cursor-pointer">Learn more</span>
          </p>
          <div class="space-y-3">
            <div>
              <label for="product-market-fit" class="block font-medium text-gray-700 mb-1">Product-Market Fit</label>
              <select id="product-market-fit" name="product-market-fit" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="product-market-fit-error">
                <option value="" disabled selected>Select Option</option>
                <option value="proven">Proven (High demand, retention)</option>
                <option value="developing">Developing (Some traction)</option>
                <option value="early">Early Stage (Testing fit)</option>
              </select>
              <p id="product-market-fit-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please select an option.</p>
            </div>
            <div>
              <label for="proprietary-tech" class="block font-medium text-gray-700 mb-1">Proprietary Technology</label>
              <select id="proprietary-tech" name="proprietary-tech" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="proprietary-tech-error">
                <option value="" disabled selected>Select Option</option>
                <option value="unique">Unique (Patented or exclusive)</option>
                <option value="some">Some (Differentiated but not exclusive)</option>
                <option value="none">None (Standard tech)</option>
              </select>
              <p id="proprietary-tech-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please select an option.</p>
            </div>
            <div>
              <label for="code-quality" class="block font-medium text-gray-700 mb-1">Code Quality</label>
              <select id="code-quality" name="code-quality" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="code-quality-error">
                <option value="" disabled selected>Select Option</option>
                <option value="high">High (Well-documented, tested)</option>
                <option value="medium">Medium (Functional, some issues)</option>
                <option value="low">Low (Legacy, technical debt)</option>
              </select>
              <p id="code-quality-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please select an option.</p>
            </div>
            <div>
              <label for="scalability" class="block font-medium text-gray-700 mb-1">Scalability</label>
              <select id="scalability" name="scalability" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="scalability-error">
                <option value="" disabled selected>Select Option</option>
                <option value="high">High (Cloud-native, auto-scaling)</option>
                <option value="medium">Medium (Scalable with effort)</option>
                <option value="low">Low (Limited by infrastructure)</option>
              </select>
              <p id="scalability-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please select an option.</p>
            </div>
            <div>
              <label for="release-frequency" class="block font-medium text-gray-700 mb-1">Release Frequency</label>
              <select id="release-frequency" name="release-frequency" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="release-frequency-error">
                <option value="" disabled selected>Select Option</option>
                <option value="frequent">Frequent (Weekly/Bi-weekly)</option>
                <option value="regular">Regular (Monthly/Quarterly)</option>
                <option value="infrequent">Infrequent (Rare updates)</option>
              </select>
              <p id="release-frequency-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please select an option.</p>
            </div>
            <div>
              <label for="security-compliance" class="block font-medium text-gray-700 mb-1">Security & Compliance</label>
              <select id="security-compliance" name="security-compliance" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="security-compliance-error">
                <option value="" disabled selected>Select Option</option>
                <option value="certified">Certified (SOC 2, GDPR, etc.)</option>
                <option value="partial">Partial (Basic measures)</option>
                <option value="none">None (No formal compliance)</option>
              </select>
              <p id="security-compliance-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please select an option.</p>
            </div>
            <p id="product-tech-error" class="text-red-500 text-sm mt-2 hidden" role="alert">Please fill all product and technology fields correctly.</p>
            <div class="mt-4 flex justify-between">
              <button id="prev-btn-5" class="btn-secondary" type="button" aria-label="Return to previous step">Previous</button>
              <button id="next-btn-5" class="btn-primary" type="button" aria-label="Proceed to next step">Next</button>
            </div>
          </div>
          <div class="explanation-section">
            <div class="explanation-box">
              <h4>Product-Market Fit</h4>
              <p><strong>What:</strong> How well your product meets market needs.</p>
              <p><strong>Why:</strong> Proven fit increases valuation.</p>
              <p><strong>Scenario:</strong> High retention = Proven fit.</p>
              <p><strong>Source:</strong> Customer feedback (e.g., surveys).</p>
            </div>
            <div class="explanation-box">
              <h4>Proprietary Technology</h4>
              <p><strong>What:</strong> Unique tech owned by your company.</p>
              <p><strong>Why:</strong> Exclusive tech adds value.</p>
              <p><strong>Scenario:</strong> Patented algorithm = Unique.</p>
              <p><strong>Source:</strong> Patent filings, tech audits.</p>
            </div>
            <div class="explanation-box">
              <h4>Code Quality</h4>
              <p><strong>What:</strong> Quality of your codebase.</p>
              <p><strong>Why:</strong> High quality reduces tech debt.</p>
              <p><strong>Scenario:</strong> Well-tested code = High.</p>
              <p><strong>Source:</strong> Engineering reports (e.g., SonarQube).</p>
            </div>
            <div class="explanation-box">
              <h4>Scalability</h4>
              <p><strong>What:</strong> Ability to handle growth.</p>
              <p><strong>Why:</strong> High scalability supports expansion.</p>
              <p><strong>Scenario:</strong> AWS auto-scaling = High.</p>
              <p><strong>Source:</strong> Infrastructure audits.</p>
            </div>
            <div class="explanation-box">
              <h4>Release Frequency</h4>
              <p><strong>What:</strong> How often you update your product.</p>
              <p><strong>Why:</strong> Frequent releases show agility.</p>
              <p><strong>Scenario:</strong> Weekly updates = Frequent.</p>
              <p><strong>Source:</strong> CI/CD logs (e.g., GitHub Actions).</p>
            </div>
            <div class="explanation-box">
              <h4>Security & Compliance</h4>
              <p><strong>What:</strong> Adherence to security standards.</p>
              <p><strong>Why:</strong> Compliance builds trust.</p>
              <p><strong>Scenario:</strong> SOC 2 certified = Certified.</p>
              <p><strong>Source:</strong> Audit reports.</p>
            </div>
          </div>
        </div>

        <!-- Step 6: Team & Operations -->
        <div id="step-6" class="step step-hidden" data-step="6">
          <h3 class="text-lg font-semibold text-gray-800 mb-4">Step 6: Team & Operations</h3>
          <p class="text-gray-600 mb-4 text-sm">
            Provide details about your team and operational efficiency.
            <span data-tooltip="Use HR and operational data." class="text-teal-500 underline cursor-pointer">Learn more</span>
          </p>
          <div class="space-y-3">
            <div>
              <label for="team-size" class="block font-medium text-gray-700 mb-1">Total Team Size</label>
              <input type="number" id="team-size" name="team-size" min="0" step="1" placeholder="e.g., 50" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="team-size-error" />
              <p id="team-size-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a valid number.</p>
            </div>
            <div>
              <label for="key-staff" class="block font-medium text-gray-700 mb-1">Key Staff Retention</label>
              <select id="key-staff" name="key-staff" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="key-staff-error">
                <option value="" disabled selected>Select Option</option>
                <option value="high">High (Stable leadership)</option>
                <option value="medium">Medium (Some turnover)</option>
                <option value="low">Low (Frequent changes)</option>
              </select>
              <p id="key-staff-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please select an option.</p>
            </div>
            <div>
              <label for="turnover-rate" class="block font-medium text-gray-700 mb-1">Employee Turnover Rate (%)</label>
              <input type="number" id="turnover-rate" name="turnover-rate" min="0" max="100" step="0.1" placeholder="e.g., 10" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="turnover-rate-error" />
              <p id="turnover-rate-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a value between 0 and 100.</p>
            </div>
            <div>
              <label for="eng-sales-ratio" class="block font-medium text-gray-700 mb-1">Engineer-to-Sales Ratio</label>
              <select id="eng-sales-ratio" name="eng-sales-ratio" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="eng-sales-ratio-error">
                <option value="" disabled selected>Select Option</option>
                <option value="high">High (More engineers)</option>
                <option value="balanced">Balanced</option>
                <option value="low">Low (More sales)</option>
              </select>
              <p id="eng-sales-ratio-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please select an option.</p>
            </div>
            <div>
              <label for="support-quality" class="block font-medium text-gray-700 mb-1">Customer Support Quality</label>
              <select id="support-quality" name="support-quality" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="support-quality-error">
                <option value="" disabled selected>Select Option</option>
                <option value="high">High (24/7, dedicated team)</option>
                <option value="medium">Medium (Standard support)</option>
                <option value="low">Low (Limited support)</option>
              </select>
              <p id="support-quality-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please select an option.</p>
            </div>
            <div>
              <label for="headcount-growth" class="block font-medium text-gray-700 mb-1">Headcount Growth (%)</label>
              <input type="number" id="headcount-growth" name="headcount-growth" min="0" step="0.1" placeholder="e.g., 20" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="headcount-growth-error" />
              <p id="headcount-growth-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a valid number.</p>
            </div>
            <p id="team-ops-error" class="text-red-500 text-sm mt-2 hidden" role="alert">Please fill all team and operations fields correctly.</p>
            <div class="mt-4 flex justify-between">
              <button id="prev-btn-6" class="btn-secondary" type="button" aria-label="Return to previous step">Previous</button>
              <button id="next-btn-6" class="btn-primary" type="button" aria-label="Proceed to next step">Next</button>
            </div>
          </div>
          <div class="explanation-section">
            <div class="explanation-box">
              <h4>Total Team Size</h4>
              <p><strong>What:</strong> Number of full-time employees.</p>
              <p><strong>Why:</strong> Large teams signal scalability.</p>
              <p><strong>Scenario:</strong> 50 employees across roles.</p>
              <p><strong>Source:</strong> HR records (e.g., BambooHR).</p>
            </div>
            <div class="explanation-box">
              <h4>Key Staff Retention</h4>
              <p><strong>What:</strong> Stability of leadership team.</p>
              <p><strong>Why:</strong> High retention builds trust.</p>
              <p><strong>Scenario:</strong> No C-level turnover = High.</p>
              <p><strong>Source:</strong> HR data.</p>
            </div>
            <div class="explanation-box">
              <h4>Employee Turnover Rate</h4>
              <p><strong>What:</strong> % of employees leaving yearly.</p>
              <p><strong>Why:</strong> Low turnover shows stability.</p>
              <p><strong>Scenario:</strong> 5 of 50 leave = 10%.</p>
              <p><strong>Source:</strong> HR metrics (e.g., Workday).</p>
            </div>
            <div class="explanation-box">
              <h4>Engineer-to-Sales Ratio</h4>
              <p><strong>What:</strong> Balance of tech vs. sales staff.</p>
              <p><strong>Why:</strong> Balanced ratio optimizes growth.</p>
              <p><strong>Scenario:</strong> 20 engineers, 20 sales = Balanced.</p>
              <p><strong>Source:</strong> Org chart.</p>
            </div>
            <div class="explanation-box">
              <h4>Customer Support Quality</h4>
              <p><strong>What:</strong> Quality of customer support.</p>
              <p><strong>Why:</strong> High quality improves retention.</p>
              <p><strong>Scenario:</strong> 24/7 support team = High.</p>
              <p><strong>Source:</strong> Support metrics (e.g., Zendesk).</p>
            </div>
            <div class="explanation-box">
              <h4>Headcount Growth</h4>
              <p><strong>What:</strong> % increase in staff yearly.</p>
              <p><strong>Why:</strong> Growth shows scalability.</p>
              <p><strong>Scenario:</strong> 50 to 60 employees = 20%.</p>
              <p><strong>Source:</strong> HR planning.</p>
            </div>
          </div>
        </div>

        <!-- Step 7: Legal, Contracts & Risk -->
        <div id="step-7" class="step step-hidden" data-step="7">
          <h3 class="text-lg font-semibold text-gray-800 mb-4">Step 7: Legal, Contracts & Risk</h3>
          <p class="text-gray-600 mb-4 text-sm">
            Provide details about legal status and risks.
            <span data-tooltip="Use legal and financial documents." class="text-teal-500 underline cursor-pointer">Learn more</span>
          </p>
          <div class="space-y-3">
            <div>
              <label for="legal-entity" class="block font-medium text-gray-700 mb-1">Legal Entity Type</label>
              <select id="legal-entity" name="legal-entity" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="legal-entity-error">
                <option value="" disabled selected>Select Option</option>
                <option value="corporation">Corporation (C-Corp, S-Corp)</option>
                <option value="llc">LLC</option>
                <option value="partnership">Partnership</option>
                <option value="sole">Sole Proprietorship</option>
              </select>
              <p id="legal-entity-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please select an option.</p>
            </div>
            <div>
              <label for="ip-ownership" class="block font-medium text-gray-700 mb-1">Intellectual Property Ownership</label>
              <select id="ip-ownership" name="ip-ownership" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="ip-ownership-error">
                <option value="" disabled selected>Select Option</option>
                <option value="full">Full (Patents, trademarks owned)</option>
                <option value="partial">Partial (Some IP licensed)</option>
                <option value="none">None (No formal IP)</option>
              </select>
              <p id="ip-ownership-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please select an option.</p>
            </div>
            <div>
              <label for="contract-length" class="block font-medium text-gray-700 mb-1">Average Contract Length</label>
              <select id="contract-length" name="contract-length" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="contract-length-error">
                <option value="" disabled selected>Select Option</option>
                <option value="long">Long-term (12+ months)</option>
                <option value="medium">Medium-term (6-12 months)</option>
                <option value="short">Short-term (<6 months)</option>
              </select>
              <p id="contract-length-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please select an option.</p>
            </div>
            <div>
              <label for="vendor-lock" class="block font-medium text-gray-700 mb-1">Vendor Lock-In Risk</label>
              <select id="vendor-lock" name="vendor-lock" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="vendor-lock-error">
                <option value="" disabled selected>Select Option</option>
                <option value="low">Low (Multiple vendors)</option>
                <option value="medium">Medium (Some dependency)</option>
                <option value="high">High (Single vendor)</option>
              </select>
              <p id="vendor-lock-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please select an option.</p>
            </div>
            <div>
              <label for="legal-issues" class="block font-medium text-gray-700 mb-1">Pending Legal Issues</label>
              <select id="legal-issues" name="legal-issues" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="legal-issues-error">
                <option value="" disabled selected>Select Option</option>
                <option value="none">None</option>
                <option value="minor">Minor (Non-material)</option>
                <option value="major">Major (Material impact)</option>
              </select>
              <p id="legal-issues-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please select an option.</p>
            </div>
            <div>
              <label for="privacy-compliance" class="block font-medium text-gray-700 mb-1">Privacy Compliance</label>
              <select id="privacy-compliance" name="privacy-compliance" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="privacy-compliance-error">
                <option value="" disabled selected>Select Option</option>
                <option value="full">Full (GDPR, CCPA compliant)</option>
                <option value="partial">Partial (In progress)</option>
                <option value="none">None (Not compliant)</option>
              </select>
              <p id="privacy-compliance-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please select an option.</p>
            </div>
            <div>
              <label for="insurance" class="block font-medium text-gray-700 mb-1">Insurance Coverage</label>
              <select id="insurance" name="insurance" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="insurance-error">
                <option value="" disabled selected>Select Option</option>
                <option value="comprehensive">Comprehensive (Full coverage)</option>
                <option value="basic">Basic (Limited coverage)</option>
                <option value="none">None</option>
              </select>
              <p id="insurance-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please select an option.</p>
            </div>
            <div>
              <label for="debt" class="block font-medium text-gray-700 mb-1">Outstanding Debt ($)</label>
              <input type="number" id="debt" name="debt" min="0" step="1000" placeholder="e.g., 50000" class="w-full p-2 border rounded focus:ring focus:ring-teal-400" required aria-describedby="debt-error" />
              <p id="debt-error" class="text-red-500 text-sm mt-1 hidden" role="alert">Please enter a valid number.</p>
            </div>
            <p id="legal-risk-error" class="text-red-500 text-sm mt-2 hidden" role="alert">Please fill all legal and risk fields correctly.</p>
            <div class="mt-4 flex justify-between">
              <button id="prev-btn-7" class="btn-secondary" type="button" aria-label="Return to previous step">Previous</button>
              <button id="next-btn-7" class="btn-primary" type="button" aria-label="Submit and view results">Submit</button>
            </div>
          </div>
          <div class="explanation-section">
            <div class="explanation-box">
              <h4>Legal Entity Type</h4>
              <p><strong>What:</strong> Your businessโs legal structure.</p>
              <p><strong>Why:</strong> Affects liability and valuation.</p>
              <p><strong>Scenario:</strong> C-Corp for scalability.</p>
              <p><strong>Source:</strong> Business registration.</p>
            </div>
            <div class="explanation-box">
              <h4>Intellectual Property Ownership</h4>
              <p><strong>What:</strong> Ownership of IP assets.</p>
              <p><strong>Why:</strong> Full ownership adds value.</p>
              <p><strong>Scenario:</strong> Patented software = Full.</p>
              <p><strong>Source:</strong> Patent/trademark filings.</p>
            </div>
            <div class="explanation-box">
              <h4>Average Contract Length</h4>
              <p><strong>What:</strong> Typical customer contract duration.</p>
              <p><strong>Why:</strong> Long contracts ensure revenue.</p>
              <p><strong>Scenario:</strong> 12-month contracts = Long.</p>
              <p><strong>Source:</strong> Sales contracts.</p>
            </div>
            <div class="explanation-box">
              <h4>Vendor Lock-In Risk</h4>
              <p><strong>What:</strong> Dependency on single vendors.</p>
              <p><strong>Why:</strong> Low risk improves flexibility.</p>
              <p><strong>Scenario:</strong> Multiple cloud providers = Low.</p>
              <p><strong>Source:</strong> Vendor contracts.</p>
            </div>
            <div class="explanation-box">
              <h4>Pending Legal Issues</h4>
              <p><strong>What:</strong> Ongoing legal disputes.</p>
              <p><strong>Why:</strong> No issues reduce risk.</p>
              <p><strong>Scenario:</strong> No lawsuits = None.</p>
              <p><strong>Source:</strong> Legal counsel.</p>
            </div>
            <div class="explanation-box">
              <h4>Privacy Compliance</h4>
              <p><strong>What:</strong> Adherence to privacy laws.</p>
              <p><strong>Why:</strong> Compliance builds trust.</p>
              <p><strong>Scenario:</strong> GDPR certified = Full.</p>
              <p><strong>Source:</strong> Compliance audits.</p>
            </div>
            <div class="explanation-box">
              <h4>Insurance Coverage</h4>
              <p><strong>What:</strong> Business insurance scope.</p>
              <p><strong>Why:</strong> Comprehensive coverage reduces risk.</p>
              <p><strong>Scenario:</strong> Full liability insurance = Comprehensive.</p>
              <p><strong>Source:</strong> Insurance policies.</p>
            </div>
            <div class="explanation-box">
              <h4>Outstanding Debt</h4>
              <p><strong>What:</strong> Total debt owed.</p>
              <p><strong>Why:</strong> Low debt improves valuation.</p>
              <p><strong>Scenario:</strong> $50K loan = $50K debt.</p>
              <p><strong>Source:</strong> Financial statements.</p>
            </div>
          </div>
        </div>
      </div>
    </form>
  </div>
</section>
<!-- STEP 10/15 END: Paste this after Step 6 from Step 9 -->
  <!-- STEP 11/15 START: Results Section and Hidden Chart Canvases -->
  <!-- RESULTS SECTION -->
  <section id="results" class="py-12 bg-white hidden">
    <div class="container mx-auto px-4 max-w-3xl">
      <h2 class="text-2xl font-bold text-gray-800 mb-4 text-center">Your SaaS Valuation Results</h2>
      <p class="text-base text-gray-600 mb-6 text-center">
        Below is the valuation of your SaaS business based on the provided data.
      </p>
      <div class="bg-gray-50 p-6 rounded-lg shadow-md">
        <h3 class="text-xl font-semibold text-gray-800 mb-4">Valuation Summary</h3>
        <p id="valuation-result" class="text-lg text-gray-700 mb-4">
          Your SaaS business is valued at: <span id="valuation-amount" class="font-bold text-teal-500">$0</span>
        </p>
        <p id="valuation-details" class="text-gray-600 mb-4">
          Details will appear here once the valuation is calculated.
        </p>
        <div class="mt-6 flex justify-center">
          <button id="download-pdf" class="btn-primary" aria-label="Download valuation report as PDF">
            <i class="fas fa-download mr-2"></i> Download PDF Report
          </button>
        </div>
      </div>
    </div>
  </section>

  <!-- Hidden Chart Canvases for PDF -->
  <div class="chart-canvas">
    <canvas id="valuation-chart" width="400" height="300"></canvas>
    <canvas id="revenue-profit-chart" width="400" height="300"></canvas>
    <canvas id="growth-churn-chart" width="400" height="300"></canvas>
    <canvas id="customer-metrics-chart" width="400" height="300"></canvas>
  </div>
<!-- STEP 11/15 END: Paste this after the valuation form from Step 10 -->
<!-- STEP 12/15 START: JavaScript - Step Navigation and Validation (Steps 0โ7) -->
<script>
	// Step 1: Store Chart Instances
const charts = {
  valuation: null,
  revenueProfit: null,
  growthChurn: null,
  customerMetrics: null
};
	
// Mobile menu toggle
document.getElementById('menu-toggle').addEventListener('click', () => {
  const mobileMenu = document.getElementById('mobile-menu');
  mobileMenu.classList.toggle('hidden');
});

// Form navigation and validation
const steps = document.querySelectorAll('.step');
const progressFill = document.getElementById('progress-fill');
const currentStepDisplay = document.getElementById('current-step');
let currentStep = 0;

function updateProgress() {
  const progressPercent = ((currentStep + 1) / 8) * 100;
  progressFill.style.width = `${progressPercent}%`;
  currentStepDisplay.textContent = currentStep + 1;
}

function showStep(stepIndex) {
  steps.forEach((step, index) => {
    step.classList.toggle('step-visible', index === stepIndex);
    step.classList.toggle('step-hidden', index !== stepIndex);
  });
  currentStep = stepIndex;
  updateProgress();
}

function validateStep(stepIndex) {
  let isValid = true;
  const step = steps[stepIndex];
  const errorMessages = step.querySelectorAll('[id$="-error"]');
  errorMessages.forEach(msg => msg.classList.add('hidden'));

  if (stepIndex === 0) {
    const saasType = document.getElementById('saas-type').value;
    if (!saasType) {
      document.getElementById('saas-type-error').classList.remove('hidden');
      isValid = false;
    }
  } else if (stepIndex === 1) {
    const companyName = document.getElementById('company-name').value.trim();
    const companyWebsite = document.getElementById('company-website').value.trim();
    const companyEmail = document.getElementById('company-email').value.trim();
    const urlPattern = /^(https?:\/\/)?([\w-]+\.)+[\w-]+(\/[\w-./?%&=]*)?$/i;
    const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

    if (!companyName || companyName.length < 2) {
      document.getElementById('company-name-error').classList.remove('hidden');
      isValid = false;
    }
    if (!companyWebsite || !urlPattern.test(companyWebsite)) {
      document.getElementById('company-website-error').classList.remove('hidden');
      isValid = false;
    }
    if (!companyEmail || !emailPattern.test(companyEmail)) {
      document.getElementById('company-email-error').classList.remove('hidden');
      isValid = false;
    }
    const methods = document.querySelectorAll('input[type="checkbox"]:checked');
    if (methods.length < 1 || methods.length > 3) {
      document.getElementById('method-error').classList.remove('hidden');
      isValid = false;
    }
  } else if (stepIndex === 2) {
    const inputs = step.querySelectorAll('input[type="number"]');
    inputs.forEach(input => {
      const value = parseFloat(input.value);
      if (isNaN(value) || value < 0 || (input.id === 'gross-margin' && value > 100)) {
        document.getElementById(`${input.id}-error`).classList.remove('hidden');
        isValid = false;
      }
    });
  } else if (stepIndex === 3) {
    const inputs = step.querySelectorAll('input[type="number"]');
    inputs.forEach(input => {
      const value = parseFloat(input.value);
      if (isNaN(value) || value < 0 || ((input.id === 'customer-churn' || input.id === 'revenue-churn') && value > 100)) {
        document.getElementById(`${input.id}-error`).classList.remove('hidden');
        isValid = false;
      }
    });
  } else if (stepIndex === 4) {
    const totalCustomers = parseFloat(document.getElementById('total-customers').value);
    const retentionRate = parseFloat(document.getElementById('retention-rate').value);
    const nps = parseFloat(document.getElementById('nps').value);
    const marketSegment = document.getElementById('market-segment').value;
    const buyerType = document.getElementById('buyer-type').value;

    if (isNaN(totalCustomers) || totalCustomers < 0) {
      document.getElementById('total-customers-error').classList.remove('hidden');
      isValid = false;
    }
    if (isNaN(retentionRate) || retentionRate < 0 || retentionRate > 100) {
      document.getElementById('retention-rate-error').classList.remove('hidden');
      isValid = false;
    }
    if (isNaN(nps) || nps < -100 || nps > 100) {
      document.getElementById('nps-error').classList.remove('hidden');
      isValid = false;
    }
    if (!marketSegment) {
      document.getElementById('market-segment-error').classList.remove('hidden');
      isValid = false;
    }
    if (!buyerType) {
      document.getElementById('buyer-type-error').classList.remove('hidden');
      isValid = false;
    }
  } else if (stepIndex === 5 || stepIndex === 6 || stepIndex === 7) {
    const selects = step.querySelectorAll('select');
    const inputs = step.querySelectorAll('input[type="number"]');
    selects.forEach(select => {
      if (!select.value) {
        document.getElementById(`${select.id}-error`).classList.remove('hidden');
        isValid = false;
      }
    });
    inputs.forEach(input => {
      const value = parseFloat(input.value);
      if (isNaN(value) || value < 0) { // Simplified for Step 7 (only debt)
        document.getElementById(`${input.id}-error`).classList.remove('hidden');
        isValid = false;
      }
    });
  }

  // Show general error for Step 7 if validation fails
  if (!isValid && stepIndex === 7) {
    const generalError = document.getElementById('legal-risk-error');
    if (generalError) {
      generalError.classList.remove('hidden');
    }
  }

  console.log(`Validating Step ${stepIndex}: ${isValid ? 'Valid' : 'Invalid'}`);
  return isValid;
}

// Event listeners for navigation buttons
document.querySelectorAll('[id^="next-btn-"]').forEach(btn => {
  btn.addEventListener('click', () => {
    const stepIndex = parseInt(btn.id.split('-')[2]);
    console.log(`Next button clicked for Step ${stepIndex}`);
    if (validateStep(stepIndex)) {
      if (stepIndex < steps.length - 1) {
        console.log(`Moving to Step ${stepIndex + 1}`);
        showStep(stepIndex + 1);
      } else {
        console.log('Submitting form and showing results');
        try {
          calculateValuation();
          document.getElementById('results').classList.remove('hidden');
          document.getElementById('pro-valuation').classList.add('hidden');
          window.scrollTo(0, document.getElementById('results').offsetTop);
        } catch (error) {
          console.error('Error in form submission:', error);
        }
      }
    } else {
      console.log(`Validation failed for Step ${stepIndex}`);
    }
  });
});

document.querySelectorAll('[id^="prev-btn-"]').forEach(btn => {
  btn.addEventListener('click', () => {
    const stepIndex = parseInt(btn.id.split('-')[2]);
    console.log(`Previous button clicked for Step ${stepIndex}`);
    showStep(stepIndex - 1);
  });
});

// Initialize form
showStep(0);
</script>
<!-- STEP 12/15 END: Paste this after the hidden chart canvases from Step 11 -->
<!-- STEP 13/15 START: JavaScript - Chart Generation with Chart.js -->
<script>
// Chart generation functions
function createValuationChart(valuations) {
  try {
    const ctx = document.getElementById('valuation-chart').getContext('2d');
    if (!ctx) throw new Error('Valuation chart canvas context not found');
    if (charts.valuation) {
      charts.valuation.destroy();
    }
    charts.valuation = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: Object.keys(valuations).map(key => key.replace('Valuation', '')),
        datasets: [{
          label: 'Valuation ($)',
          data: Object.values(valuations),
          backgroundColor: ['#38b2ac', '#4a5568', '#ed8936', '#9f7aea'],
          borderColor: ['#2c8a86', '#3c4656', '#c56b1f', '#805ad5'],
          borderWidth: 1
        }]
      },
      options: {
        responsive: false,
        maintainAspectRatio: true,
        scales: {
          y: {
            beginAtZero: true,
            title: { display: true, text: 'Valuation ($)', color: '#1a202c' },
            ticks: { color: '#1a202c' },
            grid: { color: '#e2e8f0' }
          },
          x: {
            title: { display: true, text: 'Valuation Method', color: '#1a202c' },
            ticks: { color: '#1a202c' },
            grid: { display: false }
          }
        },
        plugins: {
          legend: { labels: { color: '#1a202c' } },
          title: { display: true, text: 'Valuation by Method', color: '#1a202c', font: { size: 16 } }
        }
      }
    });
    console.log('Valuation chart created successfully');
  } catch (error) {
    console.error('Error creating Valuation chart:', error);
    throw error; // Re-throw to be caught by calculateValuation
  }
}

function createRevenueProfitChart(arr, netProfit) {
  try {
    const ctx = document.getElementById('revenue-profit-chart').getContext('2d');
    if (!ctx) throw new Error('Revenue-profit chart canvas context not found');
    if (charts.revenueProfit) {
      charts.revenueProfit.destroy();
    }
    charts.revenueProfit = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: ['ARR', 'Net Profit'],
        datasets: [{
          label: 'Amount ($)',
          data: [arr, netProfit],
          backgroundColor: ['#38b2ac', '#ed8936'],
          borderColor: ['#2c8a86', '#c56b1f'],
          borderWidth: 1
        }]
      },
      options: {
        responsive: false,
        maintainAspectRatio: true,
        scales: {
          y: {
            beginAtZero: true,
            title: { display: true, text: 'Amount ($)', color: '#1a202c' },
            ticks: { color: '#1a202c' },
            grid: { color: '#e2e8f0' }
          },
          x: {
            title: { display: true, text: 'Metric', color: '#1a202c' },
            ticks: { color: '#1a202c' },
            grid: { display: false }
          }
        },
        plugins: {
          legend: { labels: { color: '#1a202c' } },
          title: { display: true, text: 'Revenue vs. Net Profit', color: '#1a202c', font: { size: 16 } }
        }
      }
    });
    console.log('Revenue-Profit chart created successfully');
  } catch (error) {
    console.error('Error creating Revenue-Profit chart:', error);
    throw error;
  }
}

function createGrowthChurnChart(yoyGrowth, momGrowth, customerChurn, revenueChurn) {
  try {
    const ctx = document.getElementById('growth-churn-chart').getContext('2d');
    if (!ctx) throw new Error('Growth-Churn chart canvas context not found');
    if (charts.growthChurn) {
      charts.growthChurn.destroy();
    }
    charts.growthChurn = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: ['YoY Growth', 'MoM Growth', 'Customer Churn', 'Revenue Churn'],
        datasets: [{
          label: 'Rate (%)',
          data: [yoyGrowth, momGrowth, customerChurn, revenueChurn],
          backgroundColor: ['#38b2ac', '#4a5568', '#ed8936', '#9f7aea'],
          borderColor: ['#2c8a86', '#3c4656', '#c56b1f', '#805ad5'],
          borderWidth: 1
        }]
      },
      options: {
        responsive: false,
        maintainAspectRatio: true,
        scales: {
          y: {
            beginAtZero: true,
            title: { display: true, text: 'Rate (%)', color: '#1a202c' },
            ticks: { color: '#1a202c' },
            grid: { color: '#e2e8f0' }
          },
          x: {
            title: { display: true, text: 'Metric', color: '#1a202c' },
            ticks: { color: '#1a202c' },
            grid: { display: false }
          }
        },
        plugins: {
          legend: { labels: { color: '#1a202c' } },
          title: { display: true, text: 'Growth vs. Churn Rates', color: '#1a202c', font: { size: 16 } }
        }
      }
    });
    console.log('Growth-Churn chart created successfully');
  } catch (error) {
    console.error('Error creating Growth-Churn chart:', error);
    throw error;
  }
}

function createCustomerMetricsChart(totalCustomers, retentionRate, nps) {
  try {
    const ctx = document.getElementById('customer-metrics-chart').getContext('2d');
    if (!ctx) throw new Error('Customer-Metrics chart canvas context not found');
    if (charts.customerMetrics) {
      charts.customerMetrics.destroy();
    }
    charts.customerMetrics = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: ['Total Customers', 'Retention Rate (%)', 'NPS'],
        datasets: [{
          label: 'Value',
          data: [totalCustomers, retentionRate, nps],
          backgroundColor: ['#38b2ac', '#ed8936', '#9f7aea'],
          borderColor: ['#2c8a86', '#c56b1f', '#805ad5'],
          borderWidth: 1
        }]
      },
      options: {
        responsive: false,
        maintainAspectRatio: true,
        scales: {
          y: {
            beginAtZero: true,
            title: { display: true, text: 'Value', color: '#1a202c' },
            ticks: { color: '#1a202c' },
            grid: { color: '#e2e8f0' }
          },
          x: {
            title: { display: true, text: 'Metric', color: '#1a202c' },
            ticks: { color: '#1a202c' },
            grid: { display: false }
          }
        },
        plugins: {
          legend: { labels: { color: '#1a202c' } },
          title: { display: true, text: 'Customer Metrics', color: '#1a202c', font: { size: 16 } }
        }
      }
    });
    console.log('Customer-Metrics chart created successfully');
  } catch (error) {
    console.error('Error creating Customer-Metrics chart:', error);
    throw error;
  }
}
</script>
<!-- STEP 13/15 END: Paste this after the step navigation JavaScript from Step 12 -->
<!-- STEP 14/15 START: JavaScript - Valuation Calculation and PDF Generation -->
<script>
function calculateValuation() {
  console.log('Starting valuation calculation...');
  try {
    // Input retrieval with validation
    const arrInput = document.getElementById('arr');
    const grossMarginInput = document.getElementById('gross-margin');
    const netProfitInput = document.getElementById('net-profit');
    const yoyGrowthInput = document.getElementById('yoy-growth');
    const momGrowthInput = document.getElementById('mom-growth');
    const customerChurnInput = document.getElementById('customer-churn');
    const revenueChurnInput = document.getElementById('revenue-churn');
    const totalCustomersInput = document.getElementById('total-customers');
    const retentionRateInput = document.getElementById('retention-rate');
    const npsInput = document.getElementById('nps');

    if (!arrInput || !grossMarginInput || !netProfitInput || !yoyGrowthInput || !momGrowthInput ||
        !customerChurnInput || !revenueChurnInput || !totalCustomersInput || !retentionRateInput || !npsInput) {
      throw new Error('One or more input fields are missing in the DOM');
    }

    const arr = parseFloat(arrInput.value) || 0;
    const grossMargin = parseFloat(grossMarginInput.value) || 0;
    const netProfit = parseFloat(netProfitInput.value) || 0;
    const yoyGrowth = parseFloat(yoyGrowthInput.value) || 0;
    const momGrowth = parseFloat(momGrowthInput.value) || 0;
    const customerChurn = parseFloat(customerChurnInput.value) || 0;
    const revenueChurn = parseFloat(revenueChurnInput.value) || 0;
    const totalCustomers = parseFloat(totalCustomersInput.value) || 0;
    const retentionRate = parseFloat(retentionRateInput.value) || 0;
    const nps = parseFloat(npsInput.value) || 0;

    console.log('Inputs retrieved:', { arr, grossMargin, netProfit, yoyGrowth, momGrowth, customerChurn, revenueChurn, totalCustomers, retentionRate, nps });

    const revenueMultiple = 5;
    const profitMultiple = 10;
    const growthAdjustment = (yoyGrowth + momGrowth) / 200;
    const churnAdjustment = (customerChurn + revenueChurn) / 200;

    const revenueValuation = arr * revenueMultiple * (1 + growthAdjustment - churnAdjustment);
    const profitValuation = netProfit * profitMultiple * (1 + growthAdjustment - churnAdjustment);
    const customerValuation = totalCustomers * 1000 * (retentionRate / 100) * (nps / 100);
    const marginAdjustedValuation = (revenueValuation + profitValuation) * (grossMargin / 100);

    const valuations = {
      'RevenueValuation': revenueValuation,
      'ProfitValuation': profitValuation,
      'CustomerValuation': customerValuation,
      'MarginAdjustedValuation': marginAdjustedValuation
    };

    console.log('Valuations calculated:', valuations);

    document.getElementById('revenue-valuation').textContent = `$${Math.round(revenueValuation).toLocaleString()}`;
    document.getElementById('profit-valuation').textContent = `$${Math.round(profitValuation).toLocaleString()}`;
    document.getElementById('customer-valuation').textContent = `$${Math.round(customerValuation).toLocaleString()}`;
    document.getElementById('margin-adjusted-valuation').textContent = `$${Math.round(marginAdjustedValuation).toLocaleString()}`;

    // Generate charts with error handling
    try {
      createValuationChart(valuations);
    } catch (error) {
      console.error('Failed to create Valuation chart, continuing...', error);
    }
    try {
      createRevenueProfitChart(arr, netProfit);
    } catch (error) {
      console.error('Failed to create Revenue-Profit chart, continuing...', error);
    }
    try {
      createGrowthChurnChart(yoyGrowth, momGrowth, customerChurn, revenueChurn);
    } catch (error) {
      console.error('Failed to create Growth-Churn chart, continuing...', error);
    }
    try {
      createCustomerMetricsChart(totalCustomers, retentionRate, nps);
    } catch (error) {
      console.error('Failed to create Customer-Metrics chart, continuing...', error);
    }

    return {
      arr,
      grossMargin,
      netProfit,
      yoyGrowth,
      momGrowth,
      customerChurn,
      revenueChurn,
      totalCustomers,
      retentionRate,
      nps,
      revenueValuation,
      profitValuation,
      customerValuation,
      marginAdjustedValuation,
      growthAdjustment,
      churnAdjustment
    };
  } catch (error) {
    console.error('Error in calculateValuation:', error);
    throw error;
  }
}

document.getElementById('download-pdf').addEventListener('click', () => {
  console.log('Download PDF button clicked');
  try {
    const calculations = calculateValuation();

    const {
      arr,
      grossMargin,
      netProfit,
      yoyGrowth,
      momGrowth,
      customerChurn,
      revenueChurn,
      totalCustomers,
      retentionRate,
      nps,
      revenueValuation,
      profitValuation,
      customerValuation,
      marginAdjustedValuation,
      growthAdjustment,
      churnAdjustment
    } = calculations;

    // Get chart images with fallback
    let valuationChart, revenueProfitChart, growthChurnChart, customerMetricsChart;
    try {
      valuationChart = document.getElementById('valuation-chart').toDataURL('image/png');
    } catch (error) {
      console.error('Failed to get Valuation chart image:', error);
      valuationChart = null;
    }
    try {
      revenueProfitChart = document.getElementById('revenue-profit-chart').toDataURL('image/png');
    } catch (error) {
      console.error('Failed to get Revenue-Profit chart image:', error);
      revenueProfitChart = null;
    }
    try {
      growthChurnChart = document.getElementById('growth-churn-chart').toDataURL('image/png');
    } catch (error) {
      console.error('Failed to get Growth-Churn chart image:', error);
      growthChurnChart = null;
    }
    try {
      customerMetricsChart = document.getElementById('customer-metrics-chart').toDataURL('image/png');
    } catch (error) {
      console.error('Failed to get Customer-Metrics chart image:', error);
      customerMetricsChart = null;
    }

    const { jsPDF } = window.jspdf;
    const doc = new jsPDF({ orientation: 'portrait', unit: 'mm', format: 'a4' });

    const pageWidth = doc.internal.pageSize.getWidth();
    const pageHeight = doc.internal.pageSize.getHeight();
    const margin = 10;
    let y = margin;

    doc.setFontSize(16);
    doc.setTextColor('#1a202c');
    doc.text('SaaS Valuation Report', pageWidth / 2, y, { align: 'center' });
    y += 10;

    doc.setFontSize(12);
    doc.text('Input Data Used for Valuation', margin, y);
    y += 5;

    const formDataTable = [
      ['Annual Recurring Revenue (ARR)', `$${parseFloat(arr).toLocaleString()}`],
      ['Gross Margin', `${grossMargin}%`],
      ['Net Profit', `$${parseFloat(netProfit).toLocaleString()}`],
      ['Year-over-Year Growth (YoY)', `${yoyGrowth}%`],
      ['Month-over-Month Growth (MoM)', `${momGrowth}%`],
      ['Customer Churn Rate', `${customerChurn}%`],
      ['Revenue Churn Rate', `${revenueChurn}%`],
      ['Total Customers', parseFloat(totalCustomers).toLocaleString()],
      ['Retention Rate', `${retentionRate}%`],
      ['Net Promoter Score (NPS)', nps]
    ];

    doc.autoTable({
      startY: y,
      head: [['Metric', 'Value']],
      body: formDataTable,
      theme: 'striped',
      headStyles: { fillColor: '#2b6cb0', textColor: '#ffffff' },
      bodyStyles: { textColor: '#1a202c' },
      alternateRowStyles: { fillColor: '#edf2f7' }
    });

    y = doc.lastAutoTable.finalY + 10;

    doc.setFontSize(12);
    doc.text('Valuation Results', margin, y);
    y += 5;

    const valuationsTable = [
      ['Revenue Valuation', `$${Math.round(revenueValuation).toLocaleString()}`],
      ['Profit Valuation', `$${Math.round(profitValuation).toLocaleString()}`],
      ['Customer Valuation', `$${Math.round(customerValuation).toLocaleString()}`],
      ['Margin-Adjusted Valuation', `$${Math.round(marginAdjustedValuation).toLocaleString()}`]
    ];

    doc.autoTable({
      startY: y,
      head: [['Valuation Type', 'Value']],
      body: valuationsTable,
      theme: 'striped',
      headStyles: { fillColor: '#2b6cb0', textColor: '#ffffff' },
      bodyStyles: { textColor: '#1a202c' },
      alternateRowStyles: { fillColor: '#edf2f7' }
    });

    y = doc.lastAutoTable.finalY + 10;

    if (y + 50 > pageHeight - margin) {
      doc.addPage();
      y = margin;
    }

    doc.setFontSize(12);
    doc.text('Why You Got This Valuation', margin, y);
    y += 5;

    doc.setFontSize(10);
    let explanationText = [
      'This valuation was calculated using four methods, adjusted based on your inputs:',
      '',
      '1. Revenue Valuation: Based on your Annual Recurring Revenue (ARR) multiplied by a revenue multiple of 5, adjusted for growth and churn rates.',
      `   - Your ARR of $${parseFloat(arr).toLocaleString()} resulted in a base valuation of $${Math.round(arr * 5).toLocaleString()}.`,
      `   - Growth Adjustment: +${(growthAdjustment * 100).toFixed(1)}% (YoY Growth: ${yoyGrowth}%, MoM Growth: ${momGrowth}%)`,
      `   - Churn Adjustment: -${(churnAdjustment * 100).toFixed(1)}% (Customer Churn: ${customerChurn}%, Revenue Churn: ${revenueChurn}%)`,
      `   - Final Revenue Valuation: $${Math.round(revenueValuation).toLocaleString()}`,
      '',
      '2. Profit Valuation: Based on your Net Profit multiplied by a profit multiple of 10, adjusted for growth and churn rates.',
      `   - Your Net Profit of $${parseFloat(netProfit).toLocaleString()} resulted in a base valuation of $${Math.round(netProfit * 10).toLocaleString()}.`,
      `   - Adjusted by the same growth and churn factors as above.`,
      `   - Final Profit Valuation: $${Math.round(profitValuation).toLocaleString()}`,
      '',
      '3. Customer Valuation: Based on Total Customers, Retention Rate, and NPS.',
      `   - Formula: Total Customers (${parseFloat(totalCustomers).toLocaleString()}) ร $1,000 ร (Retention Rate: ${retentionRate}% / 100) ร (NPS: ${nps} / 100)`,
      `   - Final Customer Valuation: $${Math.round(customerValuation).toLocaleString()}`,
      '',
      '4. Margin-Adjusted Valuation: Combines Revenue and Profit Valuations, adjusted by your Gross Margin.',
      `   - Formula: (Revenue Valuation + Profit Valuation) ร (Gross Margin: ${grossMargin}% / 100)`,
      `   - Final Margin-Adjusted Valuation: $${Math.round(marginAdjustedValuation).toLocaleString()}`,
      ''
    ];

    let insights = [];
    if (arr < 100000) {
      insights.push('โข Your ARR is relatively low. Increasing recurring revenue through new customer acquisition or upselling could significantly boost your valuation.');
    } else if (arr > 1000000) {
      insights.push('โข Your high ARR strengthens your Revenue Valuation. Continue focusing on sustainable growth to maintain this strength.');
    }

    if (grossMargin < 50) {
      insights.push('โข Your Gross Margin is below 50%. Improving operational efficiency or raising prices could increase your Margin-Adjusted Valuation.');
    } else if (grossMargin > 80) {
      insights.push('โข Your high Gross Margin positively impacts your Margin-Adjusted Valuation. This is a strong point for potential buyers.');
    }

    if (customerChurn > 10 || revenueChurn > 10) {
      insights.push('โข High churn rates (Customer Churn: ' + customerChurn + '%, Revenue Churn: ' + revenueChurn + '%) are negatively impacting your valuation. Focus on customer retention strategies to improve your score.');
    } else if (customerChurn < 5 && revenueChurn < 5) {
      insights.push('โข Low churn rates (Customer Churn: ' + customerChurn + '%, Revenue Churn: ' + revenueChurn + '%) are a strong positive factor in your valuation. This indicates good customer satisfaction and stability.');
    }

    if (yoyGrowth > 20 || momGrowth > 5) {
      insights.push('โข Strong growth rates (YoY: ' + yoyGrowth + '%, MoM: ' + momGrowth + '%) are boosting your valuation. This signals a healthy, growing business to potential buyers.');
    } else if (yoyGrowth < 10 && momGrowth < 2) {
      insights.push('โข Growth rates (YoY: ' + yoyGrowth + '%, MoM: ' + momGrowth + '%) are relatively low. Accelerating growth through marketing or product expansion could improve your valuation.');
    }

    if (retentionRate < 70) {
      insights.push('โข A Retention Rate of ' + retentionRate + '% is below average. Improving customer retention could enhance your Customer Valuation.');
    }

    if (nps < 30) {
      insights.push('โข An NPS of ' + nps + ' is below the industry benchmark. Improving customer satisfaction could increase your Customer Valuation.');
    }

    explanationText.push('Key Insights for Improving Your Valuation:');
    explanationText = explanationText.concat(insights);

    doc.text(explanationText, margin, y, { maxWidth: pageWidth - 2 * margin });
    y += (explanationText.length * 5) + 10;

    // Add charts only if they were successfully generated
    if (valuationChart) {
      if (y + 60 > pageHeight - margin) {
        doc.addPage();
        y = margin;
      }
      doc.addImage(valuationChart, 'PNG', margin, y, 90, 60);
      y += 70;
    } else {
      console.warn('Skipping Valuation chart in PDF due to rendering failure');
    }

    if (revenueProfitChart) {
      if (y + 60 > pageHeight - margin) {
        doc.addPage();
        y = margin;
      }
      doc.addImage(revenueProfitChart, 'PNG', margin, y, 90, 60);
      y += 70;
    } else {
      console.warn('Skipping Revenue-Profit chart in PDF due to rendering failure');
    }

    if (growthChurnChart) {
      if (y + 60 > pageHeight - margin) {
        doc.addPage();
        y = margin;
      }
      doc.addImage(growthChurnChart, 'PNG', margin, y, 90, 60);
      y += 70;
    } else {
      console.warn('Skipping Growth-Churn chart in PDF due to rendering failure');
    }

    if (customerMetricsChart) {
      if (y + 60 > pageHeight - margin) {
        doc.addPage();
        y = margin;
      }
      doc.addImage(customerMetricsChart, 'PNG', margin, y, 90, 60);
      y += 70;
    } else {
      console.warn('Skipping Customer-Metrics chart in PDF due to rendering failure');
    }

    doc.save('saas-valuation-report.pdf');
  } catch (error) {
    console.error('PDF generation failed:', error);
    alert('Failed to generate PDF. Please check the console for details or try again.');
  }
});
</script>
<!-- STEP 14/15 END: Paste this after the chart generation JavaScript from Step 13 -->
  <!-- STEP 15/15 START: Testimonials, CTA, Footer, and Closing Tags -->
  <!-- TESTIMONIALS SECTION -->
  <section id="testimonials" class="py-12 bg-gray-50">
    <div class="container mx-auto px-4">
      <h2 class="text-2xl font-bold text-gray-800 mb-8 text-center">What Our Users Say</h2>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <div class="bg-white p-6 rounded-lg shadow-md">
          <p class="text-gray-600 italic mb-4">"SaaSVal gave us a clear valuation that helped secure our Series A funding!"</p>
          <p class="font-semibold text-gray-800">Jane Doe</p>
          <p class="text-sm text-gray-500">CEO, TechTrend</p>
        </div>
        <div class="bg-white p-6 rounded-lg shadow-md">
          <p class="text-gray-600 italic mb-4">"The detailed report and charts were a game-changer for our investor pitch."</p>
          <p class="font-semibold text-gray-800">John Smith</p>
          <p class="text-sm text-gray-500">Founder, CloudCore</p>
        </div>
        <div class="bg-white p-6 rounded-lg shadow-md">
          <p class="text-gray-600 italic mb-4">"Easy to use and incredibly insightful. Highly recommend SaaSVal!"</p>
          <p class="font-semibold text-gray-800">Emily Chen</p>
          <p class="text-sm text-gray-500">COO, DataPeak</p>
        </div>
      </div>
    </div>
  </section>

  <!-- CALL-TO-ACTION SECTION -->
  <section class="py-12 bg-teal-500 text-white">
    <div class="container mx-auto px-4 text-center">
      <h2 class="text-2xl font-bold mb-4">Ready to Take the Next Step?</h2>
      <p class="text-base mb-6 max-w-xl mx-auto">
        Share your valuation with investors or contact us for a deeper analysis.
      </p>
      <div class="flex justify-center space-x-4">
        <a href="mailto:support@saasval.com" class="btn-primary bg-white text-teal-500 hover:bg-gray-100" aria-label="Contact us">
          Contact Us
        </a>
        <a href="https://x.com/intent/tweet?text=I%20just%20valued%20my%20SaaS%20business%20with%20SaaSVal!%20Check%20it%20out%20at%20saasval.com" 
           target="_blank" 
           class="btn-primary bg-white text-teal-500 hover:bg-gray-100" 
           aria-label="Share on X">
          Share on X
        </a>
      </div>
    </div>
  </section>

  <!-- FOOTER -->
  <footer class="bg-gray-800 text-white py-8">
    <div class="container mx-auto px-4">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
        <div>
          <h3 class="text-lg font-semibold mb-4">SaaSVal</h3>
          <p class="text-sm text-gray-400">
            Empowering SaaS founders with accurate valuations and actionable insights.
          </p>
        </div>
        <div>
          <h3 class="text-lg font-semibold mb-4">Quick Links</h3>
          <ul class="space-y-2">
            <li><a href="index.html">Home</a></li>
			   <li><a href="blog.html">Resources</a></li>
            <li><a href="#how-it-works" class="text-sm text-gray-400 hover:text-white">How It Works</a></li>
           
          </ul>
        </div>
        <div>
          <h3 class="text-lg font-semibold mb-4">Connect</h3>
          <ul class="space-y-2">
            <li><a href="https://linkedin.com/company/saasval" target="_blank" class="text-sm text-gray-400 hover:text-white">LinkedIn</a></li>
            <li><a href="mailto:support@saasval.com" class="text-sm text-gray-400 hover:text-white">Email</a></li>
          </ul>
        </div>
      </div>
      <div class="mt-8 text-center text-sm text-gray-400">
        <p>&copy; 2025 SaaSVal. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <!-- CLOSE BODY AND HTML -->
</body>
</html>
<!-- STEP 15/15 END: Paste this after the PDF generation JavaScript from Step 14 -->
  
