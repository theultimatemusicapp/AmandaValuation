<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Valuation360 | How to Value Your SaaS Business in 15 Minutes</title>
    <meta name="description" content="Discover how to value your SaaS business with Valuation360's free tool. Learn where to value your SaaS business and find out how much your business is worth in just 15 minutes.">
    <meta name="keywords" content="how to value my SaaS business, where to value my SaaS business, how much is my business worth, SaaS valuation tool, business valuation calculator, SaaS business worth">
    <meta name="author" content="Valuation360">
    <meta name="robots" content="index, follow">
    <meta property="og:title" content="Valuation360 | How to Value Your SaaS Business">
    <meta property="og:description" content="Use Valuation360's free SaaS valuation tool to find out how much your business is worth in 15 minutes. Accurate, fast, and easy.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.valuation360.com/">
    <meta property="og:image" content="https://www.valuation360.com/images/valuation-dashboard.jpg">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Valuation360 | Value Your SaaS Business">
    <meta name="twitter:description" content="Find out how to value your SaaS business with our free, fast, and accurate valuation tool.">
    <meta name="twitter:image" content="https://www.valuation360.com/images/valuation-dashboard.jpg">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="canonical" href="https://www.valuation360.com/">
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "name": "Valuation360",
        "url": "https://www.valuation360.com/",
        "description": "Free SaaS business valuation tool to determine how much your business is worth in 15 minutes.",
        "potentialAction": {
            "@type": "SearchAction",
            "target": "https://www.valuation360.com/?s={search_term_string}",
            "query-input": "required name=search_term_string"
        }
    }
    </script>
    <style>
        body {
            font-family: 'Poppins', sans-serif;
        }
        .gradient-bg {
            background: linear-gradient(135deg, #2D3748 0%, #38B2AC 100%);
        }
        .nav-link:hover {
            color: #38B2AC;
        }
        .btn-primary {
            background-color: #38B2AC;
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            background-color: #2D3748;
            transform: translateY(-2px);
        }
        .btn-secondary {
            border: 2px solid #38B2AC;
            color: #38B2AC;
            transition: all 0.3s ease;
        }
        .btn-secondary:hover {
            background-color: #38B2AC;
            color: white;
        }
    </style>
</head>
<body class="bg-white">
    <!-- Navigation -->
    <nav class="bg-white shadow-md py-4 sticky top-0 z-50">
        <div class="container mx-auto px-6 flex justify-between items-center">
            <div class="flex items-center">
                <a href="index.html" class="text-2xl font-bold text-gray-800">Valuation<span class="text-teal-500">360</span></a>
            </div>
            <div class="hidden md:flex space-x-8">
                <a href="index.html#valuation" class="nav-link text-gray-600 hover:text-teal-500 font-medium">Self Valuation</a>
                <a href="pro.html#tech-due-diligence" class="nav-link text-gray-600 hover:text-teal-500 font-medium">Tech Due Diligence</a>
                <a href="pro.html#data-room" class="nav-link text-gray-600 hover:text-teal-500 font-medium">AI Data Room</a>
                <a href="pro.html#pricing" class="nav-link text-gray-600 hover:text-teal-500 font-medium">Pricing</a>
                <a href="resources.html" class="nav-link text-gray-600 hover:text-teal-500 font-medium">Resources</a>
                <a href="faq.html" class="nav-link text-gray-600 hover:text-teal-500 font-medium">FAQ</a>
            </div>
            <div class="md:hidden">
                <button id="menu-toggle" class="text-gray-600 focus:outline-none" aria-label="Toggle mobile menu">
                    <i class="fas fa-bars text-xl"></i>
                </button>
            </div>
        </div>
        <div id="mobile-menu" class="hidden md:hidden bg-white px-6 pt-2 pb-4">
            <a href="index.html#valuation" class="block py-2 text-gray-600 hover:text-teal-500">Self Valuation</a>
            <a href="pro.html#tech-due-diligence" class="block py-2 text-gray-600 hover:text-teal-500">Tech Due Diligence</a>
            <a href="pro.html#data-room" class="block py-2 text-gray-600 hover:text-teal-500">AI Data Room</a>
            <a href="pro.html#pricing" class="block py-2 text-gray-600 hover:text-teal-500">Pricing</a>
            <a href="resources.html" class="block py-2 text-gray-600 hover:text-teal-500">Resources</a>
            <a href="faq.html" class="block py-2 text-gray-600 hover:text-teal-500">FAQ</a>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="gradient-bg text-white py-20">
        <div class="container mx-auto px-6 flex flex-col md:flex-row items-center">
            <div class="md:w-1/2 mb-10 md:mb-0">
                <h1 class="text-4xl md:text-5xl font-bold mb-4">How Much Is Your SaaS Business Worth?</h1>
                <h2 class="text-2xl md:text-3xl font-semibold mb-6">Find Out in 15 Minutes</h2>
                <p class="text-lg mb-8 opacity-90">Use Valuation360's free tool to learn how to value your SaaS business. Get accurate insights and discover where to value your business with our easy-to-use calculator.</p>
                <div class="flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4">
                    <a href="index.html#valuation" class="btn-primary text-white font-bold py-3 px-8 rounded-lg text-center">Get Started Now</a>
                    <a href="#demo" class="btn-secondary font-bold py-3 px-8 rounded-lg text-center flex items-center justify-center" aria-label="Watch demo video">
                        <i class="fas fa-play-circle mr-2"></i> Watch Demo
                    </a>
                </div>
            </div>
            <div class="md:w-1/2 relative">
                <div class="relative">
                    <div class="absolute inset-0 bg-teal-500 rounded-xl opacity-20 blur-lg"></div>
                    <div class="relative bg-white bg-opacity-10 backdrop-filter backdrop-blur-lg rounded-xl p-6 border border-white border-opacity-20">
                        <div class="flex justify-between items-center mb-4">
                            <div class="flex items-center">
                                <div class="w-3 h-3 rounded-full bg-red-500 mr-2"></div>
                                <div class="w-3 h-3 rounded-full bg-yellow-500 mr-2"></div>
                                <div class="w-3 h-3 rounded-full bg-green-500"></div>
                            </div>
                            <span class="text-sm font-medium">Valuation Dashboard</span>
                        </div>
                        <div class="bg-white bg-opacity-5 rounded-lg p-4 mb-4">
                            <div class="flex justify-between mb-2">
                                <span class="text-sm">Estimated Value Range</span>
                                <span class="text-sm font-bold">$1.2M - $1.8M</span>
                            </div>
                            <div class="w-full bg-gray-700 rounded-full h-2.5">
                                <div class="bg-teal-400 h-2.5 rounded-full" style="width: 70%"></div>
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-4 mb-4">
                            <div class="bg-white bg-opacity-5 rounded-lg p-4">
                                <p class="text-xs opacity-70 mb-1">Revenue Growth</p>
                                <p class="text-lg font-bold">32%</p>
                                <div class="flex items-center mt-1">
                                    <i class="fas fa-arrow-up text-green-400 mr-1 text-xs"></i>
                                    <span class="text-xs">+8% from last year</span>
                                </div>
                            </div>
                            <div class="bg-white bg-opacity-5 rounded-lg p-4">
                                <p class="text-xs opacity-70 mb-1">Profit Margin</p>
                                <p class="text-lg font-bold">18%</p>
                                <div class="flex items-center mt-1">
                                    <i class="fas fa-arrow-up text-green-400 mr-1 text-xs"></i>
                                    <span class="text-xs">+3% from last year</span>
                                </div>
                            </div>
                        </div>
                        <div class="bg-teal-500 bg-opacity-20 rounded-lg p-3 text-center">
                            <p class="text-sm font-medium">Your Business is in the <span class="font-bold">Top 30%</span> of SaaS Companies</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script>
        // Mobile menu toggle
        document.getElementById('menu-toggle').addEventListener('click', () => {
            const mobileMenu = document.getElementById('mobile-menu');
            mobileMenu.classList.toggle('hidden');
        });
    </script>
    <!-- Self Valuation Tool (Steps 1-3) -->
<section id="valuation" class="py-16 bg-gray-50">
    <div class="container mx-auto px-6">
        <div class="text-center mb-12">
            <h2 class="text-3xl font-bold text-gray-800 mb-4">How to Value Your SaaS Business</h2>
            <p class="text-lg text-gray-600 max-w-2xl mx-auto">Use our free SaaS valuation tool to find out how much your business is worth in 15 minutes. Get accurate insights and actionable recommendations.</p>
        </div>

        <div class="bg-white rounded-xl shadow-lg overflow-hidden max-w-6xl mx-auto">
            <!-- Progress Bar -->
            <div class="p-6 border-b border-gray-200">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-xl font-semibold text-gray-800">Step <span id="current-step">1</span> of 6</h3>
                    <button id="start-over" class="text-teal-500 hover:text-teal-600 font-medium flex items-center" aria-label="Start over">
                        <i class="fas fa-redo-alt mr-2"></i> Start Over
                    </button>
                </div>
                <div class="progress-bar">
                    <div id="progress-fill" class="progress-fill" style="width: 16.67%"></div>
                </div>
            </div>

            <!-- Valuation Form -->
            <div id="valuation-form" class="p-6">
                <!-- Step 1: Valuation Method Selection -->
                <div id="step-1" class="step step-visible">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                        <i class="fas fa-calculator mr-2 text-teal-500"></i> Valuation Method Selection
                    </h3>
                    <div class="mb-4">
                        <label for="valuationMethod" class="block text-sm font-medium text-gray-700 mb-1">Select Valuation Methods (Choose up to 3):</label>
                        <div class="space-y-2">
                            <div class="flex items-center">
                                <input type="checkbox" id="method-multiplier" value="multiplier" class="mr-2 input-highlight" aria-describedby="method-multiplier-desc">
                                <label for="method-multiplier" class="text-sm text-gray-700">Multiplier Method - Based on industry multipliers.</label>
                            </div>
                            <div class="flex items-center">
                                <input type="checkbox" id="method-income" value="income" class="mr-2 input-highlight" aria-describedby="method-income-desc">
                                <label for="method-income" class="text-sm text-gray-700">Income-Based Valuation - Focuses on total revenue.</label>
                            </div>
                            <div class="flex items-center">
                                <input type="checkbox" id="method-earnings" value="earnings" class="mr-2 input-highlight" aria-describedby="method-earnings-desc">
                                <label for="method-earnings" class="text-sm text-gray-700">Earnings-Based Valuation - Focuses on net profit.</label>
                            </div>
                            <div class="flex items-center">
                                <input type="checkbox" id="method-dcf" value="dcf" class="mr-2 input-highlight" aria-describedby="method-dcf-desc">
                                <label for="method-dcf" class="text-sm text-gray-700">Discounted Cash Flow (DCF) - Based on future cash flows.</label>
                            </div>
                        </div>
                        <p class="mt-1 text-sm text-gray-500" id="method-multiplier-desc">Select methods to compare multiple valuation approaches for your SaaS business.</p>
                        <p id="method-error" class="error-message">Please select 1 to 3 valuation methods.</p>
                    </div>
                    <div class="flex justify-end">
                        <button id="next-btn-1" class="btn-primary text-white font-bold py-2 px-6 rounded-lg" aria-label="Next step">
                            Next <i class="fas fa-arrow-right ml-2"></i>
                        </button>
                    </div>
                </div>

                <!-- Step 2: Business Fundamentals -->
                <div id="step-2" class="step step-hidden">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                        <i class="fas fa-list-alt mr-2 text-teal-500"></i> Business Fundamentals
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="ownerSalary" class="block text-sm font-medium text-gray-700 mb-1">Owner Salary ($):</label>
                            <div class="relative rounded-md shadow-sm">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <span class="text-gray-500 sm:text-sm">$</span>
                                </div>
                                <input type="text" id="ownerSalary" placeholder="80,000.00" required class="input-highlight block w-full pl-7 pr-12 sm:text-sm border-gray-300 rounded-md" aria-describedby="ownerSalary-desc">
                            </div>
                            <p class="mt-1 text-sm text-gray-500" id="ownerSalary-desc">Enter your annual salary as the owner.</p>
                            <p id="ownerSalary-error" class="error-message">Please enter a valid number.</p>
                        </div>
                        <div>
                            <label for="averageSalary" class="block text-sm font-medium text-gray-700 mb-1">Average Staff Salary ($):</label>
                            <div class="relative rounded-md shadow-sm">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <span class="text-gray-500 sm:text-sm">$</span>
                                </div>
                                <input type="text" id="averageSalary" placeholder="50,000.00" required class="input-highlight block w-full pl-7 pr-12 sm:text-sm border-gray-300 rounded-md" aria-describedby="averageSalary-desc">
                            </div>
                            <p class="mt-1 text-sm text-gray-500" id="averageSalary-desc">Average annual salary of your staff members.</p>
                            <p id="averageSalary-error" class="error-message">Please enter a valid number.</p>
                        </div>
                        <div>
                            <label for="employeeBenefits" class="block text-sm font-medium text-gray-700 mb-1">Employee Benefits & Equity ($):</label>
                            <div class="relative rounded-md shadow-sm">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <span class="text-gray-500 sm:text-sm">$</span>
                                </div>
                                <input type="text" id="employeeBenefits" placeholder="10,000.00" class="input-highlight block w-full pl-7 pr-12 sm:text-sm border-gray-300 rounded-md" aria-describedby="employeeBenefits-desc">
                            </div>
                            <p class="mt-1 text-sm text-gray-500" id="employeeBenefits-desc">Include costs like stock options or bonuses.</p>
                            <p id="employeeBenefits-error" class="error-message">Please enter a valid number.</p>
                        </div>
                        <div>
                            <label for="staffNumber" class="block text-sm font-medium text-gray-700 mb-1">Number of Staff:</label>
                            <input type="number" id="staffNumber" placeholder="10" min="0" required class="input-highlight block w-full sm:text-sm border-gray-300 rounded-md" aria-describedby="staffNumber-desc">
                            <p class="mt-1 text-sm text-gray-500" id="staffNumber-desc">Total number of staff employed.</p>
                            <p id="staffNumber-error" class="error-message">Please enter a valid number.</p>
                        </div>
                        <div>
                            <label for="expenses" class="block text-sm font-medium text-gray-700 mb-1">Annual Operating Expenses ($):</label>
                            <div class="relative rounded-md shadow-sm">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <span class="text-gray-500 sm:text-sm">$</span>
                                </div>
                                <input type="text" id="expenses" placeholder="50,000.00" required class="input-highlight block w-full pl-7 pr-12 sm:text-sm border-gray-300 rounded-md" aria-describedby="expenses-desc">
                            </div>
                            <p class="mt-1 text-sm text-gray-500" id="expenses-desc">Exclude salaries, benefits, and debt repayments.</p>
                            <p id="expenses-error" class="error-message">Please enter a valid number.</p>
                        </div>
                        <div>
                            <label for="debt" class="block text-sm font-medium text-gray-700 mb-1">Total Debt ($):</label>
                            <div class="relative rounded-md shadow-sm">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <span class="text-gray-500 sm:text-sm">$</span>
                                </div>
                                <input type="text" id="debt" placeholder="20,000.00" required class="input-highlight block w-full pl-7 pr-12 sm:text-sm border-gray-300 rounded-md" aria-describedby="debt-desc">
                            </div>
                            <p class="mt-1 text-sm text-gray-500" id="debt-desc">Total outstanding debts or liabilities.</p>
                            <p id="debt-error" class="error-message">Please enter a valid number.</p>
                        </div>
                    </div>
                    <div class="flex justify-between mt-6">
                        <button id="prev-btn-2" class="btn-secondary font-bold py-2 px-6 rounded-lg" aria-label="Previous step">
                            <i class="fas fa-arrow-left mr-2"></i> Previous
                        </button>
                        <button id="next-btn-2" class="btn-primary text-white font-bold py-2 px-6 rounded-lg" aria-label="Next step">
                            Next <i class="fas fa-arrow-right ml-2"></i>
                        </button>
                    </div>
                </div>

                <!-- Step 3: Customer Metrics -->
                <div id="step-3" class="step step-hidden">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                        <i class="fas fa-users mr-2 text-teal-500"></i> Customer Metrics
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="ltv" class="block text-sm font-medium text-gray-700 mb-1">Customer Lifetime Value (LTV) ($):</label>
                            <div class="relative rounded-md shadow-sm">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <span class="text-gray-500 sm:text-sm">$</span>
                                </div>
                                <input type="text" id="ltv" placeholder="1,000.00" required class="input-highlight block w-full pl-7 pr-12 sm:text-sm border-gray-300 rounded-md" aria-describedby="ltv-desc">
                            </div>
                            <p class="mt-1 text-sm text-gray-500" id="ltv-desc">Average revenue per customer over their lifetime.</p>
                            <p id="ltv-error" class="error-message">Please enter a valid number.</p>
                        </div>
                        <div>
                            <label for="cac" class="block text-sm font-medium text-gray-700 mb-1">Customer Acquisition Cost (CAC) ($):</label>
                            <div class="relative rounded-md shadow-sm">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <span class="text-gray-500 sm:text-sm">$</span>
                                </div>
                                <input type="text" id="cac" placeholder="200.00" required class="input-highlight block w-full pl-7 pr-12 sm:text-sm border-gray-300 rounded-md" aria-describedby="cac-desc">
                            </div>
                            <p class="mt-1 text-sm text-gray-500" id="cac-desc">Average cost to acquire a new customer.</p>
                            <p id="cac-error" class="error-message">Please enter a valid number.</p>
                        </div>
                        <div>
                            <label for="churnRate" class="block text-sm font-medium text-gray-700 mb-1">Churn Rate (%):</label>
                            <div class="relative rounded-md shadow-sm">
                                <input type="text" id="churnRate" placeholder="5.00" required class="input-highlight block w-full sm:text-sm border-gray-300 rounded-md" aria-describedby="churnRate-desc">
                                <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                                    <span class="text-gray-500 sm:text-sm">%</span>
                                </div>
                            </div>
                            <p class="mt-1 text-sm text-gray-500" id="churnRate-desc">Percentage of customers lost annually.</p>
                            <p id="churnRate-error" class="error-message">Please enter a valid percentage.</p>
                        </div>
                        <div>
                            <label for="customerGrowthRate" class="block text-sm font-medium text-gray-700 mb-1">Customer Growth Rate (%):</label>
                            <div class="relative rounded-md shadow-sm">
                                <input type="text" id="customerGrowthRate" placeholder="10.00" required class="input-highlight block w-full sm:text-sm border-gray-300 rounded-md" aria-describedby="customerGrowthRate-desc">
                                <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                                    <span class="text-gray-500 sm:text-sm">%</span>
                                </div>
                            </div>
                            <p class="mt-1 text-sm text-gray-500" id="customerGrowthRate-desc">Annual growth rate of your customer base.</p>
                            <p id="customerGrowthRate-error" class="error-message">Please enter a valid percentage.</p>
                        </div>
                    </div>
                    <div class="flex justify-between mt-6">
                        <button id="prev-btn-3" class="btn-secondary font-bold py-2 px-6 rounded-lg" aria-label="Previous step">
                            <i class="fas fa-arrow-left mr-2"></i> Previous
                        </button>
                        <button id="next-btn-3" class="btn-primary text-white font-bold py-2 px-6 rounded-lg" aria-label="Next step">
                            Next <i class="fas fa-arrow-right ml-2"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
    // Form navigation
    let currentStep = 1;
    const totalSteps = 6;
    const steps = document.querySelectorAll('.step');
    const progressFill = document.getElementById('progress-fill');
    const currentStepDisplay = document.getElementById('current-step');

    function updateProgress() {
        const progress = (currentStep / totalSteps) * 100;
        progressFill.style.width = `${progress}%`;
        currentStepDisplay.textContent = currentStep;
    }

    function showStep(stepNumber) {
        steps.forEach((step, index) => {
            step.classList.toggle('step-visible', index + 1 === stepNumber);
            step.classList.toggle('step-hidden', index + 1 !== stepNumber);
        });
        updateProgress();
    }

    function validateStep(stepNumber) {
        let isValid = true;
        if (stepNumber === 1) {
            const checkboxes = document.querySelectorAll('input[type="checkbox"]:checked');
            if (checkboxes.length < 1 || checkboxes.length > 3) {
                document.getElementById('method-error').style.display = 'block';
                isValid = false;
            } else {
                document.getElementById('method-error').style.display = 'none';
            }
        } else if (stepNumber === 2) {
            const fields = ['ownerSalary', 'averageSalary', 'employeeBenefits', 'staffNumber', 'expenses', 'debt'];
            fields.forEach(field => {
                const input = document.getElementById(field);
                const error = document.getElementById(`${field}-error`);
                const value = input.value.trim();
                if (!value || isNaN(value.replace(/,/g, '')) || parseFloat(value.replace(/,/g, '')) < 0) {
                    error.style.display = 'block';
                    isValid = false;
                } else {
                    error.style.display = 'none';
                }
            });
        } else if (stepNumber === 3) {
            const fields = ['ltv', 'cac', 'churnRate', 'customerGrowthRate'];
            fields.forEach(field => {
                const input = document.getElementById(field);
                const error = document.getElementById(`${field}-error`);
                const value = input.value.trim();
                if (!value || isNaN(value.replace(/,/g, '')) || parseFloat(value.replace(/,/g, '')) < 0) {
                    error.style.display = 'block';
                    isValid = false;
                } else {
                    error.style.display = 'none';
                }
            });
        }
        return isValid;
    }

    document.getElementById('next-btn-1').addEventListener('click', () => {
        if (validateStep(1)) {
            currentStep = 2;
            showStep(currentStep);
        }
    });

    document.getElementById('next-btn-2').addEventListener('click', () => {
        if (validateStep(2)) {
            currentStep = 3;
            showStep(currentStep);
        }
    });

    document.getElementById('next-btn-3').addEventListener('click', () => {
        if (validateStep(3)) {
            alert('Steps 1-3 completed! Part 3 will include the remaining steps, results, and footer.');
        }
    });

    document.getElementById('prev-btn-2').addEventListener('click', () => {
        currentStep = 1;
        showStep(currentStep);
    });

    document.getElementById('prev-btn-3').addEventListener('click', () => {
        currentStep = 2;
        showStep(currentStep);
    });

    document.getElementById('start-over').addEventListener('click', () => {
        currentStep = 1;
        showStep(currentStep);
        document.querySelectorAll('input').forEach(input => input.value = '');
        document.querySelectorAll('.error-message').forEach(error => error.style.display = 'none');
    });

    // Debounce input to prevent freezing
    function debounce(func, wait) {
        let timeout;
        return function executedFunction(...args) {
            const later = () => {
                clearTimeout(timeout);
                func(...args);
            };
            clearTimeout(timeout);
            timeout = setTimeout(later, wait);
        };
    }

    document.querySelectorAll('input').forEach(input => {
        input.addEventListener('input', debounce(() => {
            validateStep(currentStep);
        }, 300));
    });
</script>

<style>
    .progress-bar {
        height: 10px;
        border-radius: 5px;
        background-color: #E2E8F0;
    }
    .progress-fill {
        height: 100%;
        border-radius: 5px;
        background-color: #38B2AC;
        transition: width 0.5s ease;
    }
    .input-highlight {
        transition: all 0.3s ease;
    }
    .input-highlight:focus {
        box-shadow: 0 0 0 3px rgba(56, 178, 172, 0.3);
        border-color: #38B2AC;
    }
    .step {
        transition: opacity 0.5s ease, transform 0.5s ease;
    }
    .step-hidden {
        opacity: 0;
        transform: translateX(20px);
        display: none;
    }
    .step-visible {
        opacity: 1;
        transform: translateX(0);
        display: block;
    }
    .error-message {
        color: #e53e3e;
        font-size: 0.75rem;
        margin-top: 0.25rem;
        display: none;
    }
</style>
<!-- Valuation Tool (Steps 4-6, Results, Charts) -->
<!-- Step 4: Market and Industry Factors -->
<div id="step-4" class="step step-hidden">
    <h3 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
        <i class="fas fa-industry mr-2 text-teal-500"></i> Market and Industry Factors
    </h3>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
            <label for="industry" class="block text-sm font-medium text-gray-700 mb-1">Select Industry:</label>
            <select id="industry" class="input-highlight block w-full pl-3 pr-10 py-2 text-base border-gray-300 rounded-md" required aria-describedby="industry-desc">
                <option value="">--Select Industry--</option>
                <option value="Technology">Technology</option>
                <option value="Retail">Retail</option>
                <option value="Hospitality">Hospitality</option>
                <option value="Media">Media</option>
                <option value="Marketing">Marketing</option>
                <option value="Healthcare">Healthcare</option>
                <option value="Finance">Finance</option>
            </select>
            <p class="mt-1 text-sm text-gray-500" id="industry-desc">Choose your industry for accurate SaaS valuation.</p>
            <p id="industry-error" class="error-message">Please select an industry.</p>
        </div>
        <div>
            <label for="marketTrendImpact" class="block text-sm font-medium text-gray-700 mb-1">Market Trend Impact (1-10):</label>
            <div class="flex items-center">
                <input type="range" id="marketTrendImpact" min="1" max="10" value="5" step="1" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer" oninput="document.getElementById('marketTrendImpactValue').textContent = this.value" aria-describedby="marketTrendImpact-desc">
                <span id="marketTrendImpactValue" class="ml-3 text-sm font-medium text-gray-700">5</span>
            </div>
            <p class="mt-1 text-sm text-gray-500" id="marketTrendImpact-desc">Rate the impact of market trends (1 = Negative, 10 = Positive).</p>
        </div>
        <div>
            <label for="competitivePositioning" class="block text-sm font-medium text-gray-700 mb-1">Competitive Positioning (1-10):</label>
            <div class="flex items-center">
                <input type="range" id="competitivePositioning" min="1" max="10" value="5" step="1" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer" oninput="document.getElementById('competitivePositioningValue').textContent = this.value" aria-describedby="competitivePositioning-desc">
                <span id="competitivePositioningValue" class="ml-3 text-sm font-medium text-gray-700">5</span>
            </div>
            <p class="mt-1 text-sm text-gray-500" id="competitivePositioning-desc">Rate your market position (1 = Weak, 10 = Dominant).</p>
        </div>
        <div>
            <label for="marketVolatility" class="block text-sm font-medium text-gray-700 mb-1">Market Volatility (1-10):</label>
            <div class="flex items-center">
                <input type="range" id="marketVolatility" min="1" max="10" value="5" step="1" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer" oninput="document.getElementById('marketVolatilityValue').textContent = this.value" aria-describedby="marketVolatility-desc">
                <span id="marketVolatilityValue" class="ml-3 text-sm font-medium text-gray-700">5</span>
            </div>
            <p class="mt-1 text-sm text-gray-500" id="marketVolatility-desc">Rate market stability (1 = Volatile, 10 = Stable).</p>
        </div>
    </div>
    <div class="flex justify-between mt-6">
        <button id="prev-btn-4" class="btn-secondary font-bold py-2 px-6 rounded-lg" aria-label="Previous step">
            <i class="fas fa-arrow-left mr-2"></i> Previous
        </button>
        <button id="next-btn-4" class="btn-primary text-white font-bold py-2 px-6 rounded-lg" aria-label="Next step">
            Next <i class="fas fa-arrow-right ml-2"></i>
        </button>
    </div>
</div>

<!-- Step 5: Advanced Inputs -->
<div id="step-5" class="step step-hidden">
    <h3 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
        <i class="fas fa-cogs mr-2 text-teal-500"></i> Advanced Inputs
    </h3>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
            <label for="aiReplaceable" class="block text-sm font-medium text-gray-700 mb-1">Can Staff be Replaced by AI?</label>
            <select id="aiReplaceable" onchange="toggleAIReplacement()" required class="input-highlight block w-full pl-3 pr-10 py-2 text-base border-gray-300 rounded-md" aria-describedby="aiReplaceable-desc">
                <option value="">--Select--</option>
                <option value="yes">Yes</option>
                <option value="no">No</option>
            </select>
            <p class="mt-1 text-sm text-gray-500" id="aiReplaceable-desc">Select 'Yes' if some roles can be automated.</p>
            <p id="aiReplaceable-error" class="error-message">Please select an option.</p>
        </div>
        <div id="aiReplaceCountSection" class="hidden">
            <label for="aiReplaceCount" class="block text-sm font-medium text-gray-700 mb-1">Number of Staff Replaceable by AI:</label>
            <input type="number" id="aiReplaceCount" placeholder="2" min="0" class="input-highlight block w-full sm:text-sm border-gray-300 rounded-md" aria-describedby="aiReplaceCount-desc">
            <p class="mt-1 text-sm text-gray-500" id="aiReplaceCount-desc">Number of positions that could be automated.</p>
            <p id="aiReplaceCount-error" class="error-message">Please enter a valid number.</p>
        </div>
        <div>
            <label for="hasIP" class="block text-sm font-medium text-gray-700 mb-1">Do You Have Intellectual Property (IP)?</label>
            <select id="hasIP" onchange="toggleIPFields()" required class="input-highlight block w-full pl-3 pr-10 py-2 text-base border-gray-300 rounded-md" aria-describedby="hasIP-desc">
                <option value="">--Select--</option>
                <option value="yes">Yes</option>
                <option value="no">No</option>
            </select>
            <p class="mt-1 text-sm text-gray-500" id="hasIP-desc">Select 'Yes' if you own patents or trademarks.</p>
            <p id="hasIP-error" class="error-message">Please select an option.</p>
        </div>
        <div id="ipValueSection" class="hidden">
            <label for="ipValue" class="block text-sm font-medium text-gray-700 mb-1">IP Value ($):</label>
            <div class="relative rounded-md shadow-sm">
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                    <span class="text-gray-500 sm:text-sm">$</span>
                </div>
                <input type="text" id="ipValue" placeholder="50,000.00" class="input-highlight block w-full pl-7 pr-12 sm:text-sm border-gray-300 rounded-md" aria-describedby="ipValue-desc">
            </div>
            <p class="mt-1 text-sm text-gray-500" id="ipValue-desc">Estimated value of your IP assets.</p>
            <p id="ipValue-error" class="error-message">Please enter a valid number.</p>
        </div>
    </div>
    <div class="flex justify-between mt-6">
        <button id="prev-btn-5" class="btn-secondary font-bold py-2 px-6 rounded-lg" aria-label="Previous step">
            <i class="fas fa-arrow-left mr-2"></i> Previous
        </button>
        <button id="next-btn-5" class="btn-primary text-white font-bold py-2 px-6 rounded-lg" aria-label="Next step">
            Next <i class="fas fa-arrow-right ml-2"></i>
        </button>
    </div>
</div>

<!-- Step 6: Future Projections -->
<div id="step-6" class="step step-hidden">
    <h3 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
        <i class="fas fa-chart-line mr-2 text-teal-500"></i> Future Projections
    </h3>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
            <label for="projectedRevenue" class="block text-sm font-medium text-gray-700 mb-1">Projected Revenue Next Year ($):</label>
            <div class="relative rounded-md shadow-sm">
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                    <span class="text-gray-500 sm:text-sm">$</span>
                </div>
                <input type="text" id="projectedRevenue" placeholder="150,000.00" required class="input-highlight block w-full pl-7 pr-12 sm:text-sm border-gray-300 rounded-md" aria-describedby="projectedRevenue-desc">
            </div>
            <p class="mt-1 text-sm text-gray-500" id="projectedRevenue-desc">Expected revenue for the next fiscal year.</p>
            <p id="projectedRevenue-error" class="error-message">Please enter a valid number.</p>
        </div>
        <div>
            <label for="expectedGrowthRate" class="block text-sm font-medium text-gray-700 mb-1">Expected Annual Growth Rate (%):</label>
            <div class="relative rounded-md shadow-sm">
                <input type="text" id="expectedGrowthRate" placeholder="10.00" required class="input-highlight block w-full sm:text-sm border-gray-300 rounded-md" aria-describedby="expectedGrowthRate-desc">
                <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                    <span class="text-gray-500 sm:text-sm">%</span>
                </div>
            </div>
            <p class="mt-1 text-sm text-gray-500" id="expectedGrowthRate-desc">Anticipated revenue growth rate.</p>
            <p id="expectedGrowthRate-error" class="error-message">Please enter a valid percentage.</p>
        </div>
        <div id="dcfFields" class="col-span-2 hidden">
            <h4 class="text-lg font-semibold text-gray-800 mb-4">Discounted Cash Flow (DCF) Inputs</h4>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label for="cashFlow1" class="block text-sm font-medium text-gray-700 mb-1">Year 1 Cash Flow ($):</label>
                    <div class="relative rounded-md shadow-sm">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <span class="text-gray-500 sm:text-sm">$</span>
                        </div>
                        <input type="text" id="cashFlow1" placeholder="50,000.00" class="input-highlight block w-full pl-7 pr-12 sm:text-sm border-gray-300 rounded-md" aria-describedby="cashFlow1-desc">
                    </div>
                    <p id="cashFlow1-error" class="error-message">Please enter a valid number.</p>
                </div>
                <div>
                    <label for="cashFlow2" class="block text-sm font-medium text-gray-700 mb-1">Year 2 Cash Flow ($):</label>
                    <div class="relative rounded-md shadow-sm">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <span class="text-gray-500 sm:text-sm">$</span>
                        </div>
                        <input type="text" id="cashFlow2" placeholder="55,000.00" class="input-highlight block w-full pl-7 pr-12 sm:text-sm border-gray-300 rounded-md" aria-describedby="cashFlow2-desc">
                    </div>
                    <p id="cashFlow2-error" class="error-message">Please enter a valid number.</p>
                </div>
                <div>
                    <label for="cashFlow3" class="block text-sm font-medium text-gray-700 mb-1">Year 3 Cash Flow ($):</label>
                    <div class="relative rounded-md shadow-sm">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <span class="text-gray-500 sm:text-sm">$</span>
                        </div>
                        <input type="text" id="cashFlow3" placeholder="60,000.00" class="input-highlight block w-full pl-7 pr-12 sm:text-sm border-gray-300 rounded-md" aria-describedby="cashFlow3-desc">
                    </div>
                    <p id="cashFlow3-error" class="error-message">Please enter a valid number.</p>
                </div>
                <div>
                    <label for="discountRate" class="block text-sm font-medium text-gray-700 mb-1">Discount Rate (%):</label>
                    <div class="relative rounded-md shadow-sm">
                        <input type="text" id="discountRate" placeholder="10.00" class="input-highlight block w-full sm:text-sm border-gray-300 rounded-md" aria-describedby="discountRate-desc">
                        <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                            <span class="text-gray-500 sm:text-sm">%</span>
                        </div>
                    </div>
                    <p id="discountRate-error" class="error-message">Please enter a valid percentage.</p>
                </div>
            </div>
        </div>
    </div>
    <div class="flex justify-between mt-6">
        <button id="prev-btn-6" class="btn-secondary font-bold py-2 px-6 rounded-lg" aria-label="Previous step">
            <i class="fas fa-arrow-left mr-2"></i> Previous
        </button>
        <button onclick="calculateValuation()" class="btn-primary text-white font-bold py-2 px-6 rounded-lg" aria-label="Calculate valuation">
            Calculate Valuation <i class="fas fa-calculator ml-2"></i>
        </button>
    </div>
</div>

<!-- Result Display -->
<div class="mt-8 bg-white rounded-xl shadow-lg overflow-hidden hidden" id="valuationResult">
    <div class="p-6">
        <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">Your SaaS Business Valuation</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
            <div class="bg-teal-50 p-4 rounded-lg">
                <h3 class="text-lg font-semibold text-teal-800 mb-2">Key Financial Metrics</h3>
                <div id="financialMetrics" class="space-y-2"></div>
            </div>
            <div class="bg-green-50 p-4 rounded-lg">
                <h3 class="text-lg font-semibold text-green-800 mb-2">Valuation Ranges</h3>
                <div id="valuationRanges" class="space-y-2"></div>
            </div>
        </div>
        <div class="bg-yellow-50 p-4 rounded-lg mb-8">
            <h3 class="text-lg font-semibold text-yellow-800 mb-2">Final Valuation</h3>
            <div id="finalValuation" class="text-center">
                <p class="text-3xl font-bold text-gray-800" id="valuationAmount"></p>
                <p class="text-sm text-gray-600 mt-2">Based on selected methods</p>
            </div>
        </div>
        <div class="flex justify-center mt-6 gap-4">
            <button onclick="exportResults()" class="btn-primary text-white font-bold py-2 px-6 rounded-lg" aria-label="Export results">
                <i class="fas fa-file-export mr-2"></i> Export Results
            </button>
            <button onclick="saveProgress()" class="btn-secondary font-bold py-2 px-6 rounded-lg" aria-label="Save progress">
                <i class="fas fa-save mr-2"></i> Save Progress
            </button>
        </div>
    </div>
</div>

<!-- Charts Display -->
<div class="mt-8 bg-white rounded-xl shadow-lg overflow-hidden hidden" id="chartsSection">
    <div class="p-6">
        <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">Valuation Analysis Charts</h2>
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <div class="bg-white p-4 rounded-lg border border-gray-200">
                <h3 class="text-lg font-semibold text-gray-800 mb-4">Valuation Comparison</h3>
                <div class="chart-container">
                    <canvas id="valuationChart"></canvas>
                </div>
            </div>
            <div class="bg-white p-4 rounded-lg border border-gray-200">
                <h3 class="text-lg font-semibold text-gray-800 mb-4">Revenue vs. Expenses</h3>
                <div class="chart-container">
                    <canvas id="incomeChart"></canvas>
                </div>
            </div>
        </div>
    </div>
</div>
</div>
</div>
</section>

<!-- Footer -->
<footer class="bg-gray-800 text-white py-12">
    <div class="container mx-auto px-6">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
            <div>
                <h3 class="text-xl font-bold mb-4">Valuation360</h3>
                <p class="text-gray-400">Discover how much your SaaS business is worth with our free valuation tool in just 15 minutes.</p>
            </div>
            <div>
                <h3 class="text-xl font-bold mb-4">Quick Links</h3>
                <ul class="space-y-2">
                    <li><a href="index.html#valuation" class="text-gray-400 hover:text-teal-400">Self Valuation</a></li>
                    <li><a href="pro.html#tech-due-diligence" class="text-gray-400 hover:text-teal-400">Tech Due Diligence</a></li>
                    <li><a href="pro.html#data-room" class="text-gray-400 hover:text-teal-400">AI Data Room</a></li>
                    <li><a href="pro.html#pricing" class="text-gray-400 hover:text-teal-400">Pricing</a></li>
                </ul>
            </div>
            <div>
                <h3 class="text-xl font-bold mb-4">Resources</h3>
                <ul class="space-y-2">
                    <li><a href="resources.html" class="text-gray-400 hover:text-teal-400">Guides & Articles</a></li>
                    <li><a href="faq.html" class="text-gray-400 hover:text-teal-400">FAQ</a></li>
                </ul>
            </div>
            <div>
                <h3 class="text-xl font-bold mb-4">Legal</h3>
                <ul class="space-y-2">
                    <li><a href="privacy-policy.html" class="text-gray-400 hover:text-teal-400">Privacy Policy</a></li>
                    <li><a href="terms-and-conditions.html" class="text-gray-400 hover:text-teal-400">Terms & Conditions</a></li>
                </ul>
            </div>
        </div>
        <div class="mt-8 border-t border-gray-700 pt-6 text-center">
            <p class="text-gray-400">&copy; 2025 Valuation360. All rights reserved.</p>
        </div>
    </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
// Update Part 2's next-btn-3 to navigate to step 4
document.getElementById('next-btn-3').removeEventListener('click', () => {});
document.getElementById('next-btn-3').addEventListener('click', () => {
    if (validateStep(3)) {
        currentStep = 4;
        showStep(currentStep);
    }
});

// Form navigation for steps 4-6
document.getElementById('next-btn-4').addEventListener('click', () => {
    if (validateStep(4)) {
        currentStep = 5;
        showStep(currentStep);
    }
});

document.getElementById('next-btn-5').addEventListener('click', () => {
    if (validateStep(5)) {
        currentStep = 6;
        showStep(currentStep);
        if (document.getElementById('method-dcf').checked) {
            document.getElementById('dcfFields').classList.remove('hidden');
        } else {
            document.getElementById('dcfFields').classList.add('hidden');
        }
    }
});

document.getElementById('prev-btn-4').addEventListener('click', () => {
    currentStep = 3;
    showStep(currentStep);
});

document.getElementById('prev-btn-5').addEventListener('click', () => {
    currentStep = 4;
    showStep(currentStep);
});

document.getElementById('prev-btn-6').addEventListener('click', () => {
    currentStep = 5;
    showStep(currentStep);
});

// Validation for steps 4-6
function validateStep(stepNumber) {
    let isValid = true;
    if (stepNumber === 4) {
        const industry = document.getElementById('industry').value;
        if (!industry) {
            document.getElementById('industry-error').style.display = 'block';
            isValid = false;
        } else {
            document.getElementById('industry-error').style.display = 'none';
        }
    } else if (stepNumber === 5) {
        const fields = ['aiReplaceable', 'hasIP'];
        fields.forEach(field => {
            const input = document.getElementById(field);
            const error = document.getElementById(`${field}-error`);
            if (!input.value) {
                error.style.display = 'block';
                isValid = false;
            } else {
                error.style.display = 'none';
            }
        });
        if (document.getElementById('aiReplaceable').value === 'yes') {
            const aiReplaceCount = document.getElementById('aiReplaceCount').value;
            if (!aiReplaceCount || isNaN(aiReplaceCount) || parseInt(aiReplaceCount) < 0) {
                document.getElementById('aiReplaceCount-error').style.display = 'block';
                isValid = false;
            } else {
                document.getElementById('aiReplaceCount-error').style.display = 'none';
            }
        }
        if (document.getElementById('hasIP').value === 'yes') {
            const ipValue = document.getElementById('ipValue').value;
            if (!ipValue || isNaN(ipValue.replace(/,/g, '')) || parseFloat(ipValue.replace(/,/g, '')) < 0) {
                document.getElementById('ipValue-error').style.display = 'block';
                isValid = false;
            } else {
                document.getElementById('ipValue-error').style.display = 'none';
            }
        }
    } else if (stepNumber === 6) {
        const fields = ['projectedRevenue', 'expectedGrowthRate'];
        fields.forEach(field => {
            const input = document.getElementById(field);
            const error = document.getElementById(`${field}-error`);
            const value = input.value.trim();
            if (!value || isNaN(value.replace(/,/g, '')) || parseFloat(value.replace(/,/g, '')) < 0) {
                error.style.display = 'block';
                isValid = false;
            } else {
                error.style.display = 'none';
            }
        });
        if (document.getElementById('method-dcf').checked) {
            const dcfFields = ['cashFlow1', 'cashFlow2', 'cashFlow3', 'discountRate'];
            dcfFields.forEach(field => {
                const input = document.getElementById(field);
                const error = document.getElementById(`${field}-error`);
                const value = input.value.trim();
                if (!value || isNaN(value.replace(/,/g, '')) || parseFloat(value.replace(/,/g, '')) < 0) {
                    error.style.display = 'block';
                    isValid = false;
                } else {
                    error.style.display = 'none';
                }
            });
        }
    }
    return isValid;
}

// Conditional field toggles
function toggleAIReplacement() {
    const aiReplaceable = document.getElementById('aiReplaceable').value;
    document.getElementById('aiReplaceCountSection').classList.toggle('hidden', aiReplaceable !== 'yes');
}

function toggleIPFields() {
    const hasIP = document.getElementById('hasIP').value;
    document.getElementById('ipValueSection').classList.toggle('hidden', hasIP !== 'yes');
}

// Valuation calculation
function calculateValuation() {
    if (!validateStep(6)) return;

    const methods = Array.from(document.querySelectorAll('input[type="checkbox"]:checked')).map(cb => cb.value);
    const inputs = {
        ownerSalary: parseFloat(document.getElementById('ownerSalary').value.replace(/,/g, '')) || 0,
        averageSalary: parseFloat(document.getElementById('averageSalary').value.replace(/,/g, '')) || 0,
        employeeBenefits: parseFloat(document.getElementById('employeeBenefits').value.replace(/,/g, '')) || 0,
        staffNumber: parseInt(document.getElementById('staffNumber').value) || 0,
        expenses: parseFloat(document.getElementById('expenses').value.replace(/,/g, '')) || 0,
        debt: parseFloat(document.getElementById('debt').value.replace(/,/g, '')) || 0,
        ltv: parseFloat(document.getElementById('ltv').value.replace(/,/g, '')) || 0,
        cac: parseFloat(document.getElementById('cac').value.replace(/,/g, '')) || 0,
        churnRate: parseFloat(document.getElementById('churnRate').value.replace(/,/g, '')) || 0,
        customerGrowthRate: parseFloat(document.getElementById('customerGrowthRate').value.replace(/,/g, '')) || 0,
        industry: document.getElementById('industry').value,
        marketTrendImpact: parseInt(document.getElementById('marketTrendImpact').value),
        competitivePositioning: parseInt(document.getElementById('competitivePositioning').value),
        marketVolatility: parseInt(document.getElementById('marketVolatility').value),
        aiReplaceable: document.getElementById('aiReplaceable').value,
        aiReplaceCount: parseInt(document.getElementById('aiReplaceCount').value) || 0,
        hasIP: document.getElementById('hasIP').value,
        ipValue: parseFloat(document.getElementById('ipValue').value.replace(/,/g, '')) || 0,
        projectedRevenue: parseFloat(document.getElementById('projectedRevenue').value.replace(/,/g, '')) || 0,
        expectedGrowthRate: parseFloat(document.getElementById('expectedGrowthRate').value.replace(/,/g, '')) || 0,
        cashFlow1: parseFloat(document.getElementById('cashFlow1').value.replace(/,/g, '')) || 0,
        cashFlow2: parseFloat(document.getElementById('cashFlow2').value.replace(/,/g, '')) || 0,
        cashFlow3: parseFloat(document.getElementById('cashFlow3').value.replace(/,/g, '')) || 0,
        discountRate: parseFloat(document.getElementById('discountRate').value.replace(/,/g, '')) || 0
    };

    const valuations = {};
    let finalValuation = 0;

    // Multiplier Method (Revenue-based)
    if (methods.includes('multiplier')) {
        const industryMultipliers = { Technology: 5, Retail: 2, Hospitality: 1.5, Media: 3, Marketing: 2.5, Healthcare: 4, Finance: 3.5 };
        const multiplier = industryMultipliers[inputs.industry] || 3;
        const revenue = inputs.projectedRevenue;
        valuations.multiplier = revenue * multiplier * (inputs.marketTrendImpact / 10) * (inputs.competitivePositioning / 10);
    }

    // Income-Based Valuation
    if (methods.includes('income')) {
        const revenue = inputs.projectedRevenue;
        const expenses = inputs.expenses + (inputs.averageSalary * inputs.staffNumber) + inputs.employeeBenefits;
        valuations.income = revenue - expenses - inputs.debt;
        if (inputs.hasIP === 'yes') valuations.income += inputs.ipValue * 0.5;
    }

    // Earnings-Based Valuation
    if (methods.includes('earnings')) {
        const netProfit = inputs.projectedRevenue - inputs.expenses - (inputs.averageSalary * inputs.staffNumber) - inputs.employeeBenefits;
        valuations.earnings = netProfit * 10 * (inputs.marketVolatility / 10);
    }

    // DCF Valuation
    if (methods.includes('dcf')) {
        const discountRate = inputs.discountRate / 100;
        const cf1 = inputs.cashFlow1 / Math.pow(1 + discountRate, 1);
        const cf2 = inputs.cashFlow2 / Math.pow(1 + discountRate, 2);
        const cf3 = inputs.cashFlow3 / Math.pow(1 + discountRate, 3);
        valuations.dcf = cf1 + cf2 + cf3;
    }

    // Average valuation
    const validValuations = Object.values(valuations).filter(v => v > 0);
    finalValuation = validValuations.length ? validValuations.reduce((a, b) => a + b, 0) / validValuations.length : 0;

    // Display results
    const financialMetrics = document.getElementById('financialMetrics');
    financialMetrics.innerHTML = `
        <p>LTV/CAC Ratio: ${(inputs.ltv / inputs.cac).toFixed(2)}</p>
        <p>Churn Rate: ${inputs.churnRate}%</p>
        <p>Projected Revenue: $${inputs.projectedRevenue.toLocaleString()}</p>
        <p>Total Expenses: $${inputs.expenses.toLocaleString()}</p>
    `;

    const valuationRanges = document.getElementById('valuationRanges');
    valuationRanges.innerHTML = Object.entries(valuations).map(([method, value]) => 
        `<p>${method.charAt(0).toUpperCase() + method.slice(1)}: $${Math.round(value).toLocaleString()}</p>`
    ).join('');

    document.getElementById('valuationAmount').textContent = `$${Math.round(finalValuation).toLocaleString()}`;
    document.getElementById('valuationResult').classList.remove('hidden');
    document.getElementById('chartsSection').classList.remove('hidden');

    // Charts
    const valuationCtx = document.getElementById('valuationChart').getContext('2d');
    new Chart(valuationCtx, {
        type: 'bar',
        data: {
            labels: Object.keys(valuations),
            datasets: [{
                label: 'Valuation ($)',
                data: Object.values(valuations),
                backgroundColor: 'rgba(56, 178, 172, 0.6)',
                borderColor: 'rgba(56, 178, 172, 1)',
                borderWidth: 1
            }]
        },
        options: { scales: { y: { beginAtZero: true } } }
    });

    const incomeCtx = document.getElementById('incomeChart').getContext('2d');
    new Chart(incomeCtx, {
        type: 'bar',
        data: {
            labels: ['Revenue', 'Expenses'],
            datasets: [{
                label: 'Amount ($)',
                data: [inputs.projectedRevenue, inputs.expenses],
                backgroundColor: ['rgba(56, 178, 172, 0.6)', 'rgba(255, 99, 132, 0.6)'],
                borderColor: ['rgba(56, 178, 172, 1)', 'rgba(255, 99, 132, 1)'],
                borderWidth: 1
            }]
        },
        options: { scales: { y: { beginAtZero: true } } }
    });
}

// Export results as PDF
function exportResults() {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    doc.text('SaaS Business Valuation Report', 10, 10);
    doc.text(`Final Valuation: ${document.getElementById('valuationAmount').textContent}`, 10, 20);
    doc.text('Key Financial Metrics:', 10, 30);
    doc.text(document.getElementById('financialMetrics').innerText, 10, 40);
    doc.text('Valuation Ranges:', 10, 60);
    doc.text(document.getElementById('valuationRanges').innerText, 10, 70);
    doc.save('valuation_report.pdf');
}

// Save progress
function saveProgress() {
    const inputs = {};
    document.querySelectorAll('input, select').forEach(input => {
        inputs[input.id] = input.type === 'checkbox' ? input.checked : input.value;
    });
    localStorage.setItem('valuationProgress', JSON.stringify(inputs));
    alert('Progress saved!');
}

// Load saved progress
window.addEventListener('load', () => {
    const saved = localStorage.getItem('valuationProgress');
    if (saved) {
        const inputs = JSON.parse(saved);
        Object.entries(inputs).forEach(([id, value]) => {
            const input = document.getElementById(id);
            if (input) {
                if (input.type === 'checkbox') input.checked = value;
                else input.value = value;
            }
        });
    }
});

// Debounce for steps 4-6
document.querySelectorAll('input, select').forEach(input => {
    input.addEventListener('input', debounce(() => {
        validateStep(currentStep);
    }, 300));
});

</script>

<style>
    .chart-container {
        height: 300px;
        width: 100%;
    }
    @media (max-width: 768px) {
        .chart-container {
            height: 250px;
        }
    }
</style>

</body>
</html>
