<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Amanda Valuation Pro offers advanced business valuation with AI insights, scenario planning, and investor-ready reports.">
    <title>Amanda Valuation Pro | Precision Business Valuation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/shepherd.js@11.2.0/dist/js/shepherd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/shepherd.js@11.2.0/dist/css/shepherd.css">
    <style>
        :root {
            --primary: #38B2AC;
            --secondary: #2D3748;
            --gray: #6B7280;
            --light: #F3F4F6;
            --error: #E53E3E;
            --success: #065F46;
        }
        [data-theme="dark"] {
            --primary: #4FD1C5;
            --secondary: #1F2937;
            --gray: #9CA3AF;
            --light: #374151;
            --error: #F87171;
            --success: #34D399;
        }
        body {
            font-family: 'Poppins', sans-serif;
            background: #FFFFFF;
            transition: background 0.3s ease, color 0.3s ease;
        }
        [data-theme="dark"] body {
            background: var(--secondary);
            color: var(--gray);
        }
        .gradient-bg {
            background: linear-gradient(135deg, var(--secondary) 0%, var(--primary) 100%);
            position: relative;
            overflow: hidden;
        }
        .parallax-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200" opacity="0.1"><circle cx="100" cy="100" r="80" fill="none" stroke="%23FFFFFF" stroke-width="20"/></svg>') repeat;
            transform: translateZ(0);
        }
        .nav-link {
            position: relative;
            transition: color 0.3s ease;
        }
        .nav-link:hover {
            color: var(--primary);
        }
        .nav-link::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--primary);
            transition: width 0.3s ease;
        }
        .nav-link:hover::after {
            width: 100%;
        }
        .btn-primary {
            background: var(--primary);
            color: white;
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            background: var(--secondary);
            transform: scale(1.05);
        }
        .btn-secondary {
            border: 2px solid var(--primary);
            color: var(--primary);
            transition: all 0.3s ease;
        }
        .btn-secondary:hover {
            background: var(--primary);
            color: white;
            transform: scale(1.05);
        }
        .progress-bar {
            height: 12px;
            border-radius: 6px;
            background: var(--light);
        }
        .progress-fill {
            height: 100%;
            border-radius: 6px;
            background: var(--primary);
            transition: width 0.5s ease;
        }
        .input-highlight {
            transition: all 0.3s ease;
        }
        .input-highlight:focus {
            box-shadow: 0 0 0 3px rgba(56, 178, 172, 0.3);
            border-color: var(--primary);
        }
        .step {
            transition: opacity 0.5s ease, transform 0.5s ease;
        }
        .step-hidden {
            opacity: 0;
            transform: translateY(20px);
            display: none;
        }
        .step-visible {
            opacity: 1;
            transform: translateY(0);
            display: block;
        }
        .chart-container {
            height: 320px;
            width: 100%;
        }
        .error-message {
            color: var(--error);
            font-size: 0.75rem;
            margin-top: 0.25rem;
            display: none;
        }
        .feedback-message {
            font-size: 0.75rem;
            margin-top: 0.25rem;
            display: none;
        }
        .feedback-success {
            color: var(--success);
        }
        .feedback-error {
            color: var(--error);
        }
        .interactive-panel {
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .interactive-panel:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }
        .tooltip-icon {
            cursor: pointer;
            color: var(--primary);
            transition: color 0.2s ease, transform 0.2s ease;
        }
        .tooltip-icon:hover {
            color: var(--secondary);
            transform: scale(1.2);
        }
        .tooltip {
            display: none;
            position: absolute;
            background: var(--primary);
            color: white;
            padding: 1rem;
            border-radius: 0.5rem;
            max-width: 320px;
            z-index: 1000;
            font-size: 0.9rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            opacity: 0;
            transform: translateY(10px);
            transition: opacity 0.3s ease, transform 0.3s ease;
        }
        .tooltip.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }
        @media (min-width: 768px) {
            .tooltip {
                top: 0;
                left: 100%;
                margin-left: 1.5rem;
            }
        }
        @media (max-width: 767px) {
            .tooltip {
                top: 100%;
                left: 0;
                margin-top: 1rem;
                max-width: 90%;
            }
        }
        .step-nav {
            display: flex;
            overflow-x: auto;
            padding: 0.75rem 0;
            white-space: nowrap;
            scrollbar-width: thin;
            scrollbar-color: var(--primary) var(--light);
        }
        .step-nav::-webkit-scrollbar {
            height: 8px;
        }
        .step-nav::-webkit-scrollbar-track {
            background: var(--light);
        }
        .step-nav::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }
        .step-nav-item {
            position: relative;
            padding: 0.75rem 1.25rem;
            border-radius: 0.5rem;
            color: var(--gray);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.95rem;
            display: flex;
            align-items: center;
        }
        .step-nav-item.active {
            background: var(--primary);
            color: white;
        }
        .step-nav-item.completed {
            background: #D1FAE5;
            color: var(--success);
        }
        .step-nav-item:hover:not(.active) {
            background: var(--light);
        }
        .step-nav-item.completed::after {
            content: '\f058';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            margin-left: 0.5rem;
            color: var(--success);
            animation: bounce 0.5s ease;
        }
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
        .currency-selector {
            appearance: none;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="10" height="6"><path fill="%236B7280" d="M0 0h10L5 6z"/></svg>') no-repeat right 0.75rem center;
            background-size: 10px;
            padding-right: 2rem;
        }
        .theme-toggle {
            width: 40px;
            height: 20px;
            background: var(--gray);
            border-radius: 9999px;
            position: relative;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        .theme-toggle::before {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 16px;
            height: 16px;
            background: white;
            border-radius: 50%;
            transition: transform 0.3s ease;
        }
        .theme-toggle.active {
            background: var(--primary);
        }
        .theme-toggle.active::before {
            transform: translateX(20px);
        }
        @media (max-width: 768px) {
            .chart-container {
                height: 280px;
            }
            .step-nav-item {
                font-size: 0.85rem;
                padding: 0.5rem 1rem;
            }
            .hero-content {
                transform: translateY(0) !important;
            }
        }
    </style>
</head>
<body class="bg-white" data-theme="light">
    <!-- Navigation -->
    <nav class="bg-white shadow-lg py-4 sticky top-0 z-50 transition-all duration-300">
        <div class="container mx-auto px-6 flex justify-between items-center">
            <div class="flex items-center space-x-4">
                <a href="index.html" class="text-2xl font-bold text-gray-800">Amanda<span class="text-[var(--primary)]">Valuation</span></a>
            </div>
            <div class="hidden md:flex items-center space-x-8">
                <a href="index.html#self-valuation" class="nav-link text-gray-600 font-medium">Self Valuation</a>
                <a href="index.html#tech-due-diligence" class="nav-link text-gray-600 font-medium">Tech Due Diligence</a>
                <a href="index.html#pricing" class="nav-link text-gray-600 font-medium">Pricing</a>
                <a href="index.html#resources" class="nav-link text-gray-600 font-medium">Resources</a>
                <div class="flex items-center space-x-4">
                    <select id="currency-selector" class="currency-selector text-sm border-gray-300 rounded-md focus:ring-[var(--primary)] focus:border-[var(--primary)]" aria-label="Select currency">
                        <option value="USD">USD</option>
                        <option value="AUD">AUD</option>
                        <option value="EUR">EUR</option>
                    </select>
                    <div id="theme-toggle" class="theme-toggle" role="button" aria-label="Toggle dark mode" tabindex="0"></div>
                </div>
            </div>
            <div class="md:hidden">
                <button id="menu-toggle" class="text-gray-600 focus:outline-none" aria-label="Toggle mobile menu">
                    <i class="fas fa-bars text-xl"></i>
                </button>
            </div>
        </div>
        <div id="mobile-menu" class="hidden md:hidden bg-white px-6 pt-2 pb-4">
            <a href="index.html#self-valuation" class="block py-2 text-gray-600 hover:text-[var(--primary)]">Self Valuation</a>
            <a href="index.html#tech-due-diligence" class="block py-2 text-gray-600 hover:text-[var(--primary)]">Tech Due Diligence</a>
            <a href="index.html#pricing" class="block py-2 text-gray-600 hover:text-[var(--primary)]">Pricing</a>
            <a href="index.html#resources" class="block py-2 text-gray-600 hover:text-[var(--primary)]">Resources</a>
            <div class="flex items-center space-x-4 mt-4">
                <select id="mobile-currency-selector" class="currency-selector text-sm border-gray-300 rounded-md focus:ring-[var(--primary)] focus:border-[var(--primary)]" aria-label="Select currency">
                    <option value="USD">USD</option>
                    <option value="AUD">AUD</option>
                    <option value="EUR">EUR</option>
                </select>
                <div id="mobile-theme-toggle" class="theme-toggle" role="button" aria-label="Toggle dark mode" tabindex="0"></div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="gradient-bg text-white py-24 relative overflow-hidden">
        <div class="parallax-layer"></div>
        <div class="container mx-auto px-6 text-center relative z-10">
            <div class="hero-content" style="transform: translateY(0);">
                <h1 class="text-5xl md:text-6xl font-bold mb-6 animate-[fadeInUp_1s_ease-out]">Amanda Valuation Pro</h1>
                <h2 class="text-2xl md:text-3xl font-semibold mb-8 opacity-90 animate-[fadeInUp_1.2s_ease-out]">Precision Valuation for Strategic Growth</h2>
                <p class="text-lg mb-10 max-w-3xl mx-auto opacity-85 animate-[fadeInUp_1.4s_ease-out]">Leverage advanced analytics, AI-driven insights, multi-scenario planning, and investor-ready reports to unlock your business’s true value.</p>
                <div class="flex justify-center space-x-6 animate-[fadeInUp_1.6s_ease-out]">
                    <a href="#pro-valuation" class="btn-primary text-white font-bold py-3 px-10 rounded-lg shadow-lg">Start Valuation Now</a>
                    <button id="start-tour" class="btn-secondary font-bold py-3 px-10 rounded-lg shadow-lg" aria-label="Start guided tour">Take a Guided Tour</button>
                </div>
            </div>
        </div>
    </section>

    <!-- Pro Valuation Tool -->
    <section id="pro-valuation" class="py-20 bg-gray-50 transition-colors duration-300">
        <div class="container mx-auto px-6">
            <div class="text-center mb-16">
                <h2 class="text-4xl font-bold text-gray-800 mb-6 animate-[fadeIn_1s_ease-out] [data-theme='dark']:text-gray-100">Advanced Business Valuation</h2>
                <p class="text-lg text-gray-600 max-w-3xl mx-auto animate-[fadeIn_1.2s_ease-out] [data-theme='dark']:text-gray-300">Our Pro tool combines cutting-edge analytics, multiple valuation methodologies, risk profiling, and AI insights to deliver a precise, actionable valuation tailored for investors and strategic decisions.</p>
            </div>

            <div class="bg-white rounded-2xl shadow-2xl overflow-hidden max-w-7xl mx-auto transition-colors duration-300 [data-theme='dark']:bg-gray-800">
                <!-- Progress Bar -->
                <div class="p-8 border-b border-gray-200 [data-theme='dark']:border-gray-700">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-semibold text-gray-800 [data-theme='dark']:text-gray-100">Step <span id="current-step">1</span> of 9</h3>
                        <div class="flex items-center space-x-6">
                            <button id="start-over" class="text-[var(--primary)] hover:text-[var(--secondary)] font-medium flex items-center transition-colors duration-200" aria-label="Start over">
                                <i class="fas fa-redo-alt mr-2"></i> Start Over
                            </button>
                            <button id="resume-later" class="text-[var(--primary)] hover:text-[var(--secondary)] font-medium flex items-center transition-colors duration-200" aria-label="Resume later">
                                <i class="fas fa-save mr-2"></i> Resume Later
                            </button>
                        </div>
                    </div>
                    <div class="progress-bar">
                        <div id="progress-fill" class="progress-fill" style="width: 11.11%"></div>
                    </div>
                </div>

                <!-- Step Previews -->
                <nav class="step-nav mx-8 mt-6" role="navigation" aria-label="Step navigation">
                    <div class="step-nav-item active" data-step="1" aria-current="step">Step 1: Valuation Methods</div>
                    <div class="step-nav-item" data-step="2">Step 2: Business Fundamentals</div>
                    <div class="step-nav-item" data-step="3">Step 3: Customer Metrics</div>
                    <div class="step-nav-item" data-step="4">Step 4: Market Factors</div>
                    <div class="step-nav-item" data-step="5">Step 5: Advanced Inputs</div>
                    <div class="step-nav-item" data-step="6">Step 6: Valuation Inputs</div>
                    <div class="step-nav-item" data-step="7">Step 7: Scenario Builder</div>
                    <div class="step-nav-item" data-step="8">Step 8: Risk Assessment</div>
                    <div class="step-nav-item" data-step="9">Step 9: Team & Legal</div>
                </nav>

                <!-- Valuation Form -->
                <div id="valuation-form" class="p-8">
                    <!-- Step 1: Valuation Method Selection -->
                    <div class="interactive-panel relative group">
                        <div id="step-1" class="step step-visible">
                            <div class="flex items-center mb-6">
                                <h2 class="text-2xl font-semibold text-gray-800 flex items-center [data-theme='dark']:text-gray-100">
                                    <i class="fas fa-calculator mr-3 text-[var(--primary)]"></i> Valuation Method Selection
                                </h2>
                                <button class="tooltip-icon ml-3 focus:outline-none" data-tooltip="step1-tooltip" aria-label="Show step explanation" tabindex="0">
                                    <i class="fas fa-question-circle text-lg"></i>
                                </button>
                                <div id="step1-tooltip" class="tooltip">
                                    <div class="flex items-start">
                                        <i class="fas fa-info-circle mr-2 mt-1 text-white"></i>
                                        <p>This step lets you choose how we calculate your business’s worth. Pick methods like looking at your revenue, profits, or similar businesses sold recently. You can also decide how much each method influences the final value by setting weights (they need to add up to 100%).</p>
                                    </div>
                                </div>
                            </div>
                            <div class="mb-6">
                                <label class="block text-sm font-medium text-gray-700 mb-2 [data-theme='dark']:text-gray-200">Select Valuation Methods (1–4) and Assign Weights:</label>
                                <div class="space-y-5">
                                    <div class="flex items-center space-x-4">
                                        <input type="checkbox" id="method-multiplier" value="multiplier" class="mr-2 input-highlight h-5 w-5 text-[var(--primary)] focus:ring-[var(--primary)]" aria-describedby="method-multiplier-desc">
                                        <label for="method-multiplier" class="text-sm text-gray-700 flex-1 [data-theme='dark']:text-gray-200">Multiplier Method - Uses industry-standard revenue or EBITDA multipliers.</label>
                                        <div class="w-28">
                                            <label for="weight-multiplier" class="sr-only">Weight for Multiplier Method (%)</label>
                                            <div class="relative">
                                                <input type="number" id="weight-multiplier" placeholder="25" min="0" max="100" step="1" class="input-highlight w-full text-sm border-gray-300 rounded-md hidden [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="weight-multiplier-desc">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 text-sm">%</span>
                                            </div>
                                            <p id="weight-multiplier-desc" class="hidden mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400">Weight for this method (0–100%).</p>
                                            <p id="weight-multiplier-feedback" class="feedback-message"></p>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-4">
                                        <input type="checkbox" id="method-income" value="income" class="mr-2 input-highlight h-5 w-5 text-[var(--primary)] focus:ring-[var(--primary)]" aria-describedby="method-income-desc">
                                        <label for="method-income" class="text-sm text-gray-700 flex-1 [data-theme='dark']:text-gray-200">Income-Based Valuation - Based on total and recurring revenue.</label>
                                        <div class="w-28">
                                            <label for="weight-income" class="sr-only">Weight for Income Method (%)</label>
                                            <div class="relative">
                                                <input type="number" id="weight-income" placeholder="25" min="0" max="100" step="1" class="input-highlight w-full text-sm border-gray-300 rounded-md hidden [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="weight-income-desc">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 text-sm">%</span>
                                            </div>
                                            <p id="weight-income-desc" class="hidden mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400">Weight for this method (0–100%).</p>
                                            <p id="weight-income-feedback" class="feedback-message"></p>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-4">
                                        <input type="checkbox" id="method-earnings" value="earnings" class="mr-2 input-highlight h-5 w-5 text-[var(--primary)] focus:ring-[var(--primary)]" aria-describedby="method-earnings-desc">
                                        <label for="method-earnings" class="text-sm text-gray-700 flex-1 [data-theme='dark']:text-gray-200">Earnings-Based Valuation - Focuses on EBITDA and profitability.</label>
                                        <div class="w-28">
                                            <label for="weight-earnings" class="sr-only">Weight for Earnings Method (%)</label>
                                            <div class="relative">
                                                <input type="number" id="weight-earnings" placeholder="25" min="0" max="100" step="1" class="input-highlight w-full text-sm border-gray-300 rounded-md hidden [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="weight-earnings-desc">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 text-sm">%</span>
                                            </div>
                                            <p id="weight-earnings-desc" class="hidden mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400">Weight for this method (0–100%).</p>
                                            <p id="weight-earnings-feedback" class="feedback-message"></p>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-4">
                                        <input type="checkbox" id="method-dcf" value="dcf" class="mr-2 input-highlight h-5 w-5 text-[var(--primary)] focus:ring-[var(--primary)]" aria-describedby="method-dcf-desc">
                                        <label for="method-dcf" class="text-sm text-gray-700 flex-1 [data-theme='dark']:text-gray-200">Discounted Cash Flow (DCF) - Projects future cash flows.</label>
                                        <div class="w-28">
                                            <label for="weight-dcf" class="sr-only">Weight for DCF Method (%)</label>
                                            <div class="relative">
                                                <input type="number" id="weight-dcf" placeholder="25" min="0" max="100" step="1" class="input-highlight w-full text-sm border-gray-300 rounded-md hidden [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="weight-dcf-desc">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 text-sm">%</span>
                                            </div>
                                            <p id="weight-dcf-desc" class="hidden mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400">Weight for this method (0–100%).</p>
                                            <p id="weight-dcf-feedback" class="feedback-message"></p>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-4">
                                        <input type="checkbox" id="method-comparable" value="comparable" class="mr-2 input-highlight h-5 w-5 text-[var(--primary)] focus:ring-[var(--primary)]" aria-describedby="method-comparable-desc">
                                        <label for="method-comparable" class="text-sm text-gray-700 flex-1 [data-theme='dark']:text-gray-200">Comparable Sales - Uses sales of similar businesses.</label>
                                        <div class="w-28">
                                            <label for="weight-comparable" class="sr-only">Weight for Comparable Method (%)</label>
                                            <div class="relative">
                                                <input type="number" id="weight-comparable" placeholder="25" min="0" max="100" step="1" class="input-highlight w-full text-sm border-gray-300 rounded-md hidden [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="weight-comparable-desc">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 text-sm">%</span>
                                            </div>
                                            <p id="weight-comparable-desc" class="hidden mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400">Weight for this method (0–100%).</p>
                                            <p id="weight-comparable-feedback" class="feedback-message"></p>
                                        </div>
                                    </div>
                                </div>
                                <p class="mt-2 text-sm text-gray-500 [data-theme='dark']:text-gray-400">Select up to 4 methods and assign weights totaling 100% to prioritize their impact.</p>
                                <p id="method-error" class="error-message">Please select 1 to 4 valuation methods.</p>
                                <p id="weight-error" class="error-message">Weights must sum to 100%.</p>
                            </div>
                            <div class="flex justify-end">
                                <button id="next-btn-1" class="btn-primary text-white font-bold py-2.5 px-8 rounded-lg shadow-md" aria-label="Next step">
                                    Next <i class="fas fa-arrow-right ml-2"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    <!-- Step 2: Business Fundamentals -->
                    <div class="interactive-panel relative group">
                        <div id="step-2" class="step step-hidden">
                            <div class="flex items-center mb-6">
                                <h2 class="text-2xl font-semibold text-gray-800 flex items-center [data-theme='dark']:text-gray-100">
                                    <i class="fas fa-building mr-3 text-[var(--primary)]"></i> Business Fundamentals
                                </h2>
                                <button class="tooltip-icon ml-3 focus:outline-none" data-tooltip="step2-tooltip" aria-label="Show step explanation" tabindex="0">
                                    <i class="fas fa-question-circle text-lg"></i>
                                </button>
                                <div id="step2-tooltip" class="tooltip">
                                    <div class="flex items-start">
                                        <i class="fas fa-info-circle mr-2 mt-1 text-white"></i>
                                        <p>This step gathers basic info about your business, like how long it’s been running, its legal setup, and your expenses. These details help us understand your business’s size, stability, and financial health, which are key to figuring out its value.</p>
                                    </div>
                                </div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                <div>
                                    <label for="companyStart" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">When did you first invoice a customer? (Month/Year):</label>
                                    <input type="month" id="companyStart" class="input-highlight block w-full text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="companyStart-desc">
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="companyStart-desc">This shows how long your business has been operating.</p>
                                    <p id="companyStart-error" class="error-message">Please select a valid date.</p>
                                </div>
                                <div>
                                    <label for="legalStructure" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">What’s your company’s legal type?:</label>
                                    <select id="legalStructure" class="input-highlight block w-full text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="legalStructure-desc">
                                        <option value="">Select an option</option>
                                        <option value="pty-ltd">Pty Ltd</option>
                                        <option value="llc">LLC</option>
                                        <option value="c-corp">C-Corp</option>
                                        <option value="s-corp">S-Corp</option>
                                        <option value="partnership">Partnership</option>
                                        <option value="sole-prop">Sole Proprietorship</option>
                                    </select>
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="legalStructure-desc">This is how your business is legally set up.</p>
                                    <p id="legalStructure-error" class="error-message">Please select a legal structure.</p>
                                </div>
                                <div>
                                    <label for="founderOwnership" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">What % of shares do founders own?:</label>
                                    <div class="relative">
                                        <input type="text" id="founderOwnership" placeholder="75" class="input-highlight block w-full pr-10 text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="founderOwnership-desc">
                                        <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 text-sm">%</span>
                                    </div>
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="founderOwnership-desc">Higher founder ownership can make your business more attractive.</p>
                                    <p id="founderOwnership-error" class="error-message">Please enter a valid percentage (0–100).</p>
                                    <p id="founderOwnership-feedback" class="feedback-message"></p>
                                </div>
                                <div>
                                    <label for="capitalRaised" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Total capital raised ($):</label>
                                    <div class="relative rounded-md shadow-sm">
                                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                            <span class="text-gray-500 sm:text-sm">$</span>
                                        </div>
                                        <input type="text" id="capitalRaised" placeholder="500,000" class="input-highlight block w-full pl-7 pr-12 text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="capitalRaised-desc">
                                        <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                                            <span class="text-gray-500 sm:text-sm currency-symbol">USD</span>
                                        </div>
                                    </div>
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="capitalRaised-desc">Total money raised from investors or loans.</p>
                                    <p id="capitalRaised-error" class="error-message">Please enter a valid amount.</p>
                                    <p id="capitalRaised-feedback" class="feedback-message"></p>
                                </div>
                                <div>
                                    <label for="opexRD" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Last year’s R&D spend ($):</label>
                                    <div class="relative rounded-md shadow-sm">
                                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                            <span class="text-gray-500 sm:text-sm">$</span>
                                        </div>
                                        <input type="text" id="opexRD" placeholder="100,000" class="input-highlight block w-full pl-7 pr-12 text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="opexRD-desc">
                                        <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                                            <span class="text-gray-500 sm:text-sm currency-symbol">USD</span>
                                        </div>
                                    </div>
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="opexRD-desc">Spending on research and development.</p>
                                    <p id="opexRD-error" class="error-message">Please enter a valid amount.</p>
                                    <p id="opexRD-feedback" class="feedback-message"></p>
                                </div>
                                <div>
                                    <label for="opexSales" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Last year’s Sales & Marketing spend ($):</label>
                                    <div class="relative rounded-md shadow-sm">
                                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                            <span class="text-gray-500 sm:text-sm">$</span>
                                        </div>
                                        <input type="text" id="opexSales" placeholder="150,000" class="input-highlight block w-full pl-7 pr-12 text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="opexSales-desc">
                                        <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                                            <span class="text-gray-500 sm:text-sm currency-symbol">USD</span>
                                        </div>
                                    </div>
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="opexSales-desc">Spending on advertising and sales efforts.</p>
                                    <p id="opexSales-error" class="error-message">Please enter a valid amount.</p>
                                    <p id="opexSales-feedback" class="feedback-message"></p>
                                </div>
                                <div>
                                    <label for="opexGA" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Last year’s General & Admin spend ($):</label>
                                    <div class="relative rounded-md shadow-sm">
                                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                            <span class="text-gray-500 sm:text-sm">$</span>
                                        </div>
                                        <input type="text" id="opexGA" placeholder="80,000" class="input-highlight block w-full pl-7 pr-12 text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="opexGA-desc">
                                        <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                                            <span class="text-gray-500 sm:text-sm currency-symbol">USD</span>
                                        </div>
                                    </div>
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="opexGA-desc">Spending on office costs, salaries, etc.</p>
                                    <p id="opexGA-error" class="error-message">Please enter a valid amount.</p>
                                    <p id="opexGA-feedback" class="feedback-message"></p>
                                </div>
                                <div>
                                    <label for="cashRunway" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Cash in bank today ($):</label>
                                    <div class="relative rounded-md shadow-sm">
                                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                            <span class="text-gray-500 sm:text-sm">$</span>
                                        </div>
                                        <input type="text" id="cashRunway" placeholder="200,000" class="input-highlight block w-full pl-7 pr-12 text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="cashRunway-desc">
                                        <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                                            <span class="text-gray-500 sm:text-sm currency-symbol">USD</span>
                                        </div>
                                    </div>
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="cashRunway-desc">Your cash reserves, excluding loans.</p>
                                    <p id="cashRunway-error" class="error-message">Please enter a valid amount.</p>
                                    <p id="cashRunway-feedback" class="feedback-message"></p>
                                </div>
                                <div>
                                    <label for="debt" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Outstanding debt ($):</label>
                                    <div class="relative rounded-md shadow-sm">
                                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                            <span class="text-gray-500 sm:text-sm">$</span>
                                        </div>
                                        <input type="text" id="debt" placeholder="50,000" class="input-highlight block w-full pl-7 pr-12 text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="debt-desc">
                                        <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                                            <span class="text-gray-500 sm:text-sm currency-symbol">USD</span>
                                        </div>
                                    </div>
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="debt-desc">Total loans or convertible notes owed.</p>
                                    <p id="debt-error" class="error-message">Please enter a valid amount.</p>
                                    <p id="debt-feedback" class="feedback-message"></p>
                                </div>
                            </div>
                            <div class="flex justify-between">
                                <button id="prev-btn-2" class="btn-secondary font-bold py-2.5 px-8 rounded-lg shadow-md" aria-label="Previous step">
                                    <i class="fas fa-arrow-left mr-2"></i> Previous
                                </button>
                                <button id="next-btn-2" class="btn-primary text-white font-bold py-2.5 px-8 rounded-lg shadow-md" aria-label="Next step">
                                    Next <i class="fas fa-arrow-right ml-2"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Step 3: Customer Metrics -->
                    <div class="interactive-panel relative group">
                        <div id="step-3" class="step step-hidden">
                            <div class="flex items-center mb-6">
                                <h2 class="text-2xl font-semibold text-gray-800 flex items-center [data-theme='dark']:text-gray-100">
                                    <i class="fas fa-users mr-3 text-[var(--primary)]"></i> Customer Metrics
                                </h2>
                                <button class="tooltip-icon ml-3 focus:outline-none" data-tooltip="step3-tooltip" aria-label="Show step explanation" tabindex="0">
                                    <i class="fas fa-question-circle text-lg"></i>
                                </button>
                                <div id="step3-tooltip" class="tooltip">
                                    <div class="flex items-start">
                                        <i class="fas fa-info-circle mr-2 mt-1 text-white"></i>
                                        <p>This step looks at your customers: how many you keep, how much they spend, and how you get them. Strong customer loyalty and efficient growth (low cost to get customers, high value from them) make your business more valuable.</p>
                                    </div>
                                </div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                <div>
                                    <label for="logoChurn" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">How many customers left in the last 12 months?:</label>
                                    <input type="number" id="logoChurn" placeholder="10" min="0" class="input-highlight block w-full text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="logoChurn-desc">
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="logoChurn-desc">Number of paying customers who stopped using your service.</p>
                                    <p id="logoChurn-error" class="error-message">Please enter a valid number.</p>
                                    <p id="logoChurn-feedback" class="feedback-message"></p>
                                </div>
                                <div>
                                    <label for="ndr" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Current ARR from customers active 12 months ago ($):</label>
                                    <div class="relative rounded-md shadow-sm">
                                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                            <span class="text-gray-500 sm:text-sm">$</span>
                                        </div>
                                        <input type="text" id="ndr" placeholder="80,000" class="input-highlight block w-full pl-7 pr-12 text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="ndr-desc">
                                        <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                                            <span class="text-gray-500 sm:text-sm currency-symbol">USD</span>
                                        </div>
                                    </div>
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="ndr-desc">Revenue from existing customers, showing retention and growth.</p>
                                    <p id="ndr-error" class="error-message">Please enter a valid amount.</p>
                                    <p id="ndr-feedback" class="feedback-message"></p>
                                </div>
                                <div>
                                    <label for="customerConcentration" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Top customer’s share of ARR (%):</label>
                                    <div class="relative">
                                        <input type="text" id="customerConcentration" placeholder="20" class="input-highlight block w-full pr-10 text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="customerConcentration-desc">
                                        <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 text-sm">%</span>
                                    </div>
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="customerConcentration-desc">How much your biggest customer contributes to revenue.</p>
                                    <p id="customerConcentration-error" class="error-message">Please enter a valid percentage (0–100).</p>
                                    <p id="customerConcentration-feedback" class="feedback-message"></p>
                                </div>
                                <div>
                                    <label for="usageCurrent" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Primary usage metric this month (e.g., active users):</label>
                                    <input type="number" id="usageCurrent" placeholder="1000" min="0" class="input-highlight block w-full text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="usageCurrent-desc">
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="usageCurrent-desc">Your main activity metric (e.g., monthly active users).</p>
                                    <p id="usageCurrent-error" class="error-message">Please enter a valid number.</p>
                                    <p id="usageCurrent-feedback" class="feedback-message"></p>
                                </div>
                                <div>
                                    <label for="usagePast" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Primary usage metric 12 months ago:</label>
                                    <input type="number" id="usagePast" placeholder="800" min="0" class="input-highlight block w-full text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="usagePast-desc">
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="usagePast-desc">Same metric from a year ago to show growth.</p>
                                    <p id="usagePast-error" class="error-message">Please enter a valid number.</p>
                                    <p id="usagePast-feedback" class="feedback-message"></p>
                                </div>
                                <div>
                                    <label for="cac" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Last quarter’s sales & marketing spend ($):</label>
                                    <div class="relative rounded-md shadow-sm">
                                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                            <span class="text-gray-500 sm:text-sm">$</span>
                                        </div>
                                        <input type="text" id="cac" placeholder="50,000" class="input-highlight block w-full pl-7 pr-12 text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="cac-desc">
                                        <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                                            <span class="text-gray-500 sm:text-sm currency-symbol">USD</span>
                                        </div>
                                    </div>
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="cac-desc">Cost to acquire a new customer.</p>
                                    <p id="cac-error" class="error-message">Please enter a valid amount.</p>
                                    <p id="cac-feedback" class="feedback-message"></p>
                                </div>
                                <div>
                                    <label for="ltv" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Average customer lifetime (months):</label>
                                    <input type="number" id="ltv" placeholder="36" min="0" class="input-highlight block w-full text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="ltv-desc">
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="ltv-desc">How long customers typically stay with you.</p>
                                    <p id="ltv-error" class="error-message">Please enter a valid number.</p>
                                    <p id="ltv-feedback" class="feedback-message"></p>
                                </div>
                                <div>
                                    <label for="payback" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Months to recover CAC:</label>
                                    <input type="number" id="payback" placeholder="12" min="0" class="input-highlight block w-full text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="payback-desc">
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="payback-desc">How long it takes to earn back customer acquisition costs.</p>
                                    <p id="payback-error" class="error-message">Please enter a valid number.</p>
                                    <p id="payback-feedback" class="feedback-message"></p>
                                </div>
                                <div>
                                    <label for="grossMargin" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Last year’s cost of goods sold ($):</label>
                                    <div class="relative rounded-md shadow-sm">
                                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                            <span class="text-gray-500 sm:text-sm">$</span>
                                        </div>
                                        <input type="text" id="grossMargin" placeholder="40,000" class="input-highlight block w-full pl-7 pr-12 text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="grossMargin-desc">
                                        <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                                            <span class="text-gray-500 sm:text-sm currency-symbol">USD</span>
                                        </div>
                                    </div>
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="grossMargin-desc">Costs like hosting, support, or licenses.</p>
                                    <p id="grossMargin-error" class="error-message">Please enter a valid amount.</p>
                                    <p id="grossMargin-feedback" class="feedback-message"></p>
                                </div>
                            </div>
                            <div class="flex justify-between">
                                <button id="prev-btn-3" class="btn-secondary font-bold py-2.5 px-8 rounded-lg shadow-md" aria-label="Previous step">
                                    <i class="fas fa-arrow-left mr-2"></i> Previous
                                </button>
                                <button id="next-btn-3" class="btn-primary text-white font-bold py-2.5 px-8 rounded-lg shadow-md" aria-label="Next step">
                                    Next <i class="fas fa-arrow-right ml-2"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Step 4: Market and Industry Factors -->
                    <div class="interactive-panel relative group">
                        <div id="step-4" class="step step-hidden">
                            <div class="flex items-center mb-6">
                                <h2 class="text-2xl font-semibold text-gray-800 flex items-center [data-theme='dark']:text-gray-100">
                                    <i class="fas fa-globe mr-3 text-[var(--primary)]"></i> Market and Industry Factors
                                </h2>
                                <button class="tooltip-icon ml-3 focus:outline-none" data-tooltip="step4-tooltip" aria-label="Show step explanation" tabindex="0">
                                    <i class="fas fa-question-circle text-lg"></i>
                                </button>
                                <div id="step4-tooltip" class="tooltip">
                                    <div class="flex items-start">
                                        <i class="fas fa-info-circle mr-2 mt-1 text-white"></i>
                                        <p>This step checks your industry and market position. A growing industry, strong competition stance, and big market potential can boost your business’s value.</p>
                                    </div>
                                </div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                <div>
                                    <label for="industry" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Select your industry:</label>
                                    <select id="industry" class="input-highlight block w-full text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="industry-desc">
                                        <option value="">Select an option</option>
                                        <option value="technology">Technology</option>
                                        <option value="healthcare">Healthcare</option>
                                        <option value="retail">Retail</option>
                                        <option value="manufacturing">Manufacturing</option>
                                        <option value="finance">Finance</option>
                                        <option value="education">Education</option>
                                    </select>
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="industry-desc">Your industry affects valuation multipliers.</p>
                                    <p id="industry-error" class="error-message">Please select an industry.</p>
                                </div>
                                <div>
                                    <label for="industryMultiplier" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Industry Multiplier:</label>
                                    <input type="text" id="industryMultiplier" readonly class="input-highlight block w-full text-sm border-gray-300 rounded-md bg-gray-100 [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-600" aria-describedby="industryMultiplier-desc">
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="industryMultiplier-desc">Automatically set based on your industry.</p>
                                </div>
                                <div>
                                    <label for="icp" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Who’s your main customer type?:</label>
                                    <select id="icp" class="input-highlight block w-full text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="icp-desc">
                                        <option value="">Select an option</option>
                                        <option value="smb">Small Businesses</option>
                                        <option value="mid-market">Mid-Market</option>
                                        <option value="enterprise">Enterprise</option>
                                        <option value="consumer">Consumers</option>
                                    </select>
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="icp-desc">Your primary customer segment.</p>
                                    <p id="icp-error" class="error-message">Please select a customer type.</p>
                                </div>
                                <div>
                                    <label for="tam" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Total addressable market size ($, optional):</label>
                                    <div class="relative rounded-md shadow-sm">
                                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                            <span class="text-gray-500 sm:text-sm">$</span>
                                        </div>
                                        <input type="text" id="tam" placeholder="10,000,000" class="input-highlight block w-full pl-7 pr-12 text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="tam-desc">
                                        <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                                            <span class="text-gray-500 sm:text-sm currency-symbol">USD</span>
                                        </div>
                                    </div>
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="tam-desc">The potential market size for your product.</p>
                                    <p id="tam-error" class="error-message">Please enter a valid amount.</p>
                                    <p id="tam-feedback" class="feedback-message"></p>
                                </div>
                                <div>
                                    <label for="competitor1" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Top competitor 1:</label>
                                    <input type="text" id="competitor1" placeholder="Competitor Name" class="input-highlight block w-full text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="competitor1-desc">
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="competitor1-desc">Your closest competitor.</p>
                                    <p id="competitor1-error" class="error-message">Please enter a competitor name.</p>
                                </div>
                                <div>
                                    <label for="competitor2" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Top competitor 2:</label>
                                    <input type="text" id="competitor2" placeholder="Competitor Name" class="input-highlight block w-full text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="competitor2-desc">
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="competitor2-desc">Another close competitor.</p>
                                    <p id="competitor2-error" class="error-message">Please enter a competitor name.</p>
                                </div>
                                <div>
                                    <label for="competitor3" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Top competitor 3:</label>
                                    <input type="text" id="competitor3" placeholder="Competitor Name" class="input-highlight block w-full text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="competitor3-desc">
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="competitor3-desc">A third competitor.</p>
                                    <p id="competitor3-error" class="error-message">Please enter a competitor name.</p>
                                </div>
                                <div>
                                    <label for="lastPriceRise" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">When was your last price increase?:</label>
                                    <input type="month" id="lastPriceRise" class="input-highlight block w-full text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="lastPriceRise-desc">
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="lastPriceRise-desc">The date of your most recent price hike.</p>
                                    <p id="lastPriceRise-error" class="error-message">Please select a valid date.</p>
                                </div>
                                <div>
                                    <label for="priceIncreasePercent" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Price increase percentage (%):</label>
                                    <div class="relative">
                                        <input type="text" id="priceIncreasePercent" placeholder="10" class="input-highlight block w-full pr-10 text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="priceIncreasePercent-desc">
                                        <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 text-sm">%</span>
                                    </div>
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="priceIncreasePercent-desc">How much you raised prices by.</p>
                                    <p id="priceIncreasePercent-error" class="error-message">Please enter a valid percentage (0–100).</p>
                                    <p id="priceIncreasePercent-feedback" class="feedback-message"></p>
                                </div>
                            </div>
                            <div class="flex justify-between">
                                <button id="prev-btn-4" class="btn-secondary font-bold py-2.5 px-8 rounded-lg shadow-md" aria-label="Previous step">
                                    <i class="fas fa-arrow-left mr-2"></i> Previous
                                </button>
                                <button id="next-btn-4" class="btn-primary text-white font-bold py-2.5 px-8 rounded-lg shadow-md" aria-label="Next step">
                                    Next <i class="fas fa-arrow-right ml-2"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    <!-- Step 5: Advanced Inputs -->
                    <div class="interactive-panel relative group">
                        <div id="step-5" class="step step-hidden">
                            <div class="flex items-center mb-6">
                                <h2 class="text-2xl font-semibold text-gray-800 flex items-center [data-theme='dark']:text-gray-100">
                                    <i class="fas fa-cogs mr-3 text-[var(--primary)]"></i> Advanced Inputs
                                </h2>
                                <button class="tooltip-icon ml-3 focus:outline-none" data-tooltip="step5-tooltip" aria-label="Show step explanation" tabindex="0">
                                    <i class="fas fa-question-circle text-lg"></i>
                                </button>
                                <div id="step5-tooltip" class="tooltip">
                                    <div class="flex items-start">
                                        <i class="fas fa-info-circle mr-2 mt-1 text-white"></i>
                                        <p>This step dives into your technology and operations. Things like modern tech, strong security, and reliable performance make your business more valuable by showing it’s built to last.</p>
                                    </div>
                                </div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                <div>
                                    <label for="techStack" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Primary backend language/framework:</label>
                                    <select id="techStack" class="input-highlight block w-full text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="techStack-desc">
                                        <option value="">Select an option</option>
                                        <option value="node">Node.js</option>
                                        <option value="ruby">Ruby on Rails</option>
                                        <option value="dotnet">.NET</option>
                                        <option value="python">Python/Django</option>
                                        <option value="java">Java/Spring</option>
                                        <option value="php">PHP/Laravel</option>
                                    </select>
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="techStack-desc">The main tech powering your product.</p>
                                    <p id="techStack-error" class="error-message">Please select a tech stack.</p>
                                </div>
                                <div>
                                    <label for="ipPosition" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Do you own 100% of the code and have IP agreements?:</label>
                                    <select id="ipPosition" class="input-highlight block w-full text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="ipPosition-desc">
                                        <option value="">Select an option</option>
                                        <option value="yes">Yes</option>
                                        <option value="no">No</option>
                                    </select>
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="ipPosition-desc">Full ownership increases value.</p>
                                    <p id="ipPosition-error" class="error-message">Please select an option.</p>
                                    <p id="ipPosition-feedback" class="feedback-message"></p>
                                </div>
                                <div>
                                    <label for="securityCerts" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Security certifications (select all that apply):</label>
                                    <div class="space-y-2">
                                        <div class="flex items-center">
                                            <input type="checkbox" id="cert-soc2" value="soc2" class="input-highlight h-4 w-4 text-[var(--primary)] focus:ring-[var(--primary)]" aria-describedby="securityCerts-desc">
                                            <label for="cert-soc2" class="ml-2 text-sm text-gray-700 [data-theme='dark']:text-gray-200">SOC 2</label>
                                        </div>
                                        <div class="flex items-center">
                                            <input type="checkbox" id="cert-iso27001" value="iso27001" class="input-highlight h-4 w-4 text-[var(--primary)] focus:ring-[var(--primary)]" aria-describedby="securityCerts-desc">
                                            <label for="cert-iso27001" class="ml-2 text-sm text-gray-700 [data-theme='dark']:text-gray-200">ISO 27001</label>
                                        </div>
                                        <div class="flex items-center">
                                            <input type="checkbox" id="cert-hipaa" value="hipaa" class="input-highlight h-4 w-4 text-[var(--primary)] focus:ring-[var(--primary)]" aria-describedby="securityCerts-desc">
                                            <label for="cert-hipaa" class="ml-2 text-sm text-gray-700 [data-theme='dark']:text-gray-200">HIPAA</label>
                                        </div>
                                        <div class="flex items-center">
                                            <input type="checkbox" id="cert-none" value="none" class="input-highlight h-4 w-4 text-[var(--primary)] focus:ring-[var(--primary)]" aria-describedby="securityCerts-desc">
                                            <label for="cert-none" class="ml-2 text-sm text-gray-700 [data-theme='dark']:text-gray-200">None</label>
                                        </div>
                                    </div>
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="securityCerts-desc">Certifications boost trust and value.</p>
                                    <p id="securityCerts-error" class="error-message">Please select at least one option.</p>
                                    <p id="securityCerts-feedback" class="feedback-message"></p>
                                </div>
                                <div>
                                    <label for="uptime" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">12-month average uptime (%):</label>
                                    <div class="relative">
                                        <input type="text" id="uptime" placeholder="99.9" class="input-highlight block w-full pr-10 text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="uptime-desc">
                                        <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 text-sm">%</span>
                                    </div>
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="uptime-desc">How reliable your product is.</p>
                                    <p id="uptime-error" class="error-message">Please enter a valid percentage (0–100).</p>
                                    <p id="uptime-feedback" class="feedback-message"></p>
                                </div>
                                <div>
                                    <label for="roadmapCadence" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Major releases in the past 6 months:</label>
                                    <input type="number" id="roadmapCadence" placeholder="3" min="0" class="input-highlight block w-full text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="roadmapCadence-desc">
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="roadmapCadence-desc">How often you update your product.</p>
                                    <p id="roadmapCadence-error" class="error-message">Please enter a valid number.</p>
                                    <p id="roadmapCadence-feedback" class="feedback-message"></p>
                                </div>
                            </div>
                            <div class="flex justify-between">
                                <button id="prev-btn-5" class="btn-secondary font-bold py-2.5 px-8 rounded-lg shadow-md" aria-label="Previous step">
                                    <i class="fas fa-arrow-left mr-2"></i> Previous
                                </button>
                                <button id="next-btn-5" class="btn-primary text-white font-bold py-2.5 px-8 rounded-lg shadow-md" aria-label="Next step">
                                    Next <i class="fas fa-arrow-right ml-2"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Step 6: Valuation Specific Inputs -->
                    <div class="interactive-panel relative group">
                        <div id="step-6" class="step step-hidden">
                            <div class="flex items-center mb-6">
                                <h2 class="text-2xl font-semibold text-gray-800 flex items-center [data-theme='dark']:text-gray-100">
                                    <i class="fas fa-chart-line mr-3 text-[var(--primary)]"></i> Valuation Specific Inputs
                                </h2>
                                <button class="tooltip-icon ml-3 focus:outline-none" data-tooltip="step6-tooltip" aria-label="Show step explanation" tabindex="0">
                                    <i class="fas fa-question-circle text-lg"></i>
                                </button>
                                <div id="step6-tooltip" class="tooltip">
                                    <div class="flex items-start">
                                        <i class="fas fa-info-circle mr-2 mt-1 text-white"></i>
                                        <p>This step focuses on your revenue and profits. Steady, growing income from customers and strong profits are some of the biggest factors in determining your business’s worth.</p>
                                    </div>
                                </div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                <div>
                                    <label for="mrr" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Last month’s recurring revenue ($):</label>
                                    <div class="relative rounded-md shadow-sm">
                                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                            <span class="text-gray-500 sm:text-sm">$</span>
                                        </div>
                                        <input type="text" id="mrr" placeholder="10,000" class="input-highlight block w-full pl-7 pr-12 text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="mrr-desc">
                                        <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                                            <span class="text-gray-500 sm:text-sm currency-symbol">USD</span>
                                        </div>
                                    </div>
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="mrr-desc">Monthly recurring revenue (MRR). Yearly (ARR) is calculated.</p>
                                    <p id="mrr-error" class="error-message">Please enter a valid amount.</p>
                                    <p id="mrr-feedback" class="feedback-message"></p>
                                </div>
                                <div>
                                    <label for="arrPast" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">ARR 12 months ago ($):</label>
                                    <div class="relative rounded-md shadow-sm">
                                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                            <span class="text-gray-500 sm:text-sm">$</span>
                                        </div>
                                        <input type="text" id="arrPast" placeholder="100,000" class="input-highlight block w-full pl-7 pr-12 text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="arrPast-desc">
                                        <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                                            <span class="text-gray-500 sm:text-sm currency-symbol">USD</span>
                                        </div>
                                    </div>
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="arrPast-desc">Your annual recurring revenue a year ago.</p>
                                    <p id="arrPast-error" class="error-message">Please enter a valid amount.</p>
                                    <p id="arrPast-feedback" class="feedback-message"></p>
                                </div>
                                <div>
                                    <label for="nonRecurringPercent" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">% of last year’s revenue from one-time sales:</label>
                                    <div class="relative">
                                        <input type="text" id="nonRecurringPercent" placeholder="15" class="input-highlight block w-full pr-10 text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="nonRecurringPercent-desc">
                                        <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 text-sm">%</span>
                                    </div>
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="nonRecurringPercent-desc">Revenue from setup fees, hardware, etc.</p>
                                    <p id="nonRecurringPercent-error" class="error-message">Please enter a valid percentage (0–100).</p>
                                    <p id="nonRecurringPercent-feedback" class="feedback-message"></p>
                                </div>
                                <div>
                                    <label for="contractLength" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Average initial contract term:</label>
                                    <select id="contractLength" class="input-highlight block w-full text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="contractLength-desc">
                                        <option value="">Select an option</option>
                                        <option value="monthly">Monthly</option>
                                        <option value="12">12 months</option>
                                        <option value="24">24 months</option>
                                        <option value="36">36 months</option>
                                    </select>
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="contractLength-desc">Longer contracts mean stable revenue.</p>
                                    <p id="contractLength-error" class="error-message">Please select a contract term.</p>
                                    <p id="contractLength-feedback" class="feedback-message"></p>
                                </div>
                                <div>
                                    <label for="annualPrepayPercent" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">% of customers who prepay annually:</label>
                                    <div class="relative">
                                        <input type="text" id="annualPrepayPercent" placeholder="30" class="input-highlight block w-full pr-10 text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="annualPrepayPercent-desc">
                                        <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 text-sm">%</span>
                                    </div>
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="annualPrepayPercent-desc">Customers paying upfront for a year.</p>
                                    <p id="annualPrepayPercent-error" class="error-message">Please enter a valid percentage (0–100).</p>
                                    <p id="annualPrepayPercent-feedback" class="feedback-message"></p>
                                </div>
                                <div>
                                    <label for="ebitda" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Last year’s operating profit/loss ($):</label>
                                    <div class="relative rounded-md shadow-sm">
                                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                            <span class="text-gray-500 sm:text-sm">$</span>
                                        </div>
                                        <input type="text" id="ebitda" placeholder="50,000" class="input-highlight block w-full pl-7 pr-12 text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="ebitda-desc">
                                        <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                                            <span class="text-gray-500 sm:text-sm currency-symbol">USD</span>
                                        </div>
                                    </div>
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="ebitda-desc">Profit before taxes and interest (EBITDA).</p>
                                    <p id="ebitda-error" class="error-message">Please enter a valid amount.</p>
                                    <p id="ebitda-feedback" class="feedback-message"></p>
                                </div>
                            </div>
                            <div class="flex justify-between">
                                <button id="prev-btn-6" class="btn-secondary font-bold py-2.5 px-8 rounded-lg shadow-md" aria-label="Previous step">
                                    <i class="fas fa-arrow-left mr-2"></i> Previous
                                </button>
                                <button id="next-btn-6" class="btn-primary text-white font-bold py-2.5 px-8 rounded-lg shadow-md" aria-label="Next step">
                                    Next <i class="fas fa-arrow-right ml-2"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Step 7: Scenario Builder -->
                    <div class="interactive-panel relative group">
                        <div id="step-7" class="step step-hidden">
                            <div class="flex items-center mb-6">
                                <h2 class="text-2xl font-semibold text-gray-800 flex items-center [data-theme='dark']:text-gray-100">
                                    <i class="fas fa-project-diagram mr-3 text-[var(--primary)]"></i> Scenario Builder
                                </h2>
                                <button class="tooltip-icon ml-3 focus:outline-none" data-tooltip="step7-tooltip" aria-label="Show step explanation" tabindex="0">
                                    <i class="fas fa-question-circle text-lg"></i>
                                </button>
                                <div id="step7-tooltip" class="tooltip">
                                    <div class="flex items-start">
                                        <i class="fas fa-info-circle mr-2 mt-1 text-white"></i>
                                        <p>Create different “what-if” scenarios to see how changes in growth, customer retention, or expenses could affect your business’s value. Name each scenario to compare them later.</p>
                                    </div>
                                </div>
                            </div>
                            <div class="mb-6">
                                <div class="flex justify-between items-center mb-4">
                                    <label for="scenarioName" class="block text-sm font-medium text-gray-700 [data-theme='dark']:text-gray-200">Scenario Name:</label>
                                    <button id="add-scenario" class="btn-primary text-white font-bold py-2 px-6 rounded-lg shadow-md" aria-label="Add new scenario">
                                        <i class="fas fa-plus mr-2"></i> Add Scenario
                                    </button>
                                </div>
                                <input type="text" id="scenarioName" placeholder="e.g., High Growth Case" class="input-highlight block w-full text-sm border-gray-300 rounded-md mb-4 [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="scenarioName-desc">
                                <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="scenarioName-desc">Give this scenario a unique name.</p>
                                <p id="scenarioName-error" class="error-message">Please enter a scenario name.</p>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label for="scenarioGrowth" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Projected ARR growth rate (%):</label>
                                        <div class="relative">
                                            <input type="text" id="scenarioGrowth" placeholder="20" class="input-highlight block w-full pr-10 text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="scenarioGrowth-desc">
                                            <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 text-sm">%</span>
                                        </div>
                                        <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="scenarioGrowth-desc">Expected revenue growth for this scenario.</p>
                                        <p id="scenarioGrowth-error" class="error-message">Please enter a valid percentage.</p>
                                        <p id="scenarioGrowth-feedback" class="feedback-message"></p>
                                    </div>
                                    <div>
                                        <label for="scenarioChurn" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Projected customer churn rate (%):</label>
                                        <div class="relative">
                                            <input type="text" id="scenarioChurn" placeholder="5" class="input-highlight block w-full pr-10 text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="scenarioChurn-desc">
                                            <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 text-sm">%</span>
                                        </div>
                                        <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="scenarioChurn-desc">Expected customer loss rate.</p>
                                        <p id="scenarioChurn-error" class="error-message">Please enter a valid percentage (0–100).</p>
                                        <p id="scenarioChurn-feedback" class="feedback-message"></p>
                                    </div>
                                    <div>
                                        <label for="scenarioOpex" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Projected operating expenses ($):</label>
                                        <div class="relative rounded-md shadow-sm">
                                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                                <span class="text-gray-500 sm:text-sm">$</span>
                                            </div>
                                            <input type="text" id="scenarioOpex" placeholder="200,000" class="input-highlight block w-full pl-7 pr-12 text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="scenarioOpex-desc">
                                            <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                                                <span class="text-gray-500 sm:text-sm currency-symbol">USD</span>
                                            </div>
                                        </div>
                                        <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="scenarioOpex-desc">Total expected expenses.</p>
                                        <p id="scenarioOpex-error" class="error-message">Please enter a valid amount.</p>
                                        <p id="scenarioOpex-feedback" class="feedback-message"></p>
                                    </div>
                                    <div>
                                        <label for="scenarioDiscount" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Discount rate for DCF (%):</label>
                                        <div class="relative">
                                            <input type="text" id="scenarioDiscount" placeholder="10" class="input-highlight block w-full pr-10 text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="scenarioDiscount-desc">
                                            <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 text-sm">%</span>
                                        </div>
                                        <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="scenarioDiscount-desc">Rate to discount future cash flows.</p>
                                        <p id="scenarioDiscount-error" class="error-message">Please enter a valid percentage.</p>
                                        <p id="scenarioDiscount-feedback" class="feedback-message"></p>
                                    </div>
                                </div>
                                <div id="scenario-list" class="mt-6">
                                    <h3 class="text-lg font-medium text-gray-800 [data-theme='dark']:text-gray-100">Saved Scenarios:</h3>
                                    <ul id="scenario-items" class="space-y-2 mt-2"></ul>
                                </div>
                            </div>
                            <div class="flex justify-between">
                                <button id="prev-btn-7" class="btn-secondary font-bold py-2.5 px-8 rounded-lg shadow-md" aria-label="Previous step">
                                    <i class="fas fa-arrow-left mr-2"></i> Previous
                                </button>
                                <button id="next-btn-7" class="btn-primary text-white font-bold py-2.5 px-8 rounded-lg shadow-md" aria-label="Next step">
                                    Next <i class="fas fa-arrow-right ml-2"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- End Valuation Form -->
            </div>
        </div>
    </section>

    <!-- Pro Version Benefits -->
    <section class="py-16 bg-gray-100 [data-theme='dark']:bg-gray-900 transition-colors duration-300">
        <div class="container mx-auto px-6 text-center">
            <h2 class="text-3xl font-bold text-gray-800 mb-6 animate-[fadeIn_1s_ease-out] [data-theme='dark']:text-gray-100">Why Choose Amanda Valuation Pro?</h2>
            <p class="text-lg text-gray-600 max-w-3xl mx-auto mb-12 animate-[fadeIn_1.2s_ease-out] [data-theme='dark']:text-gray-300">Unlock a suite of advanced features designed to give you a competitive edge. With Amanda Valuation Pro, you get AI-driven insights, multi-scenario planning, investor-ready PDF reports, and comprehensive risk assessments to maximize your business’s value.</p>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="bg-white p-6 rounded-xl shadow-lg animate-[fadeInUp_1.4s_ease-out] [data-theme='dark']:bg-gray-800">
                    <i class="fas fa-brain text-3xl text-[var(--primary)] mb-4"></i>
                    <h3 class="text-xl font-semibold text-gray-800 mb-2 [data-theme='dark']:text-gray-100">AI-Powered Insights</h3>
                    <p class="text-gray-600 [data-theme='dark']:text-gray-300">Get actionable recommendations to boost your valuation based on your inputs.</p>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-lg animate-[fadeInUp_1.6s_ease-out] [data-theme='dark']:bg-gray-800">
                    <i class="fas fa-file-pdf text-3xl text-[var(--primary)] mb-4"></i>
                    <h3 class="text-xl font-semibold text-gray-800 mb-2 [data-theme='dark']:text-gray-100">Investor-Ready Reports</h3>
                    <p class="text-gray-600 [data-theme='dark']:text-gray-300">Export professional PDF reports with charts and methodology for stakeholders.</p>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-lg animate-[fadeInUp_1.8s_ease-out] [data-theme='dark']:bg-gray-800">
                    <i class="fas fa-shield-alt text-3xl text-[var(--primary)] mb-4"></i>
                    <h3 class="text-xl font-semibold text-gray-800 mb-2 [data-theme='dark']:text-gray-100">Comprehensive Risk Analysis</h3>
                    <p class="text-gray-600 [data-theme='dark']:text-gray-300">Assess operational, market, and legal risks to strengthen your valuation.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Why Valuation Matters Info Box -->
    <section class="py-16 bg-gray-50 [data-theme='dark']:bg-gray-800 transition-colors duration-300">
        <div class="container mx-auto px-6">
            <div class="relative bg-white rounded-2xl shadow-xl max-w-4xl mx-auto p-8 [data-theme='dark']:bg-gray-700 animate-[fadeInUp_1s_ease-out] parallax-card">
                <div class="absolute inset-0 bg-gradient-to-r from-[var(--primary)]/10 to-transparent rounded-2xl"></div>
                <h2 class="text-3xl font-bold text-gray-800 mb-6 relative z-10 [data-theme='dark']:text-gray-100">Why Valuation Matters</h2>
                <p class="text-lg text-gray-600 mb-6 relative z-10 [data-theme='dark']:text-gray-300">Getting the right valuation is like knowing the true worth of your house before selling it—it helps you make smart decisions and get the best deal. Here’s why it’s so important:</p>
                <ul class="list-disc list-inside text-gray-600 mb-6 relative z-10 space-y-2 [data-theme='dark']:text-gray-300">
                    <li><strong>Maximize Your Sale Price:</strong> A precise valuation shows buyers your business’s true value, helping you negotiate a higher price when selling.</li>
                    <li><strong>Attract Investors:</strong> A clear, data-backed valuation makes your business more appealing to investors, showing them exactly what they’re getting.</li>
                    <li><strong>Plan Strategically:</strong> Understanding your worth helps you decide whether to grow, sell, or raise funds, giving you a roadmap for success.</li>
                    <li><strong>Avoid Undervaluing:</strong> Without a proper valuation, you might sell your business for less than it’s worth, missing out on thousands or millions.</li>
                </ul>
                <p class="text-lg text-gray-600 mb-8 relative z-10 [data-theme='dark']:text-gray-300">Whether you’re preparing to sell, seeking investment, or just planning ahead, Amanda Valuation Pro gives you the insights to make confident, informed decisions.</p>
                <div class="relative z-10">
                    <a href="index.html#resources" class="btn-primary text-white font-bold py-3 px-8 rounded-lg shadow-md inline-flex items-center">
                        Learn More <i class="fas fa-arrow-right ml-2"></i>
                    </a>
                </div>
            </div>
        </div>
        <style>
            .parallax-card {
                position: relative;
                transform: translateZ(0);
                transition: transform 0.3s ease;
            }
            .parallax-card:hover {
                transform: translateY(-5px);
            }
        </style>
    </section>
    <!-- Step 8: Risk Assessment -->
                    <div class="interactive-panel relative group">
                        <div id="step-8" class="step step-hidden">
                            <div class="flex items-center mb-6">
                                <h2 class="text-2xl font-semibold text-gray-800 flex items-center [data-theme='dark']:text-gray-100">
                                    <i class="fas fa-exclamation-triangle mr-3 text-[var(--primary)]"></i> Risk Assessment
                                </h2>
                                <button class="tooltip-icon ml-3 focus:outline-none" data-tooltip="step8-tooltip" aria-label="Show step explanation" tabindex="0">
                                    <i class="fas fa-question-circle text-lg"></i>
                                </button>
                                <div id="step8-tooltip" class="tooltip">
                                    <div class="flex items-start">
                                        <i class="fas fa-info-circle mr-2 mt-1 text-white"></i>
                                        <p>This step checks for risks that could lower your business’s value, like legal issues or market challenges. Adjust the sliders to estimate how much each risk affects you.</p>
                                    </div>
                                </div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                <div>
                                    <label for="regulatoryRisk" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Regulatory Risk Impact (%):</label>
                                    <input type="range" id="regulatoryRisk" min="0" max="20" value="0" class="input-highlight w-full h-2 bg-gray-200 rounded-lg cursor-pointer [data-theme='dark']:bg-gray-600" aria-describedby="regulatoryRisk-desc">
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="regulatoryRisk-desc">Risk from laws or compliance (0 = none, 20 = high).</p>
                                    <p id="regulatoryRisk-value" class="text-sm text-gray-600 mt-1 [data-theme='dark']:text-gray-300">0%</p>
                                    <p id="regulatoryRisk-feedback" class="feedback-message"></p>
                                </div>
                                <div>
                                    <label for="operationalRisk" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Operational Risk Impact (%):</label>
                                    <input type="range" id="operationalRisk" min="0" max="20" value="0" class="input-highlight w-full h-2 bg-gray-200 rounded-lg cursor-pointer [data-theme='dark']:bg-gray-600" aria-describedby="operationalRisk-desc">
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="operationalRisk-desc">Risk from systems or processes failing.</p>
                                    <p id="operationalRisk-value" class="text-sm text-gray-600 mt-1 [data-theme='dark']:text-gray-300">0%</p>
                                    <p id="operationalRisk-feedback" class="feedback-message"></p>
                                </div>
                                <div>
                                    <label for="marketRisk" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Market Risk Impact (%):</label>
                                    <input type="range" id="marketRisk" min="0" max="20" value="0" class="input-highlight w-full h-2 bg-gray-200 rounded-lg cursor-pointer [data-theme='dark']:bg-gray-600" aria-describedby="marketRisk-desc">
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="marketRisk-desc">Risk from competition or demand changes.</p>
                                    <p id="marketRisk-value" class="text-sm text-gray-600 mt-1 [data-theme='dark']:text-gray-300">0%</p>
                                    <p id="marketRisk-feedback" class="feedback-message"></p>
                                </div>
                                <div>
                                    <label for="financialRisk" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Financial Risk Impact (%):</label>
                                    <input type="range" id="financialRisk" min="0" max="20" value="0" class="input-highlight w-full h-2 bg-gray-200 rounded-lg cursor-pointer [data-theme='dark']:bg-gray-600" aria-describedby="financialRisk-desc">
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="financialRisk-desc">Risk from cash flow or debt issues.</p>
                                    <p id="financialRisk-value" class="text-sm text-gray-600 mt-1 [data-theme='dark']:text-gray-300">0%</p>
                                    <p id="financialRisk-feedback" class="feedback-message"></p>
                                </div>
                            </div>
                            <div class="flex justify-between">
                                <button id="prev-btn-8" class="btn-secondary font-bold py-2.5 px-8 rounded-lg shadow-md" aria-label="Previous step">
                                    <i class="fas fa-arrow-left mr-2"></i> Previous
                                </button>
                                <button id="next-btn-8" class="btn-primary text-white font-bold py-2.5 px-8 rounded-lg shadow-md" aria-label="Next step">
                                    Next <i class="fas fa-arrow-right ml-2"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Step 9: Team and Legal -->
                    <div class="interactive-panel relative group">
                        <div id="step-9" class="step step-hidden">
                            <div class="flex items-center mb-6">
                                <h2 class="text-2xl font-semibold text-gray-800 flex items-center [data-theme='dark']:text-gray-100">
                                    <i class="fas fa-shield-alt mr-3 text-[var(--primary)]"></i> Team and Legal
                                </h2>
                                <button class="tooltip-icon ml-3 focus:outline-none" data-tooltip="step9-tooltip" aria-label="Show step explanation" tabindex="0">
                                    <i class="fas fa-question-circle text-lg"></i>
                                </button>
                                <div id="step9-tooltip" class="tooltip">
                                    <div class="flex items-start">
                                        <i class="fas fa-info-circle mr-2 mt-1 text-white"></i>
                                        <p>This step looks at your team’s strength and any legal issues. A skilled team and clean legal record make your business more attractive to buyers or investors.</p>
                                    </div>
                                </div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                <div>
                                    <label for="teamSize" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Total full-time employees:</label>
                                    <input type="number" id="teamSize" placeholder="20" min="0" class="input-highlight block w-full text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="teamSize-desc">
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="teamSize-desc">Your current workforce size.</p>
                                    <p id="teamSize-error" class="error-message">Please enter a valid number.</p>
                                    <p id="teamSize-feedback" class="feedback-message"></p>
                                </div>
                                <div>
                                    <label for="execExperience" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Average executive team experience (years):</label>
                                    <input type="number" id="execExperience" placeholder="10" min="0" class="input-highlight block w-full text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="execExperience-desc">
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="execExperience-desc">Years of leadership experience.</p>
                                    <p id="execExperience-error" class="error-message">Please enter a valid number.</p>
                                    <p id="execExperience-feedback" class="feedback-message"></p>
                                </div>
                                <div>
                                    <label for="openRoles" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Number of critical open roles:</label>
                                    <input type="number" id="openRoles" placeholder="2" min="0" class="input-highlight block w-full text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="openRoles-desc">
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="openRoles-desc">Key positions you’re hiring for.</p>
                                    <p id="openRoles-error" class="error-message">Please enter a valid number.</p>
                                    <p id="openRoles-feedback" class="feedback-message"></p>
                                </div>
                                <div>
                                    <label for="litigation" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Open litigation or disputes?:</label>
                                    <select id="litigation" class="input-highlight block w-full text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="litigation-desc">
                                        <option value="">Select an option</option>
                                        <option value="none">None</option>
                                        <option value="minor">Minor</option>
                                        <option value="major">Major</option>
                                    </select>
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="litigation-desc">Legal issues can lower value.</p>
                                    <p id="litigation-error" class="error-message">Please select an option.</p>
                                    <p id="litigation-feedback" class="feedback-message"></p>
                                </div>
                                <div>
                                    <label for="contractExposure" class="block text-sm font-medium text-gray-700 mb-1 [data-theme='dark']:text-gray-200">Revenue at risk from contract termination (%):</label>
                                    <div class="relative">
                                        <input type="text" id="contractExposure" placeholder="5" class="input-highlight block w-full pr-10 text-sm border-gray-300 rounded-md [data-theme='dark']:border-gray-600 [data-theme='dark']:bg-gray-700" aria-describedby="contractExposure-desc">
                                        <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 text-sm">%</span>
                                    </div>
                                    <p class="mt-1 text-sm text-gray-500 [data-theme='dark']:text-gray-400" id="contractExposure-desc">Revenue tied to cancellable contracts.</p>
                                    <p id="contractExposure-error" class="error-message">Please enter a valid percentage (0–100).</p>
                                    <p id="contractExposure-feedback" class="feedback-message"></p>
                                </div>
                            </div>
                            <div class="flex justify-between">
                                <button id="prev-btn-9" class="btn-secondary font-bold py-2.5 px-8 rounded-lg shadow-md" aria-label="Previous step">
                                    <i class="fas fa-arrow-left mr-2"></i> Previous
                                </button>
                                <button id="submit-btn" class="btn-primary text-white font-bold py-2.5 px-8 rounded-lg shadow-md" aria-label="Submit valuation">
                                    Submit <i class="fas fa-check ml-2"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- End Valuation Form -->
            </div>

            <!-- Results Section -->
            <div id="results-section" class="hidden mt-12 bg-white rounded-2xl shadow-2xl p-8 max-w-7xl mx-auto transition-colors duration-300 [data-theme='dark']:bg-gray-800">
                <h2 class="text-3xl font-bold text-gray-800 mb-6 [data-theme='dark']:text-gray-100">Your Valuation Results</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div>
                        <h3 class="text-xl font-semibold text-gray-800 mb-4 [data-theme='dark']:text-gray-100">Valuation Summary</h3>
                        <div class="bg-gray-50 p-6 rounded-lg [data-theme='dark']:bg-gray-700">
                            <p class="text-2xl font-bold text-[var(--primary)]" id="valuation-result">$0</p>
                            <p class="text-sm text-gray-500 mt-2 [data-theme='dark']:text-gray-400">Weighted valuation based on your selected methods.</p>
                            <div class="mt-4 space-y-2">
                                <p id="method-breakdown" class="text-sm text-gray-600 [data-theme='dark']:text-gray-300">Method Breakdown: Calculating...</p>
                                <p id="scenario-impact" class="text-sm text-gray-600 [data-theme='dark']:text-gray-300">Scenario Impact: Calculating...</p>
                            </div>
                        </div>
                        <h3 class="text-xl font-semibold text-gray-800 mt-8 mb-4 [data-theme='dark']:text-gray-100">AI Insights</h3>
                        <div class="bg-gray-50 p-6 rounded-lg [data-theme='dark']:bg-gray-700">
                            <ul id="ai-insights" class="space-y-2 text-sm text-gray-600 [data-theme='dark']:text-gray-300">
                                <li>Loading insights...</li>
                            </ul>
                        </div>
                        <div class="mt-6">
                            <button id="export-pdf" class="btn-primary text-white font-bold py-3 px-8 rounded-lg shadow-md flex items-center">
                                <i class="fas fa-file-pdf mr-2"></i> Export as PDF
                            </button>
                        </div>
                    </div>
                    <div>
                        <h3 class="text-xl font-semibold text-gray-800 mb-4 [data-theme='dark']:text-gray-100">Sensitivity Analysis</h3>
                        <div class="chart-container">
                            <canvas id="sensitivity-chart"></canvas>
                        </div>
                        <p class="text-sm text-gray-500 mt-4 [data-theme='dark']:text-gray-400">Shows how changes in growth rate, churn, or expenses impact your valuation.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-[var(--secondary)] text-white py-12 transition-colors duration-300">
        <div class="container mx-auto px-6">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div>
                    <h3 class="text-xl font-bold mb-4">Amanda Valuation</h3>
                    <p class="text-sm opacity-80">Empowering businesses with precise valuations and strategic insights for growth and investment.</p>
                </div>
                <div>
                    <h3 class="text-xl font-bold mb-4">Quick Links</h3>
                    <ul class="space-y-2">
                        <li><a href="index.html#self-valuation" class="text-sm hover:text-[var(--primary)] transition-colors">Self Valuation</a></li>
                        <li><a href="index.html#tech-due-diligence" class="text-sm hover:text-[var(--primary)] transition-colors">Tech Due Diligence</a></li>
                        <li><a href="index.html#pricing" class="text-sm hover:text-[var(--primary)] transition-colors">Pricing</a></li>
                        <li><a href="index.html#resources" class="text-sm hover:text-[var(--primary)] transition-colors">Resources</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-xl font-bold mb-4">Contact Us</h3>
                    <p class="text-sm opacity-80">Email: support@amandavaluation.com</p>
                    <p class="text-sm opacity-80">Phone: +1 (800) 555-1234</p>
                </div>
            </div>
            <div class="mt-8 text-center text-sm opacity-80">
                <p>&copy; 2025 Amanda Valuation. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script>
        // Utility Functions
        const utils = {
            formatCurrency(value, currency = 'USD') {
                const rates = { USD: 1, AUD: 1.5, EUR: 0.85 };
                const symbol = { USD: '$', AUD: 'A$', EUR: '€' };
                const converted = (value * rates[currency]).toFixed(2);
                return `${symbol[currency]}${converted.replace(/\B(?=(\d{3})+(?!\d))/g, ',')}`;
            },
            debounce(fn, ms) {
                return _.debounce(fn, ms);
            },
            animateElement(el, props, duration = 0.5) {
                gsap.to(el, { duration, ...props, ease: 'power2.out' });
            },
            validateNumber(value, min, max) {
                const num = parseFloat(value);
                return !isNaN(num) && num >= min && num <= max;
            }
        };

        // Validation Error Class
        class ValidationError extends Error {
            constructor(message, fieldId) {
                super(message);
                this.fieldId = fieldId;
            }
        }

        // State Management
        class ValuationState {
            constructor() {
                this.data = JSON.parse(localStorage.getItem('valuationData')) || {};
                this.listeners = [];
                this.currentStep = parseInt(localStorage.getItem('currentStep')) || 1;
                this.currency = localStorage.getItem('currency') || 'USD';
                this.theme = localStorage.getItem('theme') || 'light';
            }
            set(key, value) {
                this.data[key] = value;
                this.save();
                this.notify();
            }
            get(key) {
                return this.data[key];
            }
            setStep(step) {
                this.currentStep = step;
                localStorage.setItem('currentStep', step);
                this.notify();
            }
            setCurrency(currency) {
                this.currency = currency;
                localStorage.setItem('currency', currency);
                this.notify();
            }
            setTheme(theme) {
                this.theme = theme;
                localStorage.setItem('theme', theme);
                document.body.dataset.theme = theme;
                this.notify();
            }
            save() {
                localStorage.setItem('valuationData', JSON.stringify(this.data));
            }
            subscribe(listener) {
                this.listeners.push(listener);
            }
            notify() {
                this.listeners.forEach(listener => listener(this));
                document.dispatchEvent(new CustomEvent('stateChange', { detail: this }));
            }
        }

        // Tooltip Manager
        class TooltipManager {
            constructor() {
                this.tooltips = document.querySelectorAll('.tooltip-icon');
                this.init();
            }
            init() {
                this.tooltips.forEach(icon => {
                    icon.addEventListener('click', e => this.toggleTooltip(e));
                    icon.addEventListener('mouseenter', e => this.showTooltip(e));
                    icon.addEventListener('mouseleave', e => this.hideTooltip(e));
                    icon.addEventListener('focus', e => this.showTooltip(e));
                    icon.addEventListener('blur', e => this.hideTooltip(e));
                });
                document.addEventListener('click', e => {
                    if (!e.target.closest('.tooltip-icon')) {
                        this.tooltips.forEach(icon => {
                            const tooltip = document.getElementById(icon.dataset.tooltip);
                            tooltip.classList.remove('active');
                        });
                    }
                });
            }
            showTooltip(e) {
                const icon = e.target.closest('.tooltip-icon');
                const tooltip = document.getElementById(icon.dataset.tooltip);
                tooltip.classList.add('active');
                utils.animateElement(tooltip, { opacity: 1, y: 0 }, 0.3);
            }
            hideTooltip(e) {
                const icon = e.target.closest('.tooltip-icon');
                const tooltip = document.getElementById(icon.dataset.tooltip);
                if (!tooltip.classList.contains('active') || e.type === 'blur') {
                    utils.animateElement(tooltip, { opacity: 0, y: 10 }, 0.3);
                    setTimeout(() => tooltip.classList.remove('active'), 300);
                }
            }
            toggleTooltip(e) {
                const icon = e.target.closest('.tooltip-icon');
                const tooltip = document.getElementById(icon.dataset.tooltip);
                if (tooltip.classList.contains('active')) {
                    this.hideTooltip(e);
                } else {
                    this.showTooltip(e);
                }
            }
        }

        // Step Manager
        class StepManager {
            constructor(state) {
                this.state = state;
                this.steps = document.querySelectorAll('.step');
                this.navItems = document.querySelectorAll('.step-nav-item');
                this.progressFill = document.getElementById('progress-fill');
                this.currentStepLabel = document.getElementById('current-step');
                this.init();
            }
            init() {
                this.updateStep(this.state.currentStep);
                this.navItems.forEach(item => {
                    item.addEventListener('click', () => {
                        const step = parseInt(item.dataset.step);
                        if (!item.classList.contains('completed') || step <= this.state.currentStep) {
                            this.state.setStep(step);
                        }
                    });
                });
                this.state.subscribe(() => this.updateStep(this.state.currentStep));
            }
            updateStep(step) {
                this.steps.forEach((s, i) => {
                    s.classList.toggle('step-visible', i + 1 === step);
                    s.classList.toggle('step-hidden', i + 1 !== step);
                    if (i + 1 === step) {
                        utils.animateElement(s, { opacity: 1, y: 0 }, 0.5);
                    }
                });
                this.navItems.forEach((item, i) => {
                    item.classList.toggle('active', i + 1 === step);
                    item.classList.toggle('completed', i + 1 < step);
                });
                this.progressFill.style.width = `${(step / 9) * 100}%`;
                this.currentStepLabel.textContent = step;
            }
        }

        // Chart Renderer
        class ChartRenderer {
            constructor() {
                this.canvas = document.getElementById('sensitivity-chart');
                this.chart = null;
            }
            render(data) {
                if (this.chart) this.chart.destroy();
                this.chart = new Chart(this.canvas, {
                    type: 'bar',
                    data: {
                        labels: ['Growth +10%', 'Growth -10%', 'Churn +5%', 'Churn -5%', 'Expenses +10%', 'Expenses -10%'],
                        datasets: [{
                            label: 'Valuation Impact ($)',
                            data: data,
                            backgroundColor: 'var(--primary)',
                            borderColor: 'var(--secondary)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: { display: true, text: 'Valuation ($)' }
                            }
                        },
                        plugins: {
                            legend: { display: false },
                            tooltip: {
                                callbacks: {
                                    label: ctx => `${ctx.dataset.label}: ${utils.formatCurrency(ctx.raw)}`
                                }
                            }
                        }
                    }
                });
                utils.animateElement(this.canvas, { opacity: 1, scale: 1 }, 1);
            }
        }

        // Valuation Form
        class ValuationForm {
            constructor(state) {
                this.state = state;
                this.form = document.getElementById('valuation-form');
                this.resultsSection = document.getElementById('results-section');
                this.chartRenderer = new ChartRenderer();
                this.init();
            }
            init() {
                this.bindEvents();
                this.loadSavedData();
                this.state.subscribe(() => this.updateCurrency());
                this.setupAutosave();
                document.getElementById('start-over').addEventListener('click', () => this.resetForm());
                document.getElementById('resume-later').addEventListener('click', () => this.resumeLater());
                document.getElementById('export-pdf').addEventListener('click', () => this.exportPDF());
            }
            bindEvents() {
                for (let i = 1; i <= 9; i++) {
                    const nextBtn = document.getElementById(`next-btn-${i}`);
                    const prevBtn = document.getElementById(`prev-btn-${i}`);
                    if (nextBtn) {
                        nextBtn.addEventListener('click', () => this.validateStep(i));
                    }
                    if (prevBtn) {
                        prevBtn.addEventListener('click', () => this.state.setStep(i - 1));
                    }
                }
                document.getElementById('submit-btn').addEventListener('click', () => this.submitForm());
                this.form.querySelectorAll('input, select').forEach(input => {
                    input.addEventListener('input', utils.debounce(() => this.saveInput(input), 500));
                });
                this.bindStep1Weights();
                this.bindStep4Industry();
                this.bindStep7Scenarios();
                this.bindRiskSliders();
            }
            bindStep1Weights() {
                const methods = ['multiplier', 'income', 'earnings', 'dcf', 'comparable'];
                methods.forEach(method => {
                    const checkbox = document.getElementById(`method-${method}`);
                    const weightInput = document.getElementById(`weight-${method}`);
                    checkbox.addEventListener('change', () => {
                        weightInput.classList.toggle('hidden', !checkbox.checked);
                        weightInput.required = checkbox.checked;
                        this.validateWeights();
                    });
                    weightInput.addEventListener('input', () => this.validateWeights());
                });
            }
            bindStep4Industry() {
                const industrySelect = document.getElementById('industry');
                const multiplierInput = document.getElementById('industryMultiplier');
                const multipliers = {
                    technology: 4.0,
                    healthcare: 3.5,
                    retail: 2.0,
                    manufacturing: 2.5,
                    finance: 3.0,
                    education: 2.8
                };
                industrySelect.addEventListener('change', () => {
                    const value = industrySelect.value;
                    multiplierInput.value = value ? multipliers[value] || 2.0 : '';
                    this.state.set('industryMultiplier', multiplierInput.value);
                });
            }
            bindStep7Scenarios() {
                const addBtn = document.getElementById('add-scenario');
                const scenarioList = document.getElementById('scenario-items');
                addBtn.addEventListener('click', () => {
                    const name = document.getElementById('scenarioName').value;
                    if (!name) {
                        document.getElementById('scenarioName-error').style.display = 'block';
                        return;
                    }
                    const scenario = {
                        name,
                        growth: document.getElementById('scenarioGrowth').value,
                        churn: document.getElementById('scenarioChurn').value,
                        opex: document.getElementById('scenarioOpex').value,
                        discount: document.getElementById('scenarioDiscount').value
                    };
                    const scenarios = this.state.get('scenarios') || [];
                    scenarios.push(scenario);
                    this.state.set('scenarios', scenarios);
                    this.renderScenarios(scenarioList, scenarios);
                    document.getElementById('scenarioName').value = '';
                });
            }
            renderScenarios(list, scenarios) {
                list.innerHTML = scenarios.map((s, i) => `
                    <li class="flex justify-between items-center p-2 bg-gray-100 rounded-md [data-theme='dark']:bg-gray-600">
                        <span>${s.name}</span>
                        <button class="text-[var(--error)] hover:text-[var(--secondary)]" data-index="${i}" aria-label="Remove scenario"><i class="fas fa-trash"></i></button>
                    </li>
                `).join('');
                list.querySelectorAll('button').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const index = btn.dataset.index;
                        const updated = this.state.get('scenarios').filter((_, i) => i !== parseInt(index));
                        this.state.set('scenarios', updated);
                        this.renderScenarios(list, updated);
                    });
                });
            }
            bindRiskSliders() {
                ['regulatoryRisk', 'operationalRisk', 'marketRisk', 'financialRisk'].forEach(id => {
                    const slider = document.getElementById(id);
                    const valueDisplay = document.getElementById(`${id}-value`);
                    slider.addEventListener('input', () => {
                        valueDisplay.textContent = `${slider.value}%`;
                        this.state.set(id, slider.value);
                    });
                });
            }
            saveInput(input) {
                this.state.set(input.id, input.value);
                this.showFeedback(input.id, true, 'Saved');
            }
            loadSavedData() {
                this.form.querySelectorAll('input, select').forEach(input => {
                    const value = this.state.get(input.id);
                    if (value) {
                        if (input.type === 'checkbox') {
                            input.checked = value === 'true';
                        } else {
                            input.value = value;
                        }
                    }
                });
                const scenarios = this.state.get('scenarios') || [];
                this.renderScenarios(document.getElementById('scenario-items'), scenarios);
                ['regulatoryRisk', 'operationalRisk', 'marketRisk', 'financialRisk'].forEach(id => {
                    const value = this.state.get(id) || 0;
                    document.getElementById(id).value = value;
                    document.getElementById(`${id}-value`).textContent = `${value}%`;
                });
            }
            setupAutosave() {
                setInterval(() => {
                    this.state.save();
                    console.log('Autosaved at', new Date());
                }, 5000);
            }
            validateStep(step) {
                try {
                    if (step === 1) {
                        const selected = Array.from(document.querySelectorAll('input[type="checkbox"]:checked')).length;
                        if (selected < 1 || selected > 4) {
                            throw new ValidationError('Please select 1 to 4 valuation methods.', 'method-error');
                        }
                        if (!this.validateWeights()) {
                            throw new ValidationError('Weights must sum to 100%.', 'weight-error');
                        }
                    } else {
                        const inputs = document.getElementById(`step-${step}`).querySelectorAll('input:not([type="range"]), select');
                        inputs.forEach(input => {
                            if (input.required && !input.value) {
                                throw new ValidationError(`Please fill in ${input.labels[0]?.textContent || input.id}.`, `${input.id}-error`);
                            }
                            if (input.type === 'number' && input.value && !utils.validateNumber(input.value, input.min || 0, input.max || Infinity)) {
                                throw new ValidationError(`Invalid value for ${input.labels[0]?.textContent || input.id}.`, `${input.id}-error`);
                            }
                        });
                    }
                    this.state.setStep(step + 1);
                } catch (err) {
                    if (err instanceof ValidationError) {
                        document.getElementById(err.fieldId).style.display = 'block';
                        this.showFeedback(err.fieldId.replace('-error', ''), false, err.message);
                    }
                }
            }
            validateWeights() {
                const weights = ['multiplier', 'income', 'earnings', 'dcf', 'comparable']
                    .map(id => {
                        const input = document.getElementById(`weight-${id}`);
                        return input.classList.contains('hidden') ? 0 : parseFloat(input.value) || 0;
                    });
                const sum = weights.reduce((a, b) => a + b, 0);
                const feedback = sum === 100 ? 'Weights sum to 100%.' : `Weights sum to ${sum}%. Must be 100%.`;
                const isValid = sum === 100;
                weights.forEach((w, i) => {
                    const id = `weight-${['multiplier', 'income', 'earnings', 'dcf', 'comparable'][i]}-feedback`;
                    this.showFeedback(id.replace('-feedback', ''), isValid, feedback);
                });
                document.getElementById('weight-error').style.display = isValid ? 'none' : 'block';
                return isValid;
            }
            showFeedback(id, isValid, message) {
                const feedbackEl = document.getElementById(`${id}-feedback`);
                feedbackEl.textContent = message;
                feedbackEl.classList.toggle('feedback-success', isValid);
                feedbackEl.classList.toggle('feedback-error', !isValid);
                feedbackEl.style.display = 'block';
                setTimeout(() => feedbackEl.style.display = 'none', 3000);
            }
            submitForm() {
                try {
                    this.validateStep(9);
                    const valuation = this.calculateValuation();
                    this.renderResults(valuation);
                    this.resultsSection.classList.remove('hidden');
                    utils.animateElement(this.resultsSection, { opacity: 1, y: 0 }, 0.8);
                    window.scrollTo({ top: this.resultsSection.offsetTop, behavior: 'smooth' });
                } catch (err) {
                    console.error(err);
                }
            }
            calculateValuation() {
                const methods = this.state.get('methods') || {};
                const weights = ['multiplier', 'income', 'earnings', 'dcf', 'comparable']
                    .map(id => parseFloat(this.state.get(`weight-${id}`)) || 0);
                const mrr = parseFloat(this.state.get('mrr')) || 0;
                const multiplier = parseFloat(this.state.get('industryMultiplier')) || 2.0;
                const ebitda = parseFloat(this.state.get('ebitda')) || 0;
                const risks = ['regulatoryRisk', 'operationalRisk', 'marketRisk', 'financialRisk']
                    .reduce((sum, id) => sum + (parseFloat(this.state.get(id)) || 0), 0);
                const litigation = this.state.get('litigation') === 'major' ? 0.9 : this.state.get('litigation') === 'minor' ? 0.95 : 1;

                const valuations = {
                    multiplier: mrr * 12 * multiplier,
                    income: mrr * 12 * 3,
                    earnings: ebitda * 5,
                    dcf: (mrr * 12 * 1.2) / (1 + (parseFloat(this.state.get('scenarioDiscount')) || 10) / 100),
                    comparable: mrr * 12 * 2.5
                };

                let total = 0;
                Object.keys(methods).forEach((method, i) => {
                    if (methods[method]) total += valuations[method] * (weights[i] / 100);
                });

                total *= (1 - risks / 100) * litigation;
                return {
                    total: Math.round(total),
                    breakdown: Object.keys(valuations).map(m => ({
                        method: m,
                        value: valuations[m],
                        weight: weights[Object.keys(valuations).indexOf(m)]
                    })),
                    scenarios: (this.state.get('scenarios') || []).map(s => ({
                        name: s.name,
                        value: Math.round(total * (1 + (parseFloat(s.growth) || 0) / 100 - (parseFloat(s.churn) || 0) / 100))
                    }))
                };
            }
            renderResults(valuation) {
                document.getElementById('valuation-result').textContent = utils.formatCurrency(valuation.total, this.state.currency);
                document.getElementById('method-breakdown').innerHTML = valuation.breakdown
                    .filter(b => b.weight > 0)
                    .map(b => `${b.method.charAt(0).toUpperCase() + b.method.slice(1)}: ${utils.formatCurrency(b.value, this.state.currency)} (${b.weight}%)`)
                    .join('<br>');
                document.getElementById('scenario-impact').innerHTML = valuation.scenarios
                    .map(s => `${s.name}: ${utils.formatCurrency(s.value, this.state.currency)}`)
                    .join('<br>') || 'No scenarios added.';

                const insights = this.generateAIInsights(valuation);
                document.getElementById('ai-insights').innerHTML = insights.map(i => `<li>${i}</li>`).join('');

                const sensitivityData = [
                    valuation.total * 1.1, // Growth +10%
                    valuation.total * 0.9, // Growth -10%
                    valuation.total * 0.95, // Churn +5%
                    valuation.total * 1.05, // Churn -5%
                    valuation.total * 0.9, // Expenses +10%
                    valuation.total * 1.1 // Expenses -10%
                ];
                this.chartRenderer.render(sensitivityData);
            }
            generateAIInsights(valuation) {
                const mrr = parseFloat(this.state.get('mrr')) || 0;
                const churn = parseFloat(this.state.get('scenarioChurn')) || 0;
                const insights = [];
                if (mrr < 10000) {
                    insights.push('Your MRR is relatively low. Consider strategies to increase recurring revenue, such as upselling or expanding your customer base.');
                }
                if (churn > 5) {
                    insights.push(`High churn rate (${churn}%) detected. Focus on customer retention to potentially increase valuation by ${utils.formatCurrency(valuation.total * 0.1, this.state.currency)}.`);
                }
                if (this.state.get('litigation') !== 'none') {
                    insights.push('Open litigation may deter investors. Resolving legal issues could improve your valuation.');
                }
                if (valuation.scenarios.length > 0) {
                    insights.push('Your scenarios show potential growth. The highest scenario could increase valuation by up to 20%.');
                }
                return insights.length ? insights : ['Your valuation looks solid! Consider refining inputs for more tailored insights.'];
            }
            exportPDF() {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                doc.setFont('Poppins', 'normal');
                doc.setFontSize(20);
                doc.text('Amanda Valuation Pro Report', 20, 20);
                doc.setFontSize(12);
                doc.text(`Valuation: ${document.getElementById('valuation-result').textContent}`, 20, 40);
                doc.text('Method Breakdown:', 20, 50);
                doc.text(document.getElementById('method-breakdown').textContent, 20, 60, { maxWidth: 160 });
                doc.text('AI Insights:', 20, 100);
                doc.text(document.getElementById('ai-insights').textContent, 20, 110, { maxWidth: 160 });
                doc.save('Amanda_Valuation_Report.pdf');
            }
            resetForm() {
                this.state.data = {};
                this.state.save();
                this.state.setStep(1);
                this.form.reset();
                this.resultsSection.classList.add('hidden');
                this.loadSavedData();
            }
            resumeLater() {
                alert('Your progress has been saved. Return to this page to resume your valuation.');
            }
            updateCurrency() {
                document.querySelectorAll('.currency-symbol').forEach(el => {
                    el.textContent = this.state.currency;
                });
                const results = document.getElementById('valuation-result');
                if (results.textContent !== '$0') {
                    this.renderResults(this.calculateValuation());
                }
            }
        }

        // Guided Tour
        class GuidedTour {
            constructor() {
                this.tour = new Shepherd.Tour({
                    defaultStepOptions: {
                        cancelIcon: { enabled: true },
                        classes: 'shepherd-theme-dark',
                        scrollTo: { behavior: 'smooth', block: 'center' }
                    },
                    useModalOverlay: true
                });
                this.init();
            }
            init() {
                this.tour.addSteps([
                    {
                        id: 'welcome',
                        text: 'Welcome to Amanda Valuation Pro! Let’s take a quick tour of the tool.',
                        buttons: [
                            { text: 'Next', action: this.tour.next },
                            { text: 'Skip', action: this.tour.cancel }
                        ]
                    },
                    {
                        id: 'step1',
                        text: 'Start by selecting valuation methods and assigning weights to prioritize them.',
                        attachTo: { element: '#step-1', on: 'bottom' },
                        buttons: [
                            { text: 'Next', action: this.tour.next },
                            { text: 'Skip', action: this.tour.cancel }
                        ]
                    },
                    {
                        id: 'progress',
                        text: 'Track your progress here and jump between steps you’ve completed.',
                        attachTo: { element: '.step-nav', on: 'bottom' },
                        buttons: [
                            { text: 'Next', action: this.tour.next },
                            { text: 'Skip', action: this.tour.cancel }
                        ]
                    },
                    {
                        id: 'currency',
                        text: 'Switch currencies or toggle dark mode for a personalized experience.',
                        attachTo: { element: '#currency-selector', on: 'bottom' },
                        buttons: [
                            { text: 'Finish', action: this.tour.complete }
                        ]
                    }
                ]);
                document.getElementById('start-tour').addEventListener('click', () => this.tour.start());
            }
        }

        // Initialize
        const state = new ValuationState();
        new TooltipManager();
        new StepManager(state);
        new ValuationForm(state);
        new GuidedTour();

        // Theme and Currency Handlers
        const themeToggles = [document.getElementById('theme-toggle'), document.getElementById('mobile-theme-toggle')];
        themeToggles.forEach(toggle => {
            toggle.addEventListener('click', () => {
                state.setTheme(state.theme === 'light' ? 'dark' : 'light');
                toggle.classList.toggle('active');
            });
            toggle.classList.toggle('active', state.theme === 'dark');
        });

        const currencySelectors = [document.getElementById('currency-selector'), document.getElementById('mobile-currency-selector')];
        currencySelectors.forEach(select => {
            select.value = state.currency;
            select.addEventListener('change', () => state.setCurrency(select.value));
        });

        // Mobile Menu
        const menuToggle = document.getElementById('menu-toggle');
        const mobileMenu = document.getElementById('mobile-menu');
        menuToggle.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
            menuToggle.querySelector('i').classList.toggle('fa-bars');
            menuToggle.querySelector('i').classList.toggle('fa-times');
        });

        // Parallax Effect
        window.addEventListener('scroll', () => {
            const parallax = document.querySelector('.parallax-layer');
            const offset = window.pageYOffset;
            parallax.style.transform = `translateY(${offset * 0.2}px)`;
        });

        // Error Boundary
        window.addEventListener('error', (e) => {
            console.error('Error occurred:', e.message);
            alert('An unexpected error occurred. Please refresh the page.');
        });
    </script>
</body>
</html>
